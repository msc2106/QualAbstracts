ABSTRACT: 
We propose an optimal test procedure for testing the marginal density functions of a class of nonlinear diffusion processes. The proposed test is not only an optimal one but also avoids undersmoothing. An adaptive test is constructed, and its asymptotic properties are investigated. To show the asymptotic properties, we establish some general results for moment inequalities and asymptotic distributions for strictly stationary processes under the [alpha]-mixing condition. These results are applicable to some other estimation and testing of strictly stationary processes with the [alpha]-mixing condition. An example of implementation is given to demonstrate that the proposed model specification procedure is applicable to economic and financial model specification and can be implemented in practice. To ensure the applicability and implementation, we propose a computer-intensive simulation scheme for the choice of a suitable bandwidth involved in the kernel estimation and also a simulated critical value for the proposed adaptive test. Our finite sample studies support both the proposed theory and the simulation procedure.Jiti Gao and Maxwell Kin. 
 
PREDICTION: 
Copyright  2004 Cambridge University Press http://hdl.handle.net/2440/46471 PERMISSIONS http://journals.cambridge.org/action/stream?pageId=4088&level=2#4408 The right to post the definitive version of the contribution as published at Cambridge Journals Online (in PDF or HTML form) in the Institutional Repository of the institution in which they worked at the time the paper was first submitted, or (for appropriate journals) in PubMed Central or UK PubMed Central, no sooner than one year after first publication of the paper in the journal, subject to file availability and provided the posting includes a prominent statement of the full bibliographical details, a copyright notice in the name of the copyright holder (Cambridge University Press or the sponsoring Society, as appropriate), and a link to the online edition of the journal at Cambridge Journals Online. INTRODUCTION AND MOTIVATION Continuous-time diffusion processes arise in many applications in economet- rics, but perhaps nowhere do they play as large a role as in finance+ Following the pathbreaking work of Black and Scholes 1973!, the use of continuous-time diffusion processes has become a common feature of many applications, espe- cially asset pricing models+ This is probably due to the following two reasons+ The authors thank the co-editor and three anonymous referees for their constructive comments and suggestions+ The first author also thanks Song Xi Chen for some constructive suggestions, in particular the suggestion on using the local linear form instead of the Nadaraya–Watson kernel form in equation 2+6!, and Yongmiao Hong for sending a working paper+ The authors acknowledge comments from seminar participants at the International Chinese Statistical Association Meeting in Hong Kong in July 2001, the Western Australian Branch Meeting of the Statistical Society of Australia in September 2001, the University of Western Australia, and Monash Univer- sity+ Thanks also go to the Australian Research Council for its financial support+ Address correspondence to Jiti Gao, School of Mathematics and Statistics, the University of Western Australia, Crawley, WA 6009, Australia; e-mail: jiti@maths+uwa+edu+au; or to Maxwell King, Faculty 
 
FULL TEXT: 
  PUBLISHED VERSION Gao, Jiti; King, M. Adaptive testing in continuous–time diffusion models, Econometric Theory, 2004; 20(5):844-882. Copyright © 2004 Cambridge University Press http://hdl.handle.net/2440/46471 PERMISSIONS http://journals.cambridge.org/action/stream?pageId=4088&level=2#4408 The right to post the definitive version of the contribution as published at Cambridge Journals Online (in PDF or HTML form) in the Institutional Repository of the institution in which they worked at the time the paper was first submitted, or (for appropriate journals) in PubMed Central or UK PubMed Central, no sooner than one year after first publication of the paper in the journal, subject to file availability and provided the posting includes a prominent statement of the full bibliographical details, a copyright notice in the name of the copyright holder (Cambridge University Press or the sponsoring Society, as appropriate), and a link to the online edition of the journal at Cambridge Journals Online. Inclusion of this definitive version after one year in Institutional Repositories outside of the institution in which the contributor worked at the time the paper was first submitted will be subject to the additional permission of Cambridge University Press (not to be unreasonably withheld). 10th December 2010 ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS JITI GAO The University of Western Australia MAXWELL KING Monash University We propose an optimal test procedure for testing the marginal density functions of a class of nonlinear diffusion processes+ The proposed test is not only an opti- mal one but also avoids undersmoothing+ An adaptive test is constructed, and its asymptotic properties are investigated+ To show the asymptotic properties, we estab- lish some general results for moment inequalities and asymptotic distributions for strictly stationary processes under the a-mixing condition+ These results are appli- cable to some other estimation and testing of strictly stationary processes with the a-mixing condition+ An example of implementation is given to demonstrate that the proposed model specification procedure is applicable to economic and financial model specification and can be implemented in practice+ To ensure the applicability and implementation, we propose a computer-intensive simulation scheme for the choice of a suitable bandwidth involved in the kernel estimation and also a simulated critical value for the proposed adaptive test+ Our finite sam- ple studies support both the proposed theory and the simulation procedure+ 1. INTRODUCTION AND MOTIVATION Continuous-time diffusion processes arise in many applications in economet- rics, but perhaps nowhere do they play as large a role as in finance+ Following the pathbreaking work of Black and Scholes ~1973!, the use of continuous-time diffusion processes has become a common feature of many applications, espe- cially asset pricing models+ This is probably due to the following two reasons+ The authors thank the co-editor and three anonymous referees for their constructive comments and suggestions+ The first author also thanks Song Xi Chen for some constructive suggestions, in particular the suggestion on using the local linear form instead of the Nadaraya–Watson kernel form in equation ~2+6!, and Yongmiao Hong for sending a working paper+ The authors acknowledge comments from seminar participants at the International Chinese Statistical Association Meeting in Hong Kong in July 2001, the Western Australian Branch Meeting of the Statistical Society of Australia in September 2001, the University of Western Australia, and Monash Univer- sity+ Thanks also go to the Australian Research Council for its financial support+ Address correspondence to Jiti Gao, School of Mathematics and Statistics, the University of Western Australia, Crawley, WA 6009, Australia; e-mail: jiti@maths+uwa+edu+au; or to Maxwell King, Faculty of Business and Economics, Monash University, Clayton, VIC 3800, Australia; e-mail: max+king@buseco+monash+edu+au+ Econometric Theory, 20, 2004, 844–882+ Printed in the United States of America+ DOI: 10+10170S0266466604205023 844 © 2004 Cambridge University Press 0266-4666004 $12+00 The first one is that continuous-time diffusion processes are able to mimic some important macroeconomic and financial phenomena ~see Sundaresan, 2001!+ The second reason is that various parametric diffusion processes have already been used nicely to model financial data+ In both theory and practice, however, one needs to specify whether a parametric diffusion process is appropriate for a given set of financial data+ In other words, one needs to determine whether it is appropriate to use a diffusion process with both the drift and the volatility assumed to be parametric for a given set of financial data+ To justify whether the use of parametric diffusion processes is appropriate or not for a given set of financial data, empirical researchers have recently shown a preference for non- parametric alternatives+ Aït-Sahalia ~1996a, 1996b! was among the first to pio- neer the nonparametric approach+ Other related studies include Jiang and Knight ~1997!, Stanton ~1997!, Chapman and Pearson ~2000!, Gao and King ~2001!, Hong and Li ~2004!, and Fan and Zhang ~2003!+ Aït-Sahalia ~1996a! considers testing the marginal density functions of a class of diffusion processes under the b-mixing condition+ Pritsker ~1998! conducts a finite sample simulation of a nonparametric kernel test proposed in Aït-Sahalia ~1996a!+ The principal result of Pritsker ~1998! is that the test rejects true models much too often when asymp- totic critical values are used+ This suggests that the use of an asymptotic criti- cal value may not be suitable in the finite sample analysis of a test power+ In addition, the use of an estimation-based bandwidth in the nonparametric kernel test may also contribute to the poor performance of the test in finite sample studies, because an estimation-based optimal bandwidth may not necessarily imply that the corresponding test is optimal+ We have been motivated by these two aspects to establish a simulation procedure for the choice of both an appro- priate critical value and a test optimum bandwidth to improve the test proposed in Aït-Sahalia ~1996b!+ Recently, Horowitz and Spokoiny ~2001! have developed a new test of a para- metric model of a conditional mean function against a nonparametric alterna- tive+ The test adapts to the unknown smoothness of the alternative model and is uniformly consistent against alternatives whose distance from the parametric model converges to zero at the fastest possible rate+ This rate is slower than T 2102 , where T is the number of observations+ To the best of our knowledge, the problem of extending the approach of Horowitz and Spokoiny ~2001! to construct an adaptive and optimal test for marginal density functions has not been considered+ This paper then proposes an adaptive test for testing marginal density functions+ The proposed test has an optimal-rate property+ In theory, the proposed test is consistent against some local alternatives with an optimal rate as stated in Section 3+ In practice, we demonstrate how to apply the test in Section 4 through using a simulated example+ Our studies show that the pro- posed test has some advantages over the test proposed in Aït-Sahalia ~1996a!+ The rest of the paper is organized as follows+ Section 2 discusses the testing of the marginal density+ An adaptive test procedure is proposed in Section 3+ Section 4 provides an example of implementation+ Section 5 concludes the paper ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 845 with some remarks on extensions+ Mathematical assumptions and proofs are relegated to Appendixes A–C+ 2. TESTING MARGINAL DENSITY FUNCTIONS Consider a continuous-time diffusion process of the form drt 5 m~rt ,u! dt 1 s~rt ,u! dBt , (2.1) where m~{! and s~{! . 0 are, respectively, the univariate drift and volatility functions of the process indexed by u and Bt is standard Brownian motion+ Let $rt % satisfy model ~2+1! and f ~{,u! be a parametric form of the marginal density function of $rt % + Within the diffusion process, f ~{,u! is completely deter- mined by the corresponding drift m~{,u! and the diffusion s~{,u! ~see Aït- Sahalia, 1996a, expression ~6!! given by f ~x,u! 5 j~u! s 2~x,u! exp HE x0 x 2m~u,u! s 2~u,u! duJ , (2.2) where $rt % is distributed on D 5 ~xmin, xmax! with 2` # xmin , xmax # `, both the lower bound x0 and j~u! can be chosen to ensure that f ~x,u! is a probabil- ity density, and u is an unknown parameter vector+ Let Q denote a parameter space in Rq and u0 [ Q denote the true value of u+ Let f ~x! be a nonparametric form of the density function+ The null and alter- native hypotheses are H0 : f ~x! 5 f ~x,u0 ! versus H1 : f ~x! 5 f ~x,u1! 1 CT DT ~x!, u1 [ Q, (2.3) where 0 # CT # 1, limTr`CT 5 0, and DT ~x! is a continuous function satisfy- ing *DT ~x! dx 5 0 and f ~x! $ 0 under H1+ Theoretically, this requires that under H1, the alternative function is still a probability density+ In practice, the form of DT ~x! needs to be constructed+ The simple and natural choice of DT ~x! is DT ~x! 5 f1~x,u1! 2 f ~x,u1!, where f1~x,u! is another specified density func- tion and u1 [ Q+ For example, f ~x,u! is the marginal density of $rt % satisfying the CIR model proposed in Cox, Ingersoll, and Ross ~1985!, and f1~x,u! is the marginal density of $rt % satisfying the AG model proposed in Ahn and Gao ~1999!+ For this case, the hypothesis structure ~2+3! can be written as H0 : f ~x! 5 f ~x,u0 ! versus H1 : f ~x! 5 f ~x,u1! 1 CT ~ f1~x,u1! 2 f ~x,u1!!+ This is equivalent to H0 : f ~x! 5 f ~x,u0 ! versus H1 : f ~x! 5 ~1 2 CT ! f ~x,u1! 1 CT f1~x,u1!+ 846 JITI GAO AND MAXWELL KING This basically requires us to test whether $rt % is sampled from f ~x,u0! or from f ~x,u1! with probability 1 2 CT and from f1~x,u1! with probability CT + Obviously, such a structure of the null hypothesis versus a sequence of local alternatives naturally extends the usual structure of the null hypothesis against a global alternative of the form H0' : f ~x! 5 f ~x,u0 ! versus H1' : f ~x! 5 f1~x,u1!, u1 [ Q+ For the diffusion process, we observe the process at dates $tD6 t 5 0,1, + + + ,% , where D . 0 is generally small but fixed+ Let Xt 5 r~t21!D for t $ 1 throughout this section+ Let k~{! be a kernel function, kh~{! 5 h21k~{0h!, and Zf ~x! 5 ~10T !(t51 T kh~x 2 Xt ! be the standard kernel density estimator of f ~x!+ Intu- itively, it is natural to compare Zf ~x! and f ~x,u! directly+ In a seminal paper, Aït-Sahalia ~1996a! uses a test statistic of the form ZMT ~h! 5 Th T (t51 T ~ Zf ~Xt ! 2 f ~Xt , ZuM !!2 5 h ( t51 T ~ Zf ~Xt ! 2 f ~Xt , ZuM !!2, where ZuM 5 arg minu[Q~10T !(t51 T ~ Zf ~Xt ! 2 f ~Xt ,u!!2 + It then follows from ~13! of Aït-Sahalia ~1996a! that as T r ` ZL0T ~h! 5 ZMT ~h! 2 [mT ~h! Mh [sT ~h! rD N~0,1! (2.4) under the b-mixing and some other conditions, where [mT ~h! 5 R~k!{S 1T (t51 T Zf ~Xt !D and [sT2~h! 5 2k ~4! ~0!{S 1T (t51 T Zf 3~Xt !D, in which R~k! 5 *k 2~u! du , ` and k ~ j !~0! denotes the j-times convolution product of k~{! given by k ~4! ~0! 5E 2` ` L2~x! dx with L~x! 5E 2` ` k~ y!k~x 1 y! dy+ (2.5) The preceding test statistic is based on Zf ~x! 2 f ~x, ZuM !, which measures directly the difference between Zf ~x! and f ~x, ZuM !+ It can be shown that under H0, E @ Zf ~x! 2 f ~x, ZuM !# 2 5 O~h 4 !+ This implies that it has the same order as the mean square error of Zf ~x! if h is chosen to be O~T 2105!+ Thus, to obtain an asymptotically normal distribu- tion with zero mean, h has to satisfy limTr`Th 4+5 5 0 as required in Assump- tion A5 of Aït-Sahalia ~1996a!+ This implies undersmoothing+ ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 847 To reduce the bias and avoid undersmoothing, we propose a nonparametric estimator, Df ~x, Du!, of f ~x,u! of the form Df ~x, Du! 5 ( t51 T wt ~x! f ~Xt , Du!, (2.6) where Du is a consistent estimator of u, wt~x! 5 wt~x, h! 5 ~10T !kh~x 2 Xt ! 3 @~s2~x! 2 s1~x!~x 2 Xt !!0~s2~x!s0~x! 2 s12~x!!# , and sr~x! 5 ~10T !(s51 T kh~x 2 Xs!~x 2 Xs!r for r 5 0,1,2+ We also define Df ~x! 5 ( t51 T wt ~x! f ~Xt !+ If Du is a MT -consistent estimator of u, then we have E $ Df ~x, Du! 2 Df ~x,u!%2 5 OS 1T D+ It follows from Fan and Gijbels ~1996! that E @ Zf ~x! 2 f ~x!# 5 1 2 h 2sk2 f ~2! ~x! 1 ck f ~3! ~j1!h 3 and E @ Df ~x! 2 f ~x!# 5 1 2 h 2sk2 f ~2! ~x! 1 dk f ~3! ~j2 !h 3, provided that the first three derivatives of f ~x! exist, where j1 and j2 lie between x and h and x, ck, and dk are constants depending on functionals of k~{!, and sk 2 5 *x 2k~x! dx+ This implies that as T r ` E @ Zf ~x! 2 Df ~x!# 5 ~ck f ~3! ~j1! 2 dk f ~3! ~j2 !!h 3+ (2.7) As can be seen from ~2+7!, the use of the difference Zf ~x! 2 Df ~x, Du! can avoid undersmoothing+ In other words, we can still assume lim supTr`Th 5 , `+ Let us now establish our test statistic+ We first have a look at the following distance function: D~ f,u! 5E~ f ~x! 2 f ~x,u!!2 f ~x! dx+ This naturally suggests estimating D~ f,u! by D~ Zf, Du! 5E~ Zf ~x! 2 Df ~x, Du!!2 Zf ~x! dx+ 848 JITI GAO AND MAXWELL KING We then propose using a test statistic of the form ZNT 5 ZNT ~h! 5 Th E~ Zf ~x! 2 Df ~x, Du!!2 Zf ~x! dx+ (2.8) We now state the main results of this section+ Their proofs are relegated to Appendix A+ THEOREM 2+1+ (i) Suppose that Assumptions A.1–A.5 in Appendix A hold. Then under H0 in (2.3) we have LT ~h! 5 ZNT ~h! 2 m0 Mhs0 rD N~0,1! as T r `, where m0 5 R~k!*2` ` f 2~x! dx and s02 5 2k ~4!~0!* f 4~x! dx. (ii) Assume that the conditions of (i) hold. In addition, assume that there is a random data-driven Zh such that ~ Zh0h! 2 1 rp 0 as T r `. Then under H0 in (2.3) we have LT ~ Zh! 5 ZNT ~ Zh! 2 m0 M Zhs0 rD N~0,1! as T r `+ THEOREM 2+2+ (i) Suppose that Assumptions A.1–A.5 in Appendix A hold. Then under H0 in (2.3) we have ZLT ~h! 5 ZNT ~h! 2 [mT ~h! Mh [sT ~h! rD N~0,1! as T r `, where [mT ~h! and [sT ~h! are as defined in (2.4). (ii) Assume that the conditions of (i) hold. In addition, assume that there is a random data-driven Zh such that ~ Zh0h! 2 1 rp 0 as T r `. Then under H0 in (2.3) we have ZLT ~ Zh! 5 ZNT ~ Zh! 2 [mT ~ Zh! M Zh [sT ~ Zh! rD N~0,1! as T r `+ Remark 2+1+ ~i! Similar to ZL0T of ~2+4!, one may replace ZNT ~h! by ENT ~h! 5 Th T (t51 T ~ Zf ~Xt ! 2 Df ~Xt , Du!!2 5 h ( t51 T ~ Zf ~Xt ! 2 Df ~Xt , Du!!2+ ~ii! As can be seen from Theorem 2+2~i!, we need to estimate both the asymp- totic mean and variance of ZNT ~h! involved in practice+ It is possible to avoid estimating this kind of unknown quantity by introducing a weight function into ZNT ~h!+ In both theory and practice, however, the asymptotic power of the test may depend on the choice of such a weight function+ We therefore follow a ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 849 suggestion made by two of the referees and use the natural form ZNT ~h! to con- struct an adaptive test in Section 3+ ~iii! Theorem 2+2~i! establishes an asymptotic normality test statistic+ Theo- rem 2+2~ii! shows that the asymptotic normality remains unchanged when h is replaced with the random data-driven Zh, which is known as the plug-in method+ Fan and Gijbels ~1996, pp+ 152–154! have shown that the plug-in method has some advantages in applications+ Whether the proposed test statistic ZLT ~h! is optimal has not been discussed+ A modified form of the test statistic is shown to be optimal, and the detailed discussion is given in Section 3+ 3. AN ADAPTIVE TEST PROCEDURE Section 2 establishes the asymptotic normality of the test statistic for testing the marginal densities+ The test statistic has nontrivial power only if CT con- verges more slowly than T 2102 + To improve the asymptotic power properties of the test, we consider extending the approach of Horowitz and Spokoiny ~2001! for testing nonparametric regression functions+ It is assumed that a marginal density function g belongs to a class of s-times ~s $ 2! differentiable density functions on R1 , such as a Hölder, Sobolev, or Besov class, G, which is sepa- rated from the null hypothesis by some distance CT that converges to zero as T r `+ The objective of this section is to find the fastest rate at which CT can approach zero while permitting consistent testing uniformly over G+ This rate is called the optimal rate of testing+ A test is consistent uniformly over G if lim Tr` inf g[G P~H0 is rejected against g! 5 1+ (3.1) Thus, the optimal rate of testing is the fastest rate at which CT can approach zero while maintaining ~3+1!+ 3.1. Asymptotic Behavior of the Test Statistic under the Null Hypothesis As can be seen in Section 2, the proposed test statistic depends on the band- width+ This section then suggests using L* 5 max h[HT ZLT ~h! 5 max h[HT ZNT ~h! 2 [mT ~h! Mh [sT ~h! , (3.2) where HT 5 $h 5 hmaxak : h $ hmin, k 5 0,1,2, + + + % , in which 0 , hmin , hmax and 0 , a , 1+ Let JT denote the number of elements of HT + In this case, JT # log10a~hmax0hmin!+ Detailed conditions on hmin and hmax will be given in Assump- tion B+3 in Appendix B+ 850 JITI GAO AND MAXWELL KING Simulation Scheme. We discuss how to obtain a critical value for L*+ The exact a-level critical value, la* ~0 , a , 1!, is the 1 2 a quantile of the exact finite sample distribution of L*+ Because u0 is unknown, la* cannot be evaluated in practice+ We therefore suggest choosing a simulated a-level critical value, la, by using the following simulation procedure+ 1+ For the simulation, we either use resamples of the sampled data Xt or generate the data Xt from the marginal density f ~x,u0! or the correspond- ing transition density with an initial value of u0 under H0+ 2+ The true value u0 is estimated based on the simulated $Xt % , and the result- ing estimate is denoted by Zu+ 3+ We choose HT as specified following ~3+2! with hmin and hmax satisfying Assumption B+3 in Appendix B and then compute L* of ~3+2! using the simulated $Xt % and Zu+ 4+ Repeat the preceding steps M times and produce M versions of L*, Lm* for m 5 1,2 + + + ,M+ The simulated critical value la is then the ~1 2 a!% per- centile of the M values, Lm* for m 5 1,2 + + + ,M, of L*+ We now state the following result, and its proof is relegated to Appendix B+ THEOREM 3+1+ Assume that Assumptions A.1, A.3, and A.4 in Appendix A and B.1–B.3 listed in Appendix B hold. Then under H0 lim Tr` P~L* . la! 5 a+ The main result on the behavior of the test statistic L* under H0 is that la is an asymptotically correct a-level critical value under any model in H0+ 3.2. Consistency against a Fixed Alternative We now show that L* is consistent against a fixed alternative model+ Assume that model ~1+1! holds+ Let the parameter set Q be an open subset of Rq + Let F 5 $ f ~{,u! : u [ Q% satisfy Assumption B+1 in Appendix B+ For convenience, let F~u! 5 ~ f ~X1,u!, + + + , f ~XT ,u!!t and Nf 5 ~ f ~X1!, + + + , f ~XT !!t+ Measure the distance between f and F by the normalized l2 distance r~ f,F ! 5 F inf u[Q S 1T 7 Nf 2 F~u!72DG102, where 7{7 denotes the euclidean norm+ If H0 is false, then r~ f,F ! $ Cr for all sufficiently large T and some Cr . 0+ A consistent test will reject a false H0 with probability approaching one as T r `+ ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 851 The following theorem establishes a consistency result, and its proof is rel- egated to Appendix B+ THEOREM 3+2+ Assume that the conditions of Theorem 3.1 hold. In addi- tion, if there is a Cr . 0 such that limTr`P~r~ f,F ! $ Cr! 5 1 holds then lim Tr` P~L* . la! 5 1+ 3.3. Consistency against a Sequence of Local Alternatives In this section, we consider the consistency of L* under local alternatives of the form fT ~x! 5 f ~x,u1! 1 CT DT ~x! (3.3) with CT $ C0T 2102M log log T for some constant C0 . 0 and u1 [ Q+ Let NfT 5 ~ fT ~X1!, + + + , fT ~XT !!t and ODT 5 ~DT ~X1!, + + + ,DT ~XT !!t+ We now have that 1 T 7 NfT 2 F~u1!72 5 CT2 T 7 ODT72 5 CT2 T (t51 T 6DT ~Xt !62+ (3.4) To ensure that the rate of convergence of NfT to the parametric model F~u1! is the same as the rate of convergence of CT to zero, in view of ~3+4!, we need to assume that DT ~x! is a continuous function that is normalized so that lim Tr` PS 1T (t51 T 6DT ~Xt !62 $ dD5 1 (3.5) for some d . 0+ When DT ~{! does not depend on T, condition ~3+5! can be replaced by E @D2~X1!# . 0, which holds automatically when D~{! Þ 0+ We now state the following consistency result, and its proof is relegated to Appendix B+ THEOREM 3+3+ Assume that Assumptions A.1, A.3, and A.4 in Appendix A and B.1–B.3 with hmax 5 cmax~log log T !21 for some constant cmax . 0 in Appen- dix B hold. Let Du be a MT -consistent estimator of u. Let fT satisfy (3.3) with CT $ CT 2102M log log T for some constant C . 0. In addition, let condition (3.5) hold. Then lim Tr` P~L* . la! 5 1+ 852 JITI GAO AND MAXWELL KING The result shows that the power of the adaptive, rate-optimal test approaches one as T r ` for any function DT ~{! and sequence $CT % that satisfy the con- ditions of Theorem 3+3+ 3.4. Consistency against a Sequence of Smooth Alternatives This section establishes that L* is consistent uniformly over alternatives in a Hölder smoothness class whose distance from the parametric model approaches zero at the fastest possible rate+ It can be shown that we can extend the results to Sobolev and Besov classes under more technical conditions+ Before specifying our smoothness classes, we introduce the following nota- tion+ Define the Hölder norm 7 f 7H, s 5 sup x[Sf ( 1#j#s * d j f ~x! dx j *, (3.6) where Sf 5 $x [ R1 : f ~x! . 0% + The smoothness classes that we consider consist of functions f [ S~H, s! [ $ f : 7 f 7H, s # cH % for some ~unknown! s $ 2 and cH , `+ For some s $ 2 and all sufficiently large Cf , `, define BH,T 5 Hf [ S~H, s! : lim Tr` P~r~ f,F ! $ Cf ~T 21M log log T !2s0~4s11! ! 5 1J, (3.7) where r~ f,F ! is as defined in Section 3+2+ We now state the following consistency result, and its proof is relegated to Appendix B+ THEOREM 3+4+ Assume that Assumptions A.1, A.3, and A.4 in Appendix A and B.1–B.3 in Appendix B hold. Then for 0 , a , 1 and BH,T as defined in (3.7) lim Tr` inf f[BH,T P~L* . la! 5 1+ Remark 3+1+ Theorems 3+1–3+4 show that we have established some consis- tency results for the proposed test given in ~3+2!+ Such consistency results cor- respond to Theorems 1– 4 of Horowitz and Spokoiny ~2001! for a fixed design regression case+ In our case, we deal with the case where the observations are stationary and a-mixing time series+ In addition, the optimum version L* is asymptotically consistent as established in Theorem 3+2+ This is one of the advan- tages of our test over existing ones, such as the natural competitor proposed in Aït-Sahalia ~1996a!+ In Section 4, we show that our test also outperforms the natural competitor in the finite sample case+ ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 853 4. EXAMPLE OF IMPLEMENTATION AND APPLICATION IN DIFFUSION MODELS This section illustrates the proposed adaptive test by the following example+As the bootstrap simulation procedure for selecting both the bandwidth and simu- lated critical values is extremely computationally demanding, especially for large numbers of data, we only consider using the CIR model proposed by Cox et al+ ~1985! and show how to implement the adaptive test statistic L* of ~3+2! in practice through using a simulated example+ The main reason for choosing the model is not only because both the marginal and transition density functions have closed forms but also because the model has been studied extensively in the literature+ See, for example, Aït-Sahalia ~1999! and Hong and Li ~2004!+ Example 4.1 We consider using the CIR model given by drt 5 k~b 2 rt ! dt 1 sMrt dBt , (4.1) where k . 0, b . 0, and s . 0 are unknown parameters and Bt is standard Brownian motion+ It can be shown that $rt % is distributed on R1 5 ~0,`! if 2kb0s 2 $ 1+ Furthermore, it follows from Lemma 3+1 of Masry and Tjøstheim ~1995! that the process $rt % satisfies Assumption A+1~i!+ Alternatively, one may apply Assumption A+3' of Aït-Sahalia ~1996b, p+ 552! to verify that $rt % is strictly stationary and a-mixing+ As a result of ~2+2!, the marginal density function of $rt % satisfying model ~4+1! is f ~x,u! 5 ~2k! n11 G~n 1 1!s 2~n11! {x n{expS2 2k s 2 xD, x [ R1 5 ~0,`!, (4.2) where u 5 ~b,k,s!, n 5 2kb0s 2 2 1, and G~{! is the usual gamma function+ Let u0 be the true value of u+ To construct a sequence of local alternatives, we also consider using a mar- ginal density of the form f1~x,u! 5 1 G~2 1 n1! ~n1 b! 21n1{x2~31n1!{exp~2n1 bx21 !, x [ R1, (4.3) where n1 5 2k0s 2 + It is known that f1~x,u! is the marginal density of $rt % satisfying the AG model proposed in Ahn and Gao ~1999! drt 5 k~b 2 rt !rt dt 1 srt1+5 dBt , t 5 1,2, + + + , (4.4) with parameter values k . 0, b . 0, and s . 0+ The necessary and sufficient conditions for stationarity and unattainability of 0 and ` in finite expected time are the pairs k . 0 and b . 0 ~see Ahn and Gao, 1999!+ To show that $rt % is 854 JITI GAO AND MAXWELL KING strictly stationary and a-mixing, as explained in Appendix A of Ahn and Gao ~1999, pp+ 755–756!, one needs only to verify Assumption A+39 of Aït-Sahalia ~1996b, p+ 552!+ It is easy to see that such an assumption holds for the marginal density, drift, and diffusion functions given in ~4+3! and ~4+4!+ The corresponding structure of the test problem ~2+3! for this example can be constructed as H0 : f ~x! 5 f ~x,u0 ! versus H1 : fT ~x! 5 f ~x,u1! 1 CT DT ~x!, (4.5) where CT 5 ~T 21M log log T !409 and DT ~x! 5 f1~x,u1! 2 f ~x,u1!, (4.6) in which u1 [ Q+ The reason for choosing such DT ~{! as the local shift function is to ensure that the models under H1 fluctuate closely around those under H0+ The choice of ~4+5! and ~4+6! ensures that ~3+7! holds with s 5 2+ This implies that the adaptive test is consistent against the sequence with an optimal rate+ Note that Assumptions B+1 and B+2 hold+ In the following simulation, we consider using a class of alternatives of the form fc~x,u1! 5 f ~x,u1! 1 c{~ f1~x,u1! 2 f ~x,u1!! 5 ~1 2 c! f ~x,u1! 1 cf1~x,u1!, (4.7) where u1 [ Q and 0 , c , 1 is defined as the truncation parameter to be chosen+ To compute the nonparametric estimators involved, we choose the normal kernel function given by k~x! 5 1 M2p e 2~x 202! (4.8) throughout the simulation+ Observe that Assumptions A+1–A+4 hold+ For the CIR and AG models, we simulate the data from their marginal density and tran- sitional functions, which all have closed forms+ In the detailed simulation, we simulate the data from ~4+2! for the CIR model, ~4+3! for the AG model, and then ~4+7! under H1+ Using the simulated data, we compute L* 5 max h[HT ZLT ~h! 5 sup h[HT ZNT ~h! 2 [mT ~h! Mh [sT ~h! , (4.9) in which R~k! 5 102Mp and k ~4!~0! 5 102M2p are used after the choice of ~4+8! and HT is as defined following ~3+2! with hmin 5 T 2~11036!, hmax 5 2~ log log T !21 , and a 5 3536_ + Note that Assumption B+3 holds+ ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 855 To compare L* with ZL0T ~h! in ~2+4!, we construct a test statistic of the form L0* 5 ZL0T ~h* ! 5 ZMT ~h* ! 2 [mT ~h* ! Mh* [sT ~h* ! , (4.10) where h* is chosen by using the following procedure+ • We simulate Xt with probability 1 2 c from the CIR model and with prob- ability c from the AG model with an initial value of u1 under H1+ • Use the simulated data $Xt : t 5 1,2, + + + ,T % to estimate u1+ • Compute the resulting function of h given by ZL0T ~h! 5 ZMT ~h! 2 [mT ~h! Mh [sT ~h! + • Repeat the preceding steps Q 5 1,000 times and produce Q versions of ZL0T ~h! denoted by ZL0T,m~h! for m 5 1,2, + + + ,Q+ Use the Q functions of h, ZL0T,m~h! for m 5 1,2, + + + ,Q, to construct their empirical bootstrap distribu- tion function, that is, Fh~u! 5 1 Q (m51 Q I ~ ZL0T,m~h! # u!, where I ~U # u! is the usual indicator function+ • For a given asymptotic critical value ecva at the level a ~e+g+, ecv0+005 5 1+645 at the 5% level!, we then calculate the following power function: c~h! 5 1 2 Fh~ecva!+ • Find approximately at which h value the power function c~h! is maxi- mized+ Denote the maximizer by h*+ We then consider using the same choice of the parameter values as in ~17! of Pritsker ~1998!+ This means that the baseline model is model ~4+1! with k 5 0+89218, b 5 0+090495, and s 5 M0+032742+ In this example, the same param- eter values were also used as u1 in computing the power of the tests L* and L0*+ The truncation parameter was chosen as c 5 0 under H0, whereas the trunca- tion parameter was chosen as c 5 133_ under H1+ Three different sizes of sample T 5 1,000, 2,755, or 5,500 were then considered+ The corresponding simulated critical values, la and l0a, of L* and L0* at the a level are then found by using the simulation scheme proposed in Section 3+1+ The sizes of the tests were then computed based on the data simulated under H0, and the power values of the tests were calculated based on the data generated under H1+ In implementing the simulation procedure, we used M 5 1,000 involved in the simulation 856 JITI GAO AND MAXWELL KING scheme proposed in Section 3+1+ The number of simulations in producing Table 1 was also 1,000+ Both the size and the power of L* and L0* are given in Table 1+ Remark 4+1+ ~i! As can be seen from Table 1, the power values of both L* and L0* look reasonable when c 5 133_ , or about 3%+ This may show that both L* and L0* are practically applicable to the medium sample case, because the dif- ference between the null hypothesis and its alternative was made deliberately close+ We also computed the power of the tests for the case where c 5 120_ , or 5%+ Our small sample results showed that the power of L* was already 100% even when T 51,000+ In general, it is true that the power increases as c increases for each case+ Observe that L* is slightly more powerful than L0* , although h* involved in L0* 5 ZL0T ~h*! has been chosen based on the assessment of its power+ We observe that the sizes of the two tests are also close to either 5% in the first half of Table 1 or 1% in the second half of Table 1+ ~ii! We also examined the dependence of the power on the choice of the ini- tial parameter values+ Our experience suggests that the power of the tests mainly depends on the choice of the truncation parameter c+ This is both understand- able and expected, because the test statistics finally depend only on the estima- tion and reestimation procedure of the vector of the initial parameters rather than the initial parameter values themselves+ This is probably why artificial values or parameter values estimated from a set of real data are used as initial values for starting a simulation procedure+ For example, Hong and Li ~2004! use the parameter values estimated from the U+S+ interest rate series for their simulation procedure+ ~iii! Compared with existing results ~see Pritsker, 1998!, both the size and power of L0* have been significantly improved+ This is probably because ~a! the choice of h involved in ZL0T ~h! is based on the assessment of the power of ZL0T ~h! rather than using an estimation-based optimal value and ~b! to avoid using the Table 1. Rejection rates for the marginal density tests Observation Null hypothesis is true Null hypothesis is false T L* L0* L* L0* The 5% level 1,000 0+044 0+039 0+721 0+618 2,755 0+055 0+058 0+874 0+712 5,500 0+052 0+042 0+992 0+887 The 1% level 1,000 0+007 0+017 0+526 0+497 2,755 0+014 0+019 0+673 0+532 5,500 0+009 0+006 0+869 0+795 ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 857 asymptotic distribution of ZL0T ~h! and then an asymptotic critical value of 1+645 at the 5% or 2+33 at the 1% level, we have used the bootstrap-based simulated critical value, l0a, at the level a+ We also computed both the power and size values for the case where h was chosen by using a cross-validation criterion, and the resulting sizes and power values were similar to those obtained by Pritsker ~1998!, although L* always performed better than L0*+ This further demonstrates that the asymptotic distribution of either ZLT ~h! or ZL0T ~h! can only provide some kind of idea about the asymptotic behavior+ In practice, we strongly suggest using the proposed bootstrap simulation procedure for choosing a sim- ulated critical value rather than an asymptotic critical value+ 5. CONCLUSION In this paper, we have considered testing the general continuous-time diffusion model ~1+1! under the a-mixing condition+ The results for continuous-time mod- els under the a-mixing condition complement some existing results under the b-mixing condition+ See, for example, Aït-Sahalia ~1996a!+ Moreover, an adap- tive and optimal test procedure has been established+ This extension corre- sponds to Horowitz and Spokoiny ~2001! for the fixed design nonparametric regression and then to Chen, Gao, and Li ~2001! for a nonparametric time series regression model+ To deal with the a-mixing condition, we have established some novel results for moment inequalities ~see Lemma C+2! and limit theo- rems ~see Lemma A+1! for degenerate U-statistics of strongly dependent pro- cesses+ Both Lemmas A+1 and C+2 are applicable to some other estimation and testing of diffusion processes with the a-mixing condition ~for more about var- ious mixing conditions, see Doukhan, 1995!+ In addition, we have demon- strated how to implement the proposed test procedure in practice through using a simulated example+ The results given in this paper can be extended in a number of directions+ First, it is possible to consider testing for both the marginal and transition den- sity functions simultaneously, because the transition density can capture the full dynamics of a diffusion process and, in particular, can distinguish the diffusion processes that have the same marginal density but different transition densities+ Second, the results of this paper for the short-range dependent continuous-time case can be extended to the long-range dependent continuous-time case+ Third, one probably can relax the strict stationarity and the mixing condition, as the recent work by Aït-Sahalia ~1999! and Karlsen and Tjøstheim ~2001! indicates that it is possible to do such work without the stationarity and the mixing con- dition+ This part is particularly important for two reasons: ~i! for the long- range dependent case one needs to avoid assuming both the long-range dependence and the mixing condition, as they contradict each other; and ~ii! some important models are nonstationary+ These are some issues left for future research+ 858 JITI GAO AND MAXWELL KING REFERENCES Ahn, D+H+ & B+ Gao ~1999! A parametric nonlinear model of term structure dynamics+ Review of Financial Studies 12, 721–762+ Aït-Sahalia, Y+ ~1996a! Testing continuous-time models of the spot interest rate+ Review of Finan- cial Studies 9, 385– 426+ Aït-Sahalia, Y+ ~1996b! Nonparametric pricing of interest rate derivative securities+ Econometrica 64, 527–560+ Aït-Sahalia, Y+ ~1999! Transition densities for interest rate and other nonlinear diffusions+ Journal of Finance 54, 1361–1395+ Black, F+ & M+ Scholes ~1973! The pricing of options and corporate liabilities+ Journal of Political Economy 3, 637– 654+ Chapman, D+ & N+ Pearson ~2000! Is the short rate drift actually nonlinear? Journal of Finance 54, 355–388+ Chen, S+, J+ Gao, & M+ Li ~2001! Simultaneous Specification Tests for Nonparametric Regression with Application to Diffusion Model Testing+ Working paper, Department of Statistics and Applied Probability, National University of Singapore+ Available at www+stat+nus+edu+sg0;stacsx+ Cox, J+, E+ Ingersoll, & S+ Ross ~1985! An intertemporal general equilibrium model of asset prices+ Econometrica 53, 363–384+ Doukhan, P+ ~1995! Mixing-Properties and Examples+ Lecture Notes in Statistics+ Springer-Verlag+ Fan, J+ & I+ Gijbels ~1996! Local Polynomial Modelling and Its Applications+ Chapman and Hall+ Fan, J+ & C+ Zhang ~2003! A re-examination of Stanton’s diffusion estimation with applications to financial model validation+ Journal of the American Statistical Association 457, 118–134+ Fan, Y+ & Q+ Li ~1998! Central limit theorem for degenerate U-statistics of absolutely regular pro- cesses with applications to model specification testing+ Journal of Nonparametric Statistics 10, 245–271+ Gao, J+ & M+ King ~2001! Estimation and Model Specification Testing in Nonparametric and Semi- parametric Regression+ Working paper, School of Mathematics and Statistics, the University of Western Australia, Australia+ Available at www+maths+uwa+edu+au0;jiti0jems+pdf+ Gao, J+, H+ Tong, & R+ Wolff ~2002! Model specification tests in nonparametric stochastic regres- sion models+ Journal of Multivariate Analysis 83, 324–359+ Hjellvik, V+, Q+ Yao, & D+ Tjøstheim ~1996! Linearity testing using local polynomial approxima- tion+ Discussion paper 60, Sonderforschungsbereich 373, Humboldt-Universität zu Berlin, Span- dauerst+ 1+ 10178, Berlin+ Hong, Y+ & H+ Li ~2004! Nonparametric specification testing for continuous-time models with appli- cation to spot interest rates+ Review of Financial Studies 17, forthcoming+ Horowitz, J+ & V+ Spokoiny ~2001! An adaptive, rate-optimal test of a parametric mean-regression model against a nonparametric alternative+ Econometrica 69, 599– 632+ Jiang, G+ & J+ Knight ~1997! A nonparametric approach to the estimation of diffusion processes with an application to a short-term interest rate model+ Econometric Theory 13, 615– 645+ Karlsen, H+ & D+ Tjøstheim ~2001! Nonparametric estimation in null recurrent time series+ Annals of Statistics 29, 372– 416+ Masry, E+ & D+ Tjøstheim ~1995! Nonparametric estimation and identification of nonlinear ARCH time series+ Econometric Theory 11, 258–289+ Pritsker, M+ ~1998! Nonparametric density estimation and tests of continuous time interest rate models+ Review of Financial Studies 11, 449– 487+ Roussas, G+ & D+ Ioannides ~1987! Moment inequalities for mixing sequences of random vari- ables+ Stochastic Analysis and Applications 5, 61–120+ Stanton, R+ ~1997! A nonparametric model of term structure dynamics and the market price of interest rate risk+ Journal of Finance 52, 1973–2002+ Sundaresan, S+ ~2001! Continuous-time methods in finance: A review and an assessment+ Journal of Finance 55, 1569–1622+ ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 859 APPENDIX A This Appendix lists the necessary assumptions for the establishment and the proof of the main results given in Section 2+ A.1. Assumptions. Let the parameter set Q be an open subset of Rq+ Let F5 $ f ~{,u! : u [ Q% + Define ,u f ~x,u! 5 ]f ~x,u!0]u, ,u2 f ~x,u! 5 ]2f ~x,u!0]u]u ' , and ,u3 f ~x,u! 5 ]3 f ~x, u!0]u]u ']u '' whenever these derivatives exist+ For any q 3 q matrix D, define 7D7` 5 sup v[Rq 7Dv7 7v7 , where 7v72 5 (i51 q vi2 for v 5 ~v1, + + + , vq!t + Assumption A.1. ~i! Assume that the process $rt % is strictly stationary and a-mixing with the mixing coefficient a~t ! 5 Caa t defined by a~t ! 5 sup $6P~A ù B! 2 P~A!P~B!6 : A [ V1s ,B [ Vs1t ` % for all s, t $ 1, where 0 , Ca , ` and 0 , a , 1 are constants and Vi j denotes the s-field generated by $rt : i # t # j % + ~ii! Assume that the univariate kernel function k ~{! is nonnegative, symmetric, and four-times differentiable on R1 5 ~2`,`!+ In addition, *2` ` x 2k~x! dx , ` and *2` ` k 2~x! dx , `+ Assumption A.2. ~i! The parameter space Q , Rq is compact+ In a neighborhood of the true parameter u0, f ~x, u! is twice continuously differentiable in u; E @~]f ~x, u!0 ]u!~]f ~x,u!0]u!t# is of full rank+ In addition, assume that G~x! is a positive and inte- grable function with E @G~Xt !# , ` uniformly in t $ 1 such that supu[Q6 f ~Xt ,u!62 # G~Xt ! and supu[Q7,u j f ~Xt ,u!72 # G~Xt ! for j 5 1,2,3, where for B 5 $bij %1#i, j#q, 7B72 5 (i51 q (j51 q bij2+ ~ii! Assume that Du is a MT -consistent estimator of u0+ Assumption A.3. For every u [ Q: ~i! The drift and the diffusion functions are three times continuously differentiable in x [ R1 5 ~0,`!, and s . 0 on R1+ ~ii! The integral of Tm~v,u! 5 @10s2~v,u!# exp~2*v Sv 2@m~x,u!0s2~x,u!# dx! con- verges at both boundaries of D, where Sv is fixed in D+ ~iii! The integral of s~v,u! 5 exp~*v Sv 2@m~x,u!0s2~x,u!# dx! diverges at both bound- aries of D+ Assumption A.4. ~i! Assume that the first three derivatives of f ~x! are continuous on D and that f ~x! . cf . 0 on the interior of D for some cf . 0+ In addition, both f ~x! and f 2~x! are integrable on D+ ~ii! The initial random variable r0 is distributed as f ~x!+ ~iii! The true drift and diffusion functions satisfy Assumption A+3+ 860 JITI GAO AND MAXWELL KING Assumption A.5. The bandwidth parameter h satisfies that lim Tr` h 5 0, lim Tr` Th 2 5`, and lim sup Tr` Th 5 , `+ Remark A.1. Assumptions A+1–A+4 are quite natural in this kind of problem+Assump- tions A+2–A+4 correspond to Assumptions A0,A1, and A3 of Aït-Sahalia ~1996a!+Assump- tion A+1 is the exception+ Assumption A+1~i! assumes the a-mixing condition, which is weaker than the b-mixing condition+ Assumption A+1~ii! is quite general, allowing the use of the standard normal kernel+ Assumption A+5 ensures that the theoretically opti- mum value of hoptimal 5 CT 2105 can be included+ This is important, because there may be cases in which hoptimal is also optimal for testing purposes+ A.2. Technical Lemmas. The following lemmas are necessary for the proof of the main results stated in Section 2+ LEMMA A+1+ Let jt be an r-dimensional strictly stationary and strong mixing ~a-mixing) stochastic process. Let f~{,{! be a symmetric Borel function defined on Rr 3 Rr. Assume that for any fixed x [ Rr, E @f~j1, x!# 5 0 and E @f~ji ,jj !6V0j21# 5 0 for any i , j, where Vij denotes the s-field generated by $js : i # s # j %. Let fst 5 f~js,jt ! , sst2 5 var~fst ! , and sT2 5 (1#s,t#T sst2. For some small constant 0 , d , 1, let MT1 5 max 1#i,j,k#T maxHE6fik fjk 611d,E6fik fjk 611d dP~ji ! dP~jj ,jk !J , MT 21 5 max 1#i,j,k#T maxHE6fik fjk 62~11d!,E6fik fjk 62~11d! dP~ji ! dP~jj ,jk !J , MT 22 5 max 1#i,j,k#T maxHE6fik fjk 62~11d! dP~ji ,jj ! dP~jk !, E6fik fjk 62~11d! dP~ji ! dP~jj ! dP~jk !J , MT 3 5 max 1#i,j,k#T E6fik fjk 62, MT4 5 max1,i, j, k#2T i, j, k different Hmax P E6f1i fjk 62~11d! dPJ , where the maximization over P in the equation for MT4 is taken over the four probability measures P~j1,ji ,jj ,jk! , P~j1!P~ji ,jj ,jk! , P~j1!P~ji1 !P~ji2 ,ji3 ! , and P~j1!P~ji !P~jj !P~jk!, where ~i1, i2, i3! is the permutation of ~i, j, k! in ascending order; MT51 5 max 1#i,j,k#T maxHE*Efik fjk fik fjk dP~ji !*2~11d!J , MT52 5 max 1#i,j,k#T maxHE *Efik fjk fik fjk dP~ji !*2~11d! dP~jj ! dP~jk !J , MT6 5 max 1#i,j,k#T E*Efik fjk dP~ji !* 2 + ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 861 Assume that all the MT' s are finite. Let MT 5 max$T 2MT1 10~11d! ,T 2MT51 10@2~11d!# ,T 2MT52 10@2~11d!# ,T 2MT6 102% , NT 5 max$T 302MT21 10@2~11d!# ,T 302MT22 10@2~11d!# ,T 302MT3 102 ,T 302 MT4 10@2~11d!#% , If limTr`~max$MT ,NT %0sT2! 5 0, then 1 sT ( 1#s,t#T f~js ,jt ! rD N~0,1! as T r `+ Remark A.2. Lemma A+1 establishes central limit theorems for degenerate U-statistics of strongly dependent processes+ It should be pointed out that the conclusion of Lemma A+1 remains true when the martingale assumption that E @f~ji ,jj !6V0 j21# 5 0 for any i , j is removed+ Such a martingale assumption is used only for a direct application of an existing central limit theorem ~CLT! for martingales+ Without such a condition, one needs only to decompose f~ji ,jj ! 5 f~ji ,jj ! 2 E @f~ji ,jj !6V0 j21# 1 E @f~ji ,jj !6V0 j2k# [ Ef~ji ,jj ! 1 E @f~ji ,jj !6V0 j21# and then apply the martingale CLT to Ef~j,jj !+ Using the condition that E @f~j1, x!# 5 0 for each given x, one can show that the terms involving E @f~ji ,jj !6V0 j21# are negligi- ble ~see Roussas and Ioannides, 1987, Theorem 5+5!+ Thus, as assumed in Lemma 3+2 of Hjellvik, Yao, and Tjøstheim ~1996! and Theorem 2+1 of Fan and Li ~1998!, the condi- tion that E @f~j1, x!# 5 0 for each given x is the key assumption+ Proof. Let UT 5 ( 1#s,t#T f~js ,jt !, Vt 5 ( s51 t21 f~js ,jt !, var~UT ! 5 ( t52 T var~Vt ! 5 ( t52 T E @Vt2# 5 ( 1#s,t#T sst 2 1 2 ( 1#i,j,k#T E @fik fjk # + To prove Lemma A+1, it suffices to show that as T r ` sT 22 ( t52 T Vt2 rp 1 (A.1) and sT 24 ( t52 T E @Vt4# r 0+ (A.2) By Lemma C+1 ~with h1 5 fik, h2 5 fjk, l 5 2, pi 5 2~1 1 d!, and Q 5 10~1 1 d!!, E6fik fjk 6 # 10MT110~11d! ad0~11d!~ j 2 i !+ 862 JITI GAO AND MAXWELL KING Therefore, ( 1#i,j,k#T E6fik fjk 6 # 10T 2MT110~11d! ( i51 T S1 2 iT Dad0~11d! ~i ! # CT 2MT110~11d!, because (i51 ` ad0~11d!~i ! , `+ Observe that EF( t52 T Vt2 2 sT2G2 5 EH ( 1#s,t#T @fst 2 2 sst 2# 1 2 ( 1#i,j,k#T fik fjkJ2 # 2EH ( 1#s,t#T @fst 2 2 sst 2#J2 1 8EH ( 1#i,j,k#T fik fjkJ2+ (A.3) Let hijk 5 13_ ~fikfjk 1 fij fkj 1 fji fki ! and hij 5 13_ *fikfjk dP~jk!+ Then by Lemma C+2~i! in Appendix C, EH ( 1#i,j,k#T fik fjkJ2 5 EH ( 1#i,j,k#T hijkJ2 # 2EH ( 1#i,j,k#T @hijk 2 hij 2 hik 2 hjk #J2 1 8T 2EH ( 1#s,t#T hstJ2 # C$T 3MT 2110~11d! 1 T 3MT 2110~11d! 1 T 3MT 3 1 T 4MT5110~11d! 1 T 4MT5210~11d! 1 T 4MT6 % 5 o~sT4!+ (A.4) Let Cf 5 *f122 f342 dP~j1! dP~j2 ! dP~j3 ! dP~j4 !, where P~j! denotes the probability measure of j+ Using Lemma C+1 repeatedly, we have that for different i, j, k, l 6E @fij2 fkl2 # 2 Cf 6 # 10$a~D~i, j, k, l !!%12@10~11d!#MT410~11d! 5 10MT410~11d! $a~D~i, j, k, l !!%d0~11d!, (A.5) where D~i, j, k, l ! is the minimum increment in the sequence that is the permutation of i, j, k, l in ascending order+ Similar to ~A+5!, one can have for all different i, j, k, l 6sij2 skl2 2 Cf 6 # 10MT410~11d! $a~D~i, j, k, l !!%d0~11d!+ Therefore, EH ( 1#i,j#T ~fij 2 2 sij 2!J2 5 ( i,j, k,l, i, j, k, l different 6E~fij2 fkl2 ! 2 sij2 skl2 61 O~T 3MT 310~11d!! # 2H ( i,j,k,l 1 ( i,k,l,j 1 ( i,k,j,lJ 3 @6E @fij2 fkl2 # 2 Cf 61 6sij2 skl2 2 Cf 6# 1 O~T 3MT 3 ! # C1T 3MT410~11d! 1 O~T 3MT 3 ! 5 o~sT4!+ (A.6) ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 863 It now follows from ~A+3!–~A+5! that for any e . 0 PH* 1sT2 (k52 T Vk2 2 1* $ eJ # 1sT4 e2 EF(k52 T Vk2 2 sT2Gr 0+ Thus, ~A+1! holds+ Note that for 2 # k # T, E @Vk4# 5 EH( i51 k21 fik 2 1 2 ( 1#i,j,k fik fjkJ2 5 EH( i51 k fik 4 1 6 ( 1#i,j,k fik 2 fjk 2 1 4 ( l51 k21 ( 1#i,j,k flk 2 fik fjkJ 1 4EH ( 1#i,j,k,1#s,t,k, ~i, j !Þ~s, t ! fik fjk fsk ftkJ 5 4 ( l51 k21 ( 1#i,j,k E @flk2 fik fjk # 1 4 ( 1#i,j,k,1#s,t,k, ~i, j !Þ~s, t ! E @fik fjk fsk ftk # 1 O~T 2MT 3 !+ (A.7) It is easy to see that E6fik fjk fsk ftk 611d dP # HE6fik fjk 62~11d! dPE6fsk ftk 62~11d! dPJ102 # MT4 + Similar to ~A+5!, one can have for any ~i, j ! Þ ~s, t !, 6E @fik fjk fsk ftk #6 # 10MT410~11d! $a~D~i, j, s, t !!%d0~11d!, where D~{! is as defined in ~A+5!+ Consequently, the first two terms on the right-hand side of ~A+7! are of order O~T 3MT410~11d!!, because (k51 ` k 2$a~k!%d0~11d! , `+ Thus, ~A+2! follows from ( k52 T E @Vk4# 5 O~T 3MT410~11d!! 5 o~sT4!+ (A.8) This finishes the proof+ n 864 JITI GAO AND MAXWELL KING Before stating the following lemmas, we define the following notation+ et ~x! 5 k~~x 2 Xt !0h! 2 E @k~~x 2 Xt !0h!# , fst 5 ~Th!21Ees~x!et ~x! f ~x! dx, wt ~x! 5 1 T kh~x 2 Xt ! s2~x! 2 s1~x!~x 2 Xt ! s2~x!s0~x! 2 s1 2~x! , sr ~x! 5 1 T (s51 T kh~x 2 Xs !~x 2 Xs !r, r 5 0,1,2, lt ~u! 5 l~Xt ,u! 5 f ~Xt ! 2 f ~Xt ,u! 5 f ~Xt ,u0 ! 2 f ~Xt ,u!, l~u! 5 ~l1~u!, + + + ,lT ~u!!t, ast 5 ThEws~x!wt ~x! f ~x! dx, bst 5Ees~x!wt ~x! f ~x! dx, N0T 5 N0T ~h! 5 ( s51 T ( t51 T fst , NT ~h! 5 NT ~h,u! 5 ~Th!E$ Zf ~x! 2 Df ~x,u!%2 f ~x! dx 5 N0T ~h! 1 QT ~u! 1 PT ~u! 1 P1T 1 P2T 1 RT ~u!, using Zf ~x! 2 Df ~x,u! 5 Zf ~x! 2 E @ Zf ~x!# 1 E @ Zf ~x!# 2 E @ Df ~x!# 1 E @ Df ~x!# 2 Df ~x! 1 Df ~x! 2 Df ~x,u!, where QT ~u! 5 l~u!tAl~u! 5 ( s51 T ( t51 T ast ls~u!lt ~u!, PT ~u! 5 ( s51 T ( t51 T bst lt ~u!, P1T 5E~E @ Zf ~x! 2 Df ~x!# !2 f ~x! dx, P2T 5E~ Df ~x! 2 E @ Df ~x!# !2 f ~x! dx, in which A is the T 3 T matrix with $ast % as its ~s, t ! element+ ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 865 We assume without loss of generality throughout the rest of this paper that Ek~x! dx 5Ek 2~x! dx 5 R~k! [ 1+ LEMMA A+2+ Under the conditions of Theorem 2.1, we have as T r ` E @N0T ~h!# 5E f 2~x! dx and var @N0T ~h!# 5 2h k ~4! ~0!E f 4~x! dx~1 1 o~1!!+ (A.9) Proof. We now prove ~A+9!+ It follows from Assumptions A+2 and A+3 that as T r ` E @ftt # 5 ~Th!21EE @et2~x!# f ~x! dx 5 1 Th EHEFk 2S x 2 Xth DG2 E 2FkS x 2 Xth DGJ f ~x! dx 5 1 T ~1 1 o~1!!Ek 2~u! du{E f 2~x! dx+ This completes the proof of the first part of ~A+9!+ For the proof of the second part of ~A+9!, let sst 2 5 E@fst2 # and sT2 5 2 ( 1#s, t#T sst 2 + Then sT 2 5 2 ( 1#s, t#T sst 2 5 2 ( t51 T ( s51 T E @fst2 # + We first look at the main component of sT2+ We now have f1st 2 5EE 1 ~Th!2 kS x 2 Xsh DkS y 2 Xsh DkS x 2 Xth DkS y 2 Xth D f ~x! f ~ y! dxdy+ Using Assumptions A+1–A+4, we have as T r ` ast ~x, y! [ EFkS x 2 Xsh DkS y 2 Xsh DkS x 2 Xth DkS y 2 Xth DG 5EEkS x 2 uh DkS y 2 uh DkS x 2 vh DkS y 2 vh D f ~u, v! dudv 5EEkS x 2 yh 1 y 2 uh DkS y 2 uh DkS x 2 vh DkS x 2 vh 2 x 2 yh D f ~u, v! dudv 5 h 2LS x 2 yh DLS y 2 xh D f ~x, y!~1 1 o~1!!, where L~x! 5 *k~x 1 y!k~ y! dy is as defined in ~2+5!+ 866 JITI GAO AND MAXWELL KING Therefore, as T r ` ( 1#s, t#T E @f1st2 # 5 1 ~Th!2 (1#s, t#T EE f ~x! f ~ y!ast ~x, y! dxdy 5 hk ~4! ~0!SE f 4~x! dxD~1 1 o~1!!, (A.10) where k ~4!~{! is as defined in ~2+5!+ Similarly, one can show that as T r ` ( 1#s, t#T E @fst2 2 f1st2 # 5 o~h!+ (A.11) We now deal with the remainder term of var @N0T ~h!# + By Lemma C+1 ~with h1 5 fik, h2 5 fjk, l 5 2, pi 5 2~1 1 d!, and Q 5 10~1 1 d!!, E6fik fjk 6 # 10MT110~11d! ad0~11d!~ j 2 i !, where MT1 is as defined in Lemma A+1+ Therefore, using the fact that (i51 ` ad0~11d!~i ! , `, ( 1#i,j,k#T E6fik fjk 6 # 10T 2MT110~11d! ( i51 T S1 2 iT Dad0~11d! ~i ! # CT 2MT110~11d! 5 o~sT2!, (A.12) whose proof is similar to that of ~A+17!, which follows+ Equations ~A+10!–~A+12! imply var @L0T ~h!# 5 2F ( 1#s, t#T var~fst ! 1 2 ( 1#i,j,k#T E~fik fjk !G 5 2hk ~4! ~0!SE f 4~x! dxD~1 1 o~1!!+ This finishes the proof of the second part of ~A+9!+ n LEMMA A+3+ Under the conditions of Theorem 2.1, we have as T r ` E @ Zf ~x! 2 f ~x!# 5 1 2 h 2sk2 f ~2! ~x! 1 ck f ~3! ~x!h 3~1 1 o~1!!, E @ Df ~x! 2 f ~x!# 5 1 2 h 2sk2 f ~2! ~x! 1 dk f ~3! ~x!h 3~1 1 o~1!!, (A.13) and var @ Df ~x!# 5 E~ Df ~x! 2 E @ Df ~x!# !2 5 C1 h 2 Th ~1 1 o~1!!, (A.14) where C1 is a constant and Zf ~x! , Df ~x! , ck, and dk are as defined in Section 2. ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 867 Proof. We now give only the proof of ~A+14! in some detail, as the proofs of ~A+13! and ~A+14! are similar and quite standard and the details follow similarly from some existing results+ See, for example, Fan and Gijbels ~1996!+ In view of the definition of wt~x! and the second equation of ~A+13!, to prove ~A+14!, it suffices to show that as T r ` EH 1Th (t51 T kS x 2 uh D~s2~x! 2 s1~x!~x 2 Xt !!@ f ~x! 2 f ~Xt !#J2 5 T ~Th!2 Ek 2S x 2 uh D~s2~x! 2 s1~x!~x 2 u!!2 @ f ~x! 2 f ~u!# 2 f ~u! du 5 Th ~Th!2 Ek 2~v!~s2~x! 2 s1~x!~vh!!2 @ f ~x! 2 f ~x 2 vh!# 2 f ~x 2 vh! dv 5 C h 2 Th ~1 1 o~1!! using a Taylor expansion to f ~x! 2 f ~x 2 vh!+ This finishes the proof of ~A+14!+ n A.3. Proof of Theorem 2.1. Proof of Theorem 2.1(i). To prove Theorem 2+1~i!, in view of Remark A+2 and Lemma A+3, it suffices to show that N0T ~h! 2 m0 Mhs0 r N~0,1! as T r `+ To apply Lemma A+1, let jt 5 Xt and f~js,jt ! 5 fst defined previously+ Let MT and NT be defined as in Lemma A+1+ We now verify only the following condition listed in Lemma A+1: max$MT ,NT % sh 2 r 0 as T r ` (A.15) for MT1, MT 21, MT 3, MT51, MT52, and MT6, where sh2 5 hs02+ The others follow similarly+ For the MT part, one justifies only T 2MT110~11d! sh 2 r 0 as T r `+ The others follow similarly+ Let cst 5 ~10Th!*k~~x 2 Xs!0h!k~~x 2 Xt !0h!p~x! dx+ We now have cik cjk 5 ~Th!22EEkS x 2 Xih DkS x 2 Xkh DkS y 2 Xjh DkS y 2 Xkh D f ~x! f ~ y! dxdy 5 T 22EEk~u!kSu 1 Xi 2 Xkh Dk~v!kSv1 Xj 2 Xkh D f ~Xi 1 uh! f ~Xj 1 vh! dudv 5 T 22 f ~Xi ! f ~Xj !LS Xi 2 Xkh DLS Xj 2 Xkh D~1 1 o~1!!, where L~{! is as defined previously+ 868 JITI GAO AND MAXWELL KING For any given 1 , z , 2 and T sufficiently large, we obtain MT11 5 E6cik cjk 6z 5 T 22zEEE6 f ~u! f ~v!6z*LS u 2 wh D*z*LS v2 wh D*z f ~u, v,w! dudvdw 5 T 22zh 2EEE6 f ~z 1 xh! f ~z 1 yh!6z2 6L~x!L~ y!6z f ~z 1 xh, z 1 yh, z! dxdydz 5 cpT 22zh 2, (A.16) using Assumption A+1~ii!, where f ~x, y, z! denotes the joint density of ~Xi , Xj , Xk! and Cp is a constant+ Thus, as T r ` T 2MT1110~11d! sh 2 5 C T 2~T 22zh 2 !10z h 5 h ~22z!0z r 0+ (A.17) Hence, ~A+17! shows that ~A+15! holds for the first part of MT1+ The proof for the second part of MT1 follows in a similar way+ Similarly, we have that as T r ` MT 3 5 E6cik cjk 62 5 ~Th!24h 4EFf 2~Xi ! f 2~Xj !L2S Xi 2 Xkh DL2S Xj 2 Xkh DG 5 T 24EEE f 2~x! f 2~ y!L2S x 2 zh DL2S y 2 zh D f ~x, y, z! dxdydz 5 T 24h 2EEE f 2~uh 1 w! f 2~vh 1 w!L2~u!L2~v! dudvdw 5 CT 24h 2, using Assumption A+1~ii!+ This implies that as T r ` T 302MT 3102 sh 2 5 C T 302T 22h h 5 CT 2102 r 0+ (A.18) Thus, ~A+18! now shows that ~A+15! holds for MT 3+ It follows from the structure of $cij % that ~A+15! holds automatically for MT51, MT52, and MT6, because E @fst # 5 0 for s Þ t+ We now prove that ~A+15! holds for MT 21+ For some 0 , d , 1 and 1 # i , j , k # T, let MT 21 5 E @6cikcjk62~11d! # + Similar to ~A+16! and ~A+17!, we obtain that as T r ` T 302 MT 21102~11d! sh 2 r 0 using the fact that limTr`Th 5 `+ This completes the proof of ~A+15! for MT 21, and thus ~A+15! holds for the first part of $fst % + Similarly, one can show that ~A+15! holds for the other parts of $fst % + Thus, we have shown that under H0 ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 869 N0T 2 m0 sh r N~0,1! as T r `+ The proof of Theorem 2+1~i! is therefore finished+ n Proof of Theorem 2.1(ii). Note that as T r ` ZLT ~ Zh! 5 ZNT ~ Zh! 2 m0 M Zhs0 5 ZNT ~ Zh! ZNT ~h! @ ZNT ~h! 2 m0 # 1 F ZNT ~ Zh!ZNT ~h! 2 m0G FM ZhMh 2 1Gsh 1 sh 5 ZNT ~h! 2 m0 sh ~1 1 op~1!! using the continuity of ZNT ~h! in h+ This completes the proof of Theorem 2+1~ii!+ n Proof of Theorem 2.2. The proof follows from Theorem 2+1 and the following stan- dard result: 1 T (t51 T Zf i~Xt ! 5 E @ f i~Xt !# 1 OpS 1MThD1 O~h 2 ! for i 5 1,3+ n APPENDIX B This Appendix lists the necessary assumptions for the establishment and the proof of the main results given in Section 3+ B.1. Assumptions. Assumption B.1. The parameter set Q is an open subset of Rq for some q $ 1+ The parametric family F 5 $ f ~{,u! : u [ Q% satisfies the following conditions+ ~i! Assumption A+2~i! holds+ ~ii! For each u [ Q, f ~x,u! is continuous with respect to x [ D+ ~iii! Assume that there is a finite CI . 0 such that for every « . 0 inf u,u ' [ Q : 7u 2 u ' 7 $ « @ f ~X1,u! 2 f ~X1,u ' !# 2 $ CI «2 holds with probability one ~almost surely!+ Assumption B.2. ~i! Let H0 be true+ Then u0 [ Q and lim Tr` P~MT 7 Du 2 u07 . CL ! , « for any « . 0 and all sufficiently large CL+ 870 JITI GAO AND MAXWELL KING ~ii! Let H0 be false+ Then there is a u* [ Q such that lim Tr` P~MT 7 Du 2 u* 7 . CL ! , « for any « . 0 and all sufficiently large CL+ Assumption B.3. ~i! Assume that the set HT has the structure of ~3+2! with cminT 2g 5 hmin , hmax 5 cmax~log log T !21 , where g, cmin, and cmax are some constants satisfying 0 , g , 1 and 0 , cmin, cmax , `+ ~ii! Assume that DT ~x! is continuous in x [ D and satisfies *2` ` DT ~x! dx 5 0 for all T $ 1+ Remark B.1. Assumptions B+1~i! and B+1~ii! are quite standard in this kind of prob- lem+ See Assumptions 1~i! and ~ii! of Horowitz and Spokoiny ~2001!+Assumption B+1~iii! is required to ensure that the marginal density function is identifiable+ A similar condi- tion is used in Assumption 1~iii! of Horowitz and Spokoiny ~2001!+ It can be shown that Assumption B+1~iii! holds when f ~x,u! belongs to classes of simple linear and certain nonlinear functions in u+ The identifiability assumption is imposed to exclude the case where f ~x,u! is flat as a function of u over certain range of u and some value of x, because such a function may be neither identifiable nor a probability density+ Assump- tion B+2 is needed to ensure that the true version of u under H0 or H1 can be estimated by a MT -consistent estimator+ Assumption B+3~i! imposes some conditions on both hmin and hmax+ The theoretical condition on hmin is quite general+ In practice, we would suggest using g 5 15_ to include the estimation-based optimal bandwidth hoptimal 5 Cn2@10~2s11!# , because the estimation-based optimal value may also be optimal for test- ing purposes in some cases+ The restriction on hmax is required only for the proof of Theorem 3+3+ It should be noted that hmax is not necessarily the optimal bandwidth such that the power of the resulting test is maximized+ As explained at the beginning of Sec- tion 2, both the existence and reasonableness of Assumption B+3~ii! can be justified+ Unlike the regression setting discussed in Horowitz and Spokoiny ~2001!, we need to assume * xmin xmax DT ~x! dx 5 0 to ensure that the alternative is also a probability density+ As the main results in Section 2 are only concerned with the null hypothesis, we do not need to assume such a rigorous condition for the main results+ This paper considers using only a set of discrete bandwidths for constructing the adap- tive test+ It is believed that some corresponding results of Theorems 3+1–3+4 can be estab- lished for the case where HT is an interval of continuous bandwidth values+ As HT is always chosen as a set of discrete bandwidths in practice, we therefore think that such an extension from a set of discrete bandwidths to an interval of continuous bandwidth values may just be for theoretical and technical consideration+As such an extension also involves much more tedious and technical details, we do not discuss this issue in detail in this paper+ B.2. Technical Lemmas. Before stating the necessary lemmas for the proof of the results given in Section 3, we introduce the following notation+ ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 871 LEMMA B+1+ Suppose that the conditions of Theorem 2.1 hold. (i) For every d . 0 max h[HT h21 sup 7u2u07#d QT ~u! # CTd2 in probability, where C . 0 is a constant. (ii) For each u [ Q and sufficiently large T QT ~u! $ Ch{l~u!tl~u! in probability. Proof. ~i! It follows from the definition of QT ~u! that QT ~u! # 7A7`7l~u!72+ (B.1) To prove Lemma B+1~i!, one first needs to show that 7A7` # Ch (B.2) in probability for some constant C . 0+ Using the conditions of Lemma B+1, we now have 7A7` # max 1#t#T ( s51 T ast 5 C~1 1 op~1!! max 1#t#T EkS x 2 Xth D @s2~x! 2 s1~x!~x 2 Xt !# dx 5 C~1 1 op~1!!h max 1#t#T Ek~u!@s2~Xt 1 uh! 2 s1~Xt 1 uh!uh# du 5 C~1 1 op~1!!hFs2~Xt !Ek~u! du 2 s1~Xt !hEuk~u! duG # Ch in probability+ In view of ~B+2!, to prove Lemma B+1~i!, it suffices to show that sup 7u2u07#d 7l~u!72 # CTd2 (B.3) in probability+ A Taylor series expansion to f ~Xt ,u! 2 f ~Xt ,u0! and an application of Assumption B+1~i! imply ~B+3!+ This finishes the proof of Lemma B+1~i!+ ~ii! Let lmin~A! and lmax~A! denote the smallest and largest eigenvalues of A, respec- tively+ In view of lmin~A!{7l~u!72 # QT ~u! # lmax~A!{7l~u!72, (B.4) to prove Lemma B+1~ii!, it suffices to show that for n large enough lmin~A! $ Ch~1 1 op~1!! in probability (B.5) for some C . 0+ Similar to the proof of Lemma A+2 of Gao, Tong, and Wolff ~2002!, one can easily finish the proof of ~B+5!+ n 872 JITI GAO AND MAXWELL KING Without loss of generality, we consider the case of q 5 1 in the following lemmas and their proofs+ Define ci ~Xt ,u! 5 f ~i ! ~Xt ,u! 5 d i f ~Xt ,u! du i for i 5 1,2,3+ LEMMA B+2+ Under the conditions of Theorem 3.1, we have for any given u [ Q and i 5 1,2 JT2102 max h[HT h2102*( s51 T ( t51 T bst ci ~Xt ,u!* 5 Op~1!+ (B.6) Proof. It suffices to show that for any large constant C0 . 0 PFJT2102 maxh[HT h2102*(s51 T ( t51 T bst ci ~Xt ,u!* . C0G # ( h[HT PF*( s51 T ( t51 T bst ci ~Xt ,u!* . C0 JT102 h 102G # ( h[HT 1 C02 JT h EF( s51 T ( t51 T bst ci ~Xt ,u!G2 # ( h[HT 1 C02 JT h H(s51 T ( t51 T E @bst ci ~Xt ,u!# 2 1 LiT ~u!J , (B.7) where LiT ~u! 5 EF( s51 T ( t51 T bst ci ~Xt ,u!G2 2 ( s51 T ( t51 T E @bst ci ~Xt ,u!# 2+ Similar to the proof of ~A+1!, one can show that as T r ` ( s51 T ( t51 T E @bst ci ~Xt ,u!# 2 5 C~u!h~1 1 o~1!! (B.8) for some function C~u!+ Using Lemmas C+1 and C+2 in Appendix C and the fact that E @et~x!# 5 0 for x [ D, one can show that as T r ` LiT ~u! 5 o~h! for i 5 1,2,3+ (B.9) Thus, equations ~B+7!–~B+9! complete the proof+ n LEMMA B+3+ Under the conditions of Theorem 3.1, we have as T r ` JT2102 max h[HT h2102 max 1#s#T*(t51 T bst* 5 Op~1!+ (B.10) ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 873 Proof. Similar to ~B+7!, we have for large constant C0 . 0 PFJT2102 maxh[HT h2102 max1#s#T*(t51 T bst* . C0G # ( h[HT ( s51 T PFJT2102 h2102*( t51 T bst* . C0G # 1C02 JT (h[HT h21 (s51 T EF( t51 T bstG2 5 1 C02 JT ( h[HT h21 H( s51 T ( t51 T E @bst2 # 1 ( s51 T ( t1Þt2 E @bst1 bst2 #J + (B.11) Similar to ~B+8!, we can have as T r ` ( s51 T ( t51 T E @bst2 # 5 Ch~1 1 o~1!!+ (B.12) Analogous to ~B+9!, one can show that as T r ` ( s51 T ( t1Þt2 E @bst1 bst2 jt1 jt2 # 5 o~h!+ (B.13) Thus, equations ~B+11!–~B+13! complete the proof of ~B+10!+ n LEMMA B+4+ Under the conditions of Theorem 3.1, we have for each u . 0, max h[HT sup 6u2u0 6#T 2102u h2102*( s51 T ( t51 T bst lt ~u!* 5 Op~JT102 T 2102 ! (B.14) under H0. Proof. We now prove ~B+14!+ Using a Taylor series expansion to f ~Xt ,u! 2 f ~Xt ,u0! and Assumption B+1, we have for u ' between u and u0 *( s51 T ( t51 T bst lt ~u!* 5 *( s51 T ( t51 T bst @ f ~Xt ,u! 2 f ~Xt ,u0 !#* # *( s51 T ( t51 T bst c1~Xt ,u0 !*6u 2 u0 61 12 *(s51 T ( t51 T bst c2~Xt ,u0 !* 3 6u 2 u0 62 1 1 6 *(s51 T ( t51 T bst c3~Xt ,u ' !*6u 2 u0 63 # *( s51 T ( t51 T bst c1~Xt ,u0 !*6u 2 u0 61 12 T 6u 2 u0 62*(s51 T bst c2~Xt ,u0 !* 1 1 6 T 6u 2 u0 63 max 1#t#T*(s51 T bst*{ max1#t#T6c3~Xt ,u ' !6+ (B.15) 874 JITI GAO AND MAXWELL KING Hence, ~B+4!, ~B+10!, ~B+15!, and Assumption B+1~i! imply max h[HT sup 6u2u0 6#T 2102u h2102*( s51 T ( t51 T bst lt ~u!* # Op~JT102 T 2102 !+ (B.16) The proof of ~B+14! follows from ~B+15! and ~B+16!+ n LEMMA B+5+ Suppose that the conditions of Theorem 3.1 hold. Then for every u . 0, some h [ HT, and as T r ` sup 6u2u* 6 # T 2102u*(s51 T ( t51 T bst l~Xt ,u!*5 op~QT ~u* !! (B.17) under H1. Proof. In view of the definition of Qn~u!, to prove ~B+17!, it suffices to show that as T r ` sup 6u2u* 6 # T 2102u*(s51 T ( t51 T bst l~Xt ,u!*5 op~qT !, where qT 5 E @QT ~u*!# + Note that *( s51 T ( t51 T bst l~Xt ,u!* # *( s51 T ( t51 T bst l~Xt ,u* !* 1 *( s51 T ( t51 T bst c1~Xt ,u* !*6u 2 u* 6 1 1 2 T 6u 2 u* 62*( s51 T bst c2~Xt ,u* !* 1 1 6 T 6u 2 u* 62 max 1#t#T*(s51 T bst*{ max1#t#T6c3~Xt ,u ' !6, (B.18) where u ' lies between u and u*+ In view of ~B+6!, ~B+10!, ~B+18!, and Assumptions B+1~i! and B+2~ii!, to prove ~B+17!, it suffices to show that for any d . 0, PF*( s51 T ( t51 T bst l~Xt ,u* !* . dTqTGr 0 (B.19) as T r `+ Similar to ~B+8! and ~B+9!, one can show that as T r ` EF( s51 T ( t51 T bst l~Xt ,u* !G 2 5 Ch~1 1 o~1!!+ (B.20) ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 875 Thus, equations ~B+19! and ~B+20! imply that as T r ` PF*( s51 T ( t51 T bst l~Xt ,u* !* . dqTG # 1d2qT2 EF(s51 T ( t51 T bst l~Xt ,u* !G2 5 ChqT2 r 0 (B.21) using qT 5 CTh~1 1 o~1!! given in the proof of Lemma B+1~ii!, where C is a constant independent of T+ Lemma B+5 therefore follows from ~B+21!+ n Recall the notation introduced in ~A+9!+ We assume without loss of generality that k ~4!~0! 5 1 in Lemma A+2+ Define L0~h! 5 N0T ~h! 2 m0 M2h and LT ~h! 5 NT ~h! 2 m0 M2h + (B.22) LEMMA B+6+ Suppose that the conditions of Theorem 3.1 hold. Then as T r ` ZLT ~h! 5 LT ~h! 1 op~1! (B.23) uniformly over h [ HT. Proof. The proof of ~B+23! follows from ~2+7! and ~2+8! immediately+ n LEMMA B+7+ Suppose that the conditions of Theorem 3.1 hold. Then maxh[HT L0~h! and maxh[HT LT ~h! have identical asymptotic distributions under H0. Proof. Note that QT ~u0! 5 0 under H0 and that Lemmas A+3 and B+1–B+5 imply as T r ` max h[HT PT ~u0 ! M2h 5 op~1!, maxh[HT P1T 1 P2T M2h 5 op~1!, maxh[HT RT ~u0 ! M2h 5 op~1!+ (B.24) Therefore, equations ~B+21!, ~B+22!, and ~B+24! complete the proof of Lemma B+7+ n LEMMA B+8+ Suppose that the conditions of Theorem 3.1 hold. Then for any x $ 0, h [ HT, and all sufficiently large T P~L0~h! . x! # expS2 x 24 D+ Proof. It follows from the beginning of the proof of Theorem 2+1~i! that for any small d . 0 there exists a large integer T0 $ 1 such that for T $ T0 6P~L0~h! # x! 2 F~x!6 , d, where F~x! 5 ~1YM2p!*2`x e2~u 202! du+ 876 JITI GAO AND MAXWELL KING This implies for any T $ T0 and x $ 0 P~L0~h! . x! # 1 2 F~x! 1 d 5 1 M2p Ex ` e2~u 202! du 1 d 5 1 M2p Ex ` e2~u 204!e2~u 204! du 1 d # e2~x 204! 1 M2p Ex ` e2~u 204! du 1 d # e2~x 204! 1 M2p E0 ` e2~u 204! du 1 d 5 e2~x 204! M2 M2p E0 ` e2~v 202! dv1 d 5 M2 2 e2~x 204! 1 d using ~1YM2p!*0` e2~v 202! dv 5 12_ + The proof follows by letting 0 , d # ~1 2 M202!e2~x 204! for any x $ 0+ n For 0 , a , 1, define Dla to be the 1 2 a quantile of maxh[HT L0~h!+ LEMMA B+9+ Suppose that the conditions of Theorem 3.1 hold. Then for large enough T Dla # 2M log~JT ! 2 log~a!+ Proof. The proof is trivial+ LEMMA B+10+ Suppose that the conditions of Theorem 3.1 hold. Suppose that lim Tr` PSQT ~u* !M2h $ 2 Dla*D5 1 (B.25) for some h [ HT, where Dla* 5 maxS Dla ,M2 log~JT ! 1M2 log~JT !D+ Then lim Tr` P~L* . la! 5 1+ Proof. To prove Lemma B+10, in view of Lemmas B+6 and B+7, it suffices to show that lim Tr` PSmaxh[HT LT ~h! . DlaD5 1, which holds if lim Tr` P~LT ~h! . Dla! 5 1 ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 877 for some h [ HT + For any h [ HT , using ~B+21! and then ~B+17! we have LT ~h! 5 L0~h! 1 QT ~u* ! 1 RT ~u* ! 1 P1T 1 P2T M2h 5 L0~h! 1 QT ~u* !~1 1 op~1!! M2h + (B.26) On the other hand, condition ~B+25! implies that as T r ` PSQT ~u* !M2h , 2 Dla*Dr 0+ (B.27) Observe that P~LT ~h! . Dla! 5 PSLT ~h! . Dla , QT ~u* !M2h $ 2 Dla*D1 PSLT ~h! . Dla , QT ~u * ! M2h , 2 Dla *D [ I1T 1 I2T + Thus, it follows from ~B+26! that as T r ` I1T 5 P 1L0~h! 1 QT ~u* ! 1 PT ~u* ! 1 RT ~u* ! 1 (i51 2 PiT M2h . Dla* QT ~u* ! M2h $ 2 Dla *2 3 PSQT ~u* !M2h $ 2 Dla*D $ PSL0~h! . Dla 2 2 Dla* * QT ~u* !M2h $ 2 Dla*DPSQT ~u * ! 2h d02 $ 2 Dla*Dr 1 because L0~h! is asymptotically normal and therefore bounded in probability and Dla 2 2 Dla* r 2` as T r `+ Because of ~B+27!, as T r ` I2T # PSQT ~u* !M2h , 2 Dla*Dr 0+ This finishes the proof+ n B.3. Proofs of Theorems 3.1–3.4. Proof of Theorem 3.1. The proof follows from Lemmas B+6 and B+7+ Proof of Theorem 3.2. This proof is similar to that of Theorem 3+3, which follows, using Lemma B+1~ii!+ Alternatively, one can follow the corresponding proof of Theo- rem 2 of Horowitz and Spokoiny ~2001! by using Lemma B+1~ii! and the condition that lim Tr` P~r~ f,F ! $ Cr! 5 1+ to verify ~B+25!+ n 878 JITI GAO AND MAXWELL KING Proof of Theorem 3.3. Condition ~3+5! ensures that the rate of convergence of fT to the parametric model F~u1! is the same as the rate of convergence of CT to zero+ In particular, when ~3+5! holds, lim Tr` PS inf u[Q ~7 NfT 2 F~u!72 ! $ TdCT2D5 1+ (B.28) In view of Lemma B+10, to complete the proof of Theorem 3+3, it suffices to verify ~B+25!+ This verification follows from Lemma B+1~ii! and ~B+28!+ n Proof of Theorem 3.4. For the proof of Theorem 3+4, one needs to use the condi- tions of Theorem 3+4 to finish the proof+ In our proof, we mainly use Lemma B+1~ii! and the condition of Theorem 3+4 that lim Tr` P~r~ f,F ! $ Cm~T 21M log log T !2s0~4s11! ! 5 1 to verify ~B+25!+ n APPENDIX C The following two technical lemmas have already been used in the proofs of Lemma A+1 and Theorem 2+1+ The two lemmas are of general interest in themselves and can be used for other nonparametric estimation and testing problems associated with the a-mixing condition+ LEMMA C+1+ Suppose that Mmn are the s-fields generated by a stationary a-mixing process ji with the mixing coefficient a~i ! . For some positive integers m let hi [ Msiti where s1 , t1 , s2 , t2 , {{{ , tm and suppose ti 2 si . t for all i. Assume further that 7hi7pi pi 5 E6hi 6 pi , ` for some pi . 1 for which Q 5 ( i51 l 1 pi , 1+ Then *EF)i51 l hiG2 ) i51 l E @hi #* # 10~l 2 1!a~t!~12Q! )i51 l 7hi7pi + Proof. See Roussas and Ioannides ~1987!+ LEMMA C+2+ (i) Let c~{,{,{! be a symmetric Borel function defined on Rr 3 Rr 3 Rr. Let the process ji be defined as in Lemma A.1. Assume that for any fixed x, y [ Rr, E @c~j1, x, y!# 5 0. Then EH ( 1#i,j,k#T c~ji ,jj ,jk !J2 # CT 3M 10~11d!, ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 879 where 0 , d , 1 is a small constant, C . 0 is a constant independent of T and the function c, M 5 max$M1,M2,M3%, and M1 5 max 1,i,j#T maxHE6c~j1,ji ,jj !62~11d!,E6c~j1,ji ,jj !62~11d! dP~j1! dP~ji ,jj !J , M2 5 max 1,i,j#T maxHE6c~j1,ji ,jj !62~11d! dP~jj ! dP~j1,ji !J , M3 5 max 1,i,j#T maxHE6c~j1,ji ,jj !62~11d! dP~j1! dP~ji ! dP~jj !J + (C.1) (ii) Let f~{,{! be a symmetric Borel function defined on Rr 3 Rr. Let the process ji be defined as in Lemma A.1. Assume that for any fixed x [ Rr, E @f~j1, x!# 5 0. Then EH ( 1#i,j#T f~ji ,jj !J2 # CT 2M410~11d! , where d . 0 is a constant, C . 0 is a constant independent of T and the function f, and M4 5 max 1,i,j#T maxHE6f~j1,ji !62~11d!,E6f~j1,ji !62~11d! dP~j1! dP~ji !J + (C.2) Proof. As the proof of ~ii! is similar to that of ~i!, one proves only ~i!+ Let i1, + + + , i6 be distinct integers and 1 # ij # T, let 1 # k1 , {{{ , k6 # T be the permutation of i1, + + + , i6 in ascending order, and let dc be the cth largest difference among kj11 2 kj , j 5 1, + + + ,5+ Let H~k1, + + + , k6 ! 5 c~ji1 ,ji2 ,ji3 !c~ji4 ,ji5 ,ji6 !+ By Lemma C+1 ~with h1 5 c~ji1 ,ji2 ,ji3 !, h2 5 c~ji4 ,ji5 ,ji6 !, l 5 2, pi 5 2~1 1 d! and Q 5 10~1 1 d!!, 6E @H~k1, + + + , k6 !#6 # H10M 10~11d!ad0~11d!~k6 2 k5! if k6 2 k5 5 d110M 10~11d!ad0~11d!~k2 2 k1! if k2 2 k1 5 d1+ Thus, ( 1#k1,{{{,k6#T k22k15d1 6E @H~k1, + + + , k6 !#6 # ( k151 T25 ( k25k11maxj$3$kj2kj21% ( k35k211 T23 {{{ ( k65k511 T $10M10~11d!ad0~11d!~k2 2 k1!% # 10M10~11d! ( k151 T25 ( k25k111 T24 ~k2 2 k1!2ad0~11d!~k2 2 k1! # 10TM10~11d! ( k51 T k4ad0~11d!~k! # CTM10~11d!+ (C.3) 880 JITI GAO AND MAXWELL KING Similarly, ( 1#k1,{{{,k6#T k22k15d1 6E @H~k1, + + + ,k6!#6 # CTM10~11d!+ (C.4) Analogously, it can be shown in a similar way that ( 1#k1,{{{,k6#T k62k55d2 or k22k15d2 6E @H~k1, + + + ,k6!#6 # CT 2M10~11d!, (C.5) ( 1#k1,{{{,k6#T k62k55d3 or k22k15d3 6E @H~k1, + + + ,k6!#6 # CTM10~11d!+ (C.6) On the other hand, if $k6 2 k5, k2 2 k1% 5 $d4,d5% , by using Lemma C+1 three times we have the inequality 6E @H~k1, + + + , k6 !#6 # 10M 10~11d! ( i51 3 ad0~11d!~di !+ Hence, ( 1#k1,{{{,k6#T $k62k5 , k22k1%5$d4 ,d5 % 6E @H~k1, + + + , k6 !#6 # ( 1#k1,{{{,k6#T max $k62k5 , k22k1% # min 2#j#4 $kj112kj % $10M 10~11d! @ad0~11d!~k3 2 k2 ! 1 ad0~11d!~k4 2 k3 ! 1 ad0~11d!~k5 2 k4 !#% # 30M 10~11d! ( 1#k1,{{{,k6#T max$k62k5 , k22k1%#d3 a10~11d!~d3 ! # 30CT 3M 10~11d!+ (C.7) It follows from ~C+3!–~C+7! that ( 1#i, j, k, r, s, t#T i, j, k, r, s, t different 6E @c~ji ,jj ,jk !c~jr ,js ,jt !#6 # CT 3M 10~11d!+ (C.8) Similar to ~C+8!, one can show that ( 1#i, j, k, r, s, t#T i, j, k, s, t different 6E @c~ji ,jj ,jk !c~ji ,js ,jt !#6 # CT 3M 10~11d!, (C.9) ADAPTIVE TESTING IN CONTINUOUS-TIME DIFFUSION MODELS 881 ( 1#i, j, k, l#T i, j, k, l different 6E @c~ji ,jj ,jk !c~ji ,jj ,jl !#6 # CT 3M 10~11d!+ (C.10) Finally, it is easy to see that ( 1#i,j,k#T E @c~ji ,jj ,jk !2 # # T 3 max 1,i,j E @c~j1,ji ,jj !2 # + (C.11) The conclusion of Lemma C+2~i! follows immediately from ~C+8!–~C+11!+ n 882 JITI GAO AND MAXWELL KING 