ABSTRACT: 
Standard methods for describing the intensity distribution of mechanical and acoustic wave fields in the high frequency asymptotic limit are often based on flow transport equations. Common techniques are statistical energy analysis, employed mostly in the context of vibro-acoustics, and ray tracing, a popular tool in architectural acoustics. Dynamical energy analysis makes it possible to interpolate between standard statistical energy analysis and full ray tracing, containing both of these methods as limiting cases. In this work a version of dynamical energy analysis based on a Chebyshev basis expansion of the Perron-Frobenius operator governing the ray dynamics is introduced. It is shown that the technique can efficiently deal with multi-component systems overcoming typical geometrical limitations present in statistical energy analysis. Results are compared with state-of-the-art hp-adaptive discontinuous Galerkin finite element simulations. 
 
PREDICTION: 
The general problem of determining the response of a system to external forcing with angular fre- quency  at a source point r0  0 can then be reduced to solving (k2i  H)G(r, r0;) = (r  r0), i = 1, ..., N, (1) 2 with H = , G represents the Green function, r  i is the solution point and  is the Dirac delta distribution. The Chebyshev basis approximation Bmn of B may be written: Bmn = P  P Wm(X s)T m(X s)B(Xs, Y s;)T m( (Y s))w(Y s)T n(Y s)dY sdXs =  P Wm( (Y s))T m( (Y s))w(Y s)T n(Y s)dY s, (11) where P = [0, L) (|p|, |p|) is the phase space on the boundary at fixed “energy” H(X) = |p|2 and Wm(X s) = 4m1m2 2 1 1 ((2s/L) 1)2 1 1 (ps/|p|)2 , (12) is the weight function for the inner product in which the Chebyshev basis is orthonormal. The Chebyshev basis approximation Bmn of B may be written: Bmn = P  P Wm(X s)T m(X s)B(Xs, Y s;)T m(X s)w(Y s)T n(Y s)dY s, (11) where P = [0, L) (|p|, |p|) is the phase space on the boundary at fixed “energy” H 
 
FULL TEXT: 
  the-art hp-adaptive discontinuous Galerkin finite element simulations. 1 INTRODUCTION Predicting the wave energy distribution of the vibro-acoustic response of a complex mechanical system to periodic excitation is a challenging task, especially in the mid-to-high frequency regime. Standard numerical tools such as finite element methods become inefficient, and ray or thermodynamic approaches are often employed to model the wave energy flow through the structure. Popular methods are Statistical Energy Analysis (SEA) [1, 2, 3], in which the mean energy flow between subsystems is assumed to be proportional to the energy gradient, and the ray tracing technique, in which the wave intensity distribution is determined by summing over contributions of a potentially large number of ray paths [6, 4, 5]. Ray tracing and SEA both predict mean values of the energy distribution and omit information about wave effects such as interference or diffraction. Both methods are therefore expected to hold in the high frequency (or small wavelength) limit. SEA is in fact a low resolution ray tracing method [8, 7] leading to small numerical models compared to ray tracing. This efficiency saving comes at a price, however: SEA has no spatial resolution of the energy distribution within subsystems and becomes unreliable whenever long range correlations in the ray dynamics are present. The recently developed Dynamical Energy Analysis (DEA) [7] provides a tool which interpolates between SEA and a full ray tracing analysis and can overcome some of the problems mentioned above at a relatively small computational overhead. DEA thus enhances the range of applicability of standard SEA and gives bounds on the range of applicability of SEA. ∗david.chappell@nottingham.ac.uk †stefano.giani@nottingham.ac.uk ‡gregor.tanner@nottingham.ac.uk 1 Related methods have been discussed previously in the context of wave chaos [9] and structural dynamics [10]. In particular Langley’s Wave Intensity Analysis (WIA) [11, 12] and Le Bot’s thermodynamical high frequency boundary element method [13, 14] include details of the underlying ray dynamics. The approach employed here differs from these methods by considering multiple reflections in terms of linear operators. Representing these operators in terms of basis function expansions then leads to SEA-type equations. In this work a reformulation of DEA is presented, which is based on a Chebyshev basis function representation; this leads to considerable improvements compared to previous attempts based on an ex- pansion in terms of a Fourier basis [7]. Both Chebyshev and Fourier basis expansions of smooth functions share similar exponential convergence properties [15]. The main advantages of using a representation in terms of Chebyshev polynomials include that the requirement for periodic boundary conditions can be dropped, allowing for much more freedom in the choice of approximation regions. In addition, a Chebyshev expansion gives rise to more efficient quadrature rules for numerically calculating the arising integrals when constructing the linear operators considered in DEA. Using a Chebyshev basis leads to a natural choice of quadrature, namely Gauss-Chebyshev, which is optimal for polynomial-type integrands and naturally incorporates the orthogonality weighting term in the Chebyshev basis function represen- tation. In order to take full advantage of this feature it is necessary to formulate the problem in terms of the final position and momentum of a given ray, and map back to its initial point. This is in contrast to previous work on DEA by Ref. [7], where the rays were defined by their endpoints. The strengths of the newly reformulated DEA are evident in the applications considered, where due to improved efficiency it has been possible to model multi-component systems with variable wave-numbers for the first time. The method is verified numerically by comparing DEA results with state-of-the-art finite element software for a range of parameter values. The remainder of the paper is structured as follows. In Section 2, the ray tracing approximation is discussed and related to the Green function using short wavelength asymptotics. In Section 3, the concept of phase-space operators is introduced and their representation in terms of boundary basis functions is discussed. In Section 4 the implementation of DEA is detailed along with its links with SEA. The finite element formulation used for verification of the results is also briefly discussed. In Section 5, a variety of coupled two-cavity configurations are discussed and the results compared against finite element computations. Finally larger multi-cavity configurations are considered. 2 WAVE ENERGY FLOW IN TERMS OF THE GREEN FUNCTION It is assumed that the system as a whole is characterized by a linear wave equation describing the overall wave dynamics including damping and radiation in a finite domain Ω ⊂ Rd, d = 2 or 3. In this work only stationary problems with continuous, monochromatic energy sources are considered. We split the system into NΩ subsystems and consider the scalar wave equation for acoustic pressure waves in each homogeneous sub-domain Ωi, with local wave velocity ci, i = 1, ..., NΩ and Ω = ⋃NΩ i=1Ωi. Extensions to more complicated systems with different wave operators in different parts of the system can be treated with the same techniques as long as the underlying wave equations are linear, see the discussion in Ref. [7]. The general problem of determining the response of a system to external forcing with angular fre- quency ω at a source point r0 ∈ Ω0 can then be reduced to solving (k2i − Hˆ)G(r, r0;ω) = −δ(r − r0), i = 1, ..., NΩ, (1) 2 with Hˆ = −∆, G represents the Green function, r ∈ Ωi is the solution point and δ is the Dirac delta distribution. Furthermore, ki = ω/ci+ iµi/2 is a complex valued wavenumber, where the imaginary part represents a subsystem dependent damping coefficient µi. Throughout this work we take i = √−1 unless used as a subscript, in which case it is an index over the number of subsystems. The wave energy density induced by the source is then given as ε(r, r0;ω) = |G(r, r0;ω)|2 ̺ic2i , (2) for r ∈ Ωi where ̺i is the density of the medium in Ωi. The linear wave operator Hˆ can naturally be associated with the underlying ray dynamics via the Eikonal approximation; for more detailed derivation, see Ref. [7, 16, 17]. Using small wavelength asymptotics, the Green function in equation (1) may be written as a sum over all classical rays from r0 to r for fixed kinetic energy of the hypothetical ray particle. One obtains [18, 17] G(r, r0;ω) = π (2πi)(d+1)/2 ∑ j:r0→r Aje i(kiRj−iνjpi/2), (3) where Rj is the length of the ray trajectory between r0 and r including possible reflections on boundaries. The amplitudes Aj may be written as a product of three terms as in Ref. [7] due to damping, mode conversion and reflection/transmission coefficients, and geometrical factors. The phase index νj contains contributions from the reflection/transmission coefficients at interfaces between subsystems and from caustics along the ray path. Analogous representations to (3) have been considered in detail in quantum mechanics [18] and are also valid for general wave equations in elasticity, see Ref. [9] for an overview. In the latter case G becomes matrix valued. Note that the summation in equation (3) is typically over infinitely many terms, where the number of contributing rays increases (in general) exponentially with the length of the trajectories included. This gives rise to convergence issues, especially in the case of low or no damping [9]. The wave energy density (2) can now be expressed as a double sum over classical trajectories and hence ε(r, r0;ω) = C ∑ j, j′:r0→r AjAj′e iki[Rj−Rj′ ]−i[νj−νj′ ]pi/2 = C[ρ(r, r0;ω) + off-diagonal terms], (4) with C = π2/(̺ic 2 i (2π) (d+1)). The dominant contributions to the double sum arise from terms in which the phases cancel exactly; one thus splits the calculation into a diagonal part ρ(r, r0;ω) = ∑ j:r0→r |Aj|2 (5) where j = j′, and an off-diagonal part. The diagonal contribution gives a smooth background signal and the off-diagonal terms give rise to fluctuations on the scale of the wavelength. The phases related to different trajectories are (largely) uncorrelated and the resulting net contributions to the off-diagonal part are in general small compared to the smooth part, especially when averaging over frequency intervals of a few wavenumbers. It has been shown in Ref. [7] that calculating the smooth diagonal part (5) is equivalent to a ray tracing treatment. That is, the smooth part of the energy density can be described in terms of the flow of fictitious non-interacting particles emerging from the source point r0 uniformly in all directions and propagating along ray trajectories. This makes it possible to relate wave energy transport with classical flow equations and thus thermodynamical concepts, which are at the heart of an SEA treatment. In DEA the classical flow is expressed in terms of linear phase space operators as detailed in the next section. 3 3 LINEAR PHASE SPACE OPERATORS AND DEA 3.1 Phase space operators and boundary maps A brief outline of the derivation of the DEA flow equations is now given, for details see Ref. [7]. We adopt a purely kinetic viewpoint based on the interpretation that rays are trajectories of particles following Hamiltonian dynamics as detailed in Section 2 of Ref. [16]. Here the time dependence of a density of ray trajectories (or particles) ρ˜ is known to satisfy the Liouville equation ∂ρ˜ ∂τ (X, τ) + dX dτ · ∇X(ρ˜(X, τ)) = 0, (6) where X = (r, p) denotes the phase space coordinate with position r and momentum p. The propagator for the Liouville equation is the linear phase space operator Lτ(X, Y ) = δ(X − ϕτ (Y )), known as a Perron-Frobenius operator in dynamical systems theory [19], and hence we may write ρ˜(X, τ) = ∫ P Lτ (X, Y )ρ˜0(Y )dY. (7) Here the phase space flow ϕτ (Y ) gives the position of the particle after time τ starting at Y = (r′, p′) when τ = 0. Furthermore, ρ˜0 denotes the initial ray density at time τ = 0 and the domain of integration is over the whole of phase space P = Ω×Rd, where the integration over Rd takes care of the momentum coordinates p. Consider a source localized at a point r0 emitting waves continuously at a fixed angular frequency ω. Standard ray tracing techniques estimate the wave energy at a receiver point r by determining the density of rays starting at r0 and reaching r after some unspecified time. This may be written in the form ρ(r, r0, ω) = ∫ ∞ 0 ∫ Rd ∫ P w(Y, τ)Lτ (X,Y )ρ0(Y, ω)dY dp dτ, (8) with initial density ρ0(Y, ω) = δ(r ′ − r0)δ(k20 −H(Y )), where H = |p|2 is the Hamilton function for the wave operator Hˆ and k0 is the wave number at the source point as defined in Eqn. (1). It can be shown that equation (8) is equivalent to the diagonal approximation (5) [7]. A weight function w is included to incorporate damping and reflection/transmission coefficients. It is assumed that w is multiplicative, (w(ϕτ1(X), τ2)w(X, τ1) = w(X, τ1 + τ2)), which holds for standard absorbtion mechanism and reflection processes [17]. In order to solve the stationary flow problem (8) a boundary mapping technique is employed. For the time being let us consider a problem with a single (sub-)system Ω = Ω1 with boundary Γ. The boundary mapping procedure involves first mapping the ray density emanating continuously from the source onto the boundary Γ. The resulting boundary layer density ρ (0) Γ is equivalent to a source density on the boundary producing the same ray field in the interior as the original source field after one reflection. Secondly, densities on the boundary are mapped back onto the boundary by a boundary operator B(Xs, Y s;ω) = w(Y s)δ(Xs − φω(Y s)), where Xs = (s, ps) represents the coordinates on the boundary. That is, s parameterizes Γ and ps ∈ Bd−1|p| denotes the momentum component tangential to Γ at s for fixed H(X) = |p|2, where Bd−1|p| is an open ball in Rd−1 of radius |p| and centre s. Likewise, Y s = (s′, p′s) and φ ω is the invertible boundary map. Note that convexity is assumed to ensure φω is well defined; non-convex regions can be handled by introducing a cut-off function in the shadow zone as in Ref. [14] or by subdividing the regions further. 4 The stationary density on the boundary induced by the initial boundary distribution ρ (0) Γ (X s, ω) can then be obtained using ρΓ(ω) = ∞∑ n=0 Bn(ω)ρ(0)Γ (ω) = (I − B(ω))−1ρ(0)Γ (ω), (9) where Bn contains trajectories undergoing n reflections at the boundary. The resulting density distri- bution on the boundary ρΓ(X s, ω) can then be mapped back into the interior region. One obtains the density (8) after projecting down onto coordinate space. 3.2 Chebyshev basis representation The long term dynamics are thus contained in the operator (I−B)−1 and standard properties of Perron- Frobenius operators ensure that the sum over n in equation (9) converges for non-vanishing dissipation. In order to evaluate (I − B)−1 it is convenient to express the operator B in a suitable set of basis functions defined on the boundary. In Ref. [7] a Fourier basis has been applied, which is a natural choice of a complete basis for problems with periodic boundary conditions. However, a number of difficulties arise with this choice such as slow convergence of quadrature rules for the associated integrals and the treatment of corners on the boundary. Here we employ a Chebyshev polynomial basis representation with Gauss-Chebyshev quadrature, in which case the integration is optimal for polynomial-type integrands. Problems due to singular behavior at corners are avoided due to integrating over phase space, rather than over pairs of boundary coordinates. Gauss-Chebyshev quadrature incorporates the orthogonality weight functions for the Chebyshev basis automatically in the quadrature rule. In the case d = 2, we have s ∈ [0, L) and Chebyshev basis may be expressed in the form T˜n(X s) = √ 2 |p|LTn1 ( 2s L − 1 ) Tn2 ( ps |p| ) , (10) with n = (n1, n2) non-negative integers and Tn1 the Chebyshev polynomial of order n1. The Chebyshev basis approximation Bmn of B may be written: Bmn =∫ ∂P ∫ ∂P Wm(X s)T˜m(X s)B(Xs, Y s;ω)T˜n(Y s)dY sdXs = ∫ ∂P Wm(φ ω(Y s))T˜m(φ ω(Y s))w(Y s)T˜n(Y s)dY s, (11) where ∂P = [0, L)× (−|p|, |p|) is the phase space on the boundary at fixed “energy” H(X) = |p|2 and Wm(X s) = 4γm1γm2 π2 1√ 1− ((2s/L)− 1)2 1√ 1− (ps/|p|)2 , (12) is the weight function for the inner product in which the Chebyshev basis is orthonormal. Here γ0 = 1/2 and γn1 = 1 for n1 = 1, 2, .... It is convenient for the Gauss-Chebyshev quadrature if the argument in the weight function Wm is the same as the integration variable and so a change of variables Y s = ψω(Xs) with ψω = (φω)−1 is carried out to give Bmn =∫ ∂P Wm(X s)T˜m(X s)w(ψω(Xs))T˜n(ψ ω(Xs))|J(Xs)|dXs. (13) 5 Here the Jacobian term is |J(Xs)|= |∂ψω(Xs)| = ∣∣∣∣∣ ∂s ′ ∂s ∂s′ ∂ps ∂p′s ∂s ∂p′s ∂ps ∣∣∣∣∣ , (14) which is equal to one for Hamiltonian flows and takes account of changes in the wavenumber between subsystems. In this representation the integration is with respect to position and momentum at the end of the ray being considered, and we are mapping back to the initial point using ψω. 3.3 Subsystems Recall the splitting into subsystems Ωi, i = 1, .., NΩ introduced earlier. The dynamics in each subsystem are considered separately so that both variability in the wave velocity ci and non-convex domains may be handled simply. Coupling between sub-elements can then be treated as losses in one subsystem and source terms in another. Typical subsystem interfaces are surfaces of reflection/ transmission due to sudden changes in material parameters or local boundary conditions. We describe the full dynamics in terms of subsystem boundary operators Bij ; flow between Ωj and Ωi is only possible if Ωi ∩ Ωj 6= ∅ and one obtains Bij(Xsi , Xsj ) = wij(Xsj )δ(Xsi − φωij(Xsj )), (15) where φωij is the boundary map in subsystem j mapped onto the boundary of the adjacent subsystem i and Xsi are the boundary coordinates of Ωi. The weight wij contains, among other factors, reflection and transmission coefficients characterizing the coupling at the interface between Ωj and Ωi. A basis function representation Bmnij of the full operator B as suggested in equation (11) is now written in terms of subsystem boundary basis functions T˜ in to give Bmnij = ∫ ∂Pi ∫ ∂Pj Wm(X s i )T˜ i m(X s i )B(Xsi ,Xsj ;ω)T˜ jn(Xsj )dXsj dXsi . (16) Here ∂Pi is simply the boundary coordinate phase space for Ωi. The equilibrium distribution on the interfaces of the subsystems is then obtained by solving the system of equations (9) (I − B)ρΓ = ρ(0)Γ . (17) Here B is the full operator including all subsystems and the equation is solved for the unknown energy densities ρΓ = (ρΓi)i=1,..,NΩ, where ρΓi denotes the (Chebyshev) coefficients of the density on Γi, the boundary of Ωi. 4 NUMERICAL IMPLEMENTATION 4.1 From SEA to DEA Up to now, the various representations given are all equivalent and correspond to a description of the wave dynamics in terms of the ray tracing ansatz (8). Traditional ray tracing based on sampling ray solutions over the available phase space is rather inefficient. Convergence tends to be fairly slow, especially if the absorption is low and an exponentially increasing number of long paths including multiple reflections need to be taken into account. An SEA treatment emerges when approximating the individual operators Bij in terms of constant functions only [7]; using, for example, a Fourier basis this would correspond to an approximation in terms of the lowest order basis functions only. In the case of a Chebyshev basis, the integrand in (16) 6 Γ11 Γ12Γ13 Γ14 Γ15 Γ211 2 Γ22 Γ23 Γ24 25 Γ Ω Ω Figure 1: (Color online) A polygonal configuration with Γj = ∂Ωj for j = 1, 2 showing further subdivision Γji of the boundary. The interface is formed by the boundary sections Γ11 = Γ21 . A separate spatial basis function approximation is applied for each subdivision. is not constant due to the presence of the weight function Wm and an SEA treatment is obtained only after restricting the basis to T˜ i0 and omitting the weights W0. Note that when using Gauss-Chebyshev quadrature an explicit division by W0 is required since the weight function is automatically included in the quadrature rule. In the SEA case the matrix Bij is one-dimensional and gives the mean transmission rate from subsystem j to subsystem i. It is thus equivalent to the coupling loss factor used in standard SEA equations [2]. The resulting full NΩ-dimensional B matrix yields a set of SEA equations using the relation (17) after mapping the boundary densities back into the interior. An SEA approximation is justified if the ray dynamics within each subsystem are sufficiently chaotic such that a trajectory entering subsystem j forgets everything about its past before exiting Ωj ; SEA can thus be viewed as a Markov approximation of the deterministic dynamics. Thus correlations within the dynamics must decay rapidly on the time scale it takes for a typical ray to leave Ωj . This condition will often be fulfilled if the subsystem boundaries are sufficiently irregular, the subsystems are dynamically well separated and absorption and dissipation is small, conditions typically cited in an SEA context. In this case SEA is an extremely efficient method compared to standard ray tracing. However for subsystems with regular features, such as rectangular cavities or corridor-like elements, incoming rays are directly channeled into outgoing rays, thus rendering the Markov approximation invalid and introducing memory effects. Likewise, strong damping may lead to a significant decay of the signal before reaching the exit channel introducing geometric (system dependent) effects. The features that cause an SEA approximation to fail as described above are incorporated into the model here by including higher order basis functions and weight functions Wm for each subsystem boundary operator Bij . It therefore becomes possible to resolve the fine structure of the dynamics and their correlation along with effects due to non-uniform damping over typical scales of the subsystem. The maximal number of basis functions needed to reach convergence is expected to be relatively small thus making the new method more efficient than a full ray tracing treatment, particularly when damping is low. Representing the ray dynamics in terms of finite dimensional transition matrices corresponds to a refinement of an SEA technique, taking advantage of the efficiency of SEA but including information about the ray dynamics when necessary. It overcomes some of the limitations of SEA and puts the underlying SEA assumptions on sound foundations. 4.2 Chebyshev DEA A favourable property of the Chebyshev basis approximation compared with a Fourier basis is the flexi- bility it allows in the choice of approximation regions due to not requiring periodic boundary conditions 7 for convergence. In many cases it will be advantageous to subdivide the subsystem boundaries and apply a Chebyshev basis for each subdivision. An example where this subdivision takes place at the vertices of each subsystem is shown in Fig. 1. A separate spatial basis expansion is then applied in a number of sections Γji, i = 1, ..., Nj of the boundary Γj of a particular subsystem Ωj , j = 1, .., NΩ. This leads to separate entries in the matrix representation B for each boundary section Γji and hence a larger but sparser matrix. In order to understand why this geometric subdivision may be beneficial, we first need to consider some properties of the basis function expansions. The basis expansion of the boundary operator B results in density functions ρ (0) Γi and ρΓi in equation (9) being expanded in terms of the chosen basis functions. The convergence rate of the basis expansion therefore depends on the properties of these density functions and in particular their smoothness [15]. The basis function approximations are carried out with respect to both position s and momentum along the boundary ps at the endpoint of the ray, recall equation (13). A discontinuity in the normal to Γi for some i = 1, ..., NΩ will, in general, result in a non-differentiable initial density. It is therefore recommended to employ separate Chebyshev basis approximations with respect to s for regions of Γ split by an edge or vertex, see Fig. 1. It is also recommended to employ a separate approximation with respect to s where there is a sudden change in boundary conditions resulting in a non-smooth initial density, for example, along an interface between two subsystems. The geometric subdivision is therefore to enable smoothness of the density functions, ρ (0) Γi and ρΓi , over the regions of approximation and therefore (geometric) exponential order convergence in the Chebyshev basis expansions. The method described above has been implemented numerically for a variety of problems with Ω ⊂ R 2 and homogeneous Dirichlet boundary conditions for the total wave, (that is, including the initial contribution from the source) on the outer boundary Γ. For simplicity we consider ci = ̺ −1/2 i for all i = 1, .., NΩ, that is, we set the adiabatic compressibility to unity. Results are compared with the numerically exact solutions obtained from state-of-the-art adaptive FEM software. A brief account of the FE method is given in the next section. Let s ∈ [0, Lji) and ps ∈ (−ki, ki) parameterize the associated phase space where Lji is the length of Γji. In these local sub-system boundary coordinates the Chebyshev basis is given by T˜ jin (s, ps) = √ 2 kiLji Tn1(s˜)Tn2(p˜s), (18) where s˜ = (2s/Lji)− 1 and p˜s = ps/ki. The weight function Wn is given by Wn(s, ps) = 4γn1γn2 π2 1√ 1− s˜2 1√ 1− p˜2s . (19) The transmission probability at the intersection of two subsystems is given by [20] wt(kout, kin, θin) = 4(kout/kin) cos(θin) cos(θout) ((kout/kin) cos(θin) + cos(θout))2 , (20) with θin (θout) the angle between the incoming (outgoing) ray and the inward normal to the boundary and kin (kout) the wavenumber in the subsystem through which the incoming (outgoing) ray is traveling. Incoming and outgoing rays are related through Snell’s law (kin sin(θin) = kout sin(θout)), and hence θout may be calculated from the other three quantities. Given the end point s ∈ Γji and the incoming momentum ps, one can obtain the corresponding ray. With sufficient geometric knowledge of Γi and the boundaries of its adjoining subsystems, the start point of the ray s′ can be determined as its intersection with one of these boundaries, say in the subset Γβα 8 for some βα = 1, ..., Nα and α = 1, ..., NΩ. Once this is known it is straightforward to obtain the initial momentum p′s. Writing out the Jacobian (14) one obtains Bmnjiβα = kα ki ∫ kmaxji kminji ∫ Lji 0 Wm(s, ps)T˜ ji m(s, ps)T˜ βα n (s ′, p′s)× wjiβα(s ′, p′s)ds dps, (21) where wjiβα(s ′, p′s) = exp(−µiL)wΓjiβα(s′, p′s). Here µi is the damping coefficient in Ωi as before, L is the length of the trajectory from s′ to s and the reflection/ transmission coefficients are wΓjiβα(s ′, p′s) = { δiα if s /∈ Γiα δiα + (−1)δiαwt(ki, kα, θi) if s ∈ Γiα. Here, Γiα denotes any subset of Γα forming the intersection of two subsystems (that is, for i 6= α, Γiα = Γi ∩ Γα) and δiα is the Kronecker delta. Also kminji = ki sin(θminji ) and kmaxji = ki sin(θmaxji ) are the minimum and maximum values of ps, respectively, where θ min ji , θmaxji ∈ (−π/2, π/2) are the angles between the inward normal to Γji and the rays from s ′ to each of the ends of Γji. All DEA/ SEA computations are performed on a desktop PC with a dual core 2.83 GHz processor using C++ with Diffpack (www.diffpack.com). 4.3 hp-adaptive discontinuous Galerkin finite element method In the Sec. refsec:computations, we will compare DEA results twith numerically exact solutions of the wave equation (1). Discontinuous Galerkin (DG) methods have become increasingly popular for elliptic problems in recent years [21] and is also our method of choice for calculating the Green function.The main reason for this interest in DG methods is that allowing for discontinuities across elements gives extraordinary flexibility in terms of mesh design and choice of shape functions. Additionally, hp-adaptive DG methods, which are based on locally refined meshes and variable approximation orders, achieve tremendous gains in computational efficiency for challenging problems [22, 23, 24, 25]. In the following, we consider the wave equation (c2i∆+ ω˜ 2 i )G˜(r, r0;ω) = −δ(r − r0), i = 1, ..., NΩ, (22) with ω˜i = ω+iµici/2 and r ∈ Ωi ⊂ R2. The Green function G˜ is related to G in equation (1) by G = c20G˜, where c0 is the wave velocity in the subsystem Ω0 containing the source point r0. To drive the hp-adaptivity we use an explicit energy norm a posteriori error estimator inspired by Refs. [26, 27]. We apply a simple fixed-fraction strategy on the error estimator to mark the elements to adapt. For each marked element, the choice of whether to locally refine it or vary its approximation order is made by estimating the decay of the coefficients in an L2-orthogonal polynomial expansion in order to test the local analyticity of the solution in the interior of the element [28]. The details of the implementation of the method can be found in Appendix A. All finite element simulations have been carried out using AptoFEM (www.aptofem.com) on a parallel machine. 5 COMPUTATIONAL RESULTS 5.1 Coupled two-cavity systems A variety of two-cavity systems are considered as in Ref. [7] and are shown in Fig. 2. The coordinates of the vertices and source points of these systems are given in Appendix B. We compare our DEA results 9 y xSource y xSource y x Source Figure 2: Coupled two-domain systems: configurations A, B and C, respectively. 10 30 50 700 2 4 6 8 10 12 14 16 Frequency (Hz) R SEA N=4 N=6 30 50100 5 10 15 20 25 30 Frequency (Hz) R SEA N=4 N=6 Figure 3: (Color online) Ratio of total energies R = ‖G˜1‖2/‖G˜2‖2 in configuration A with c1 = c2 = 1 (left) and c1 = 0.5, c2 = 1 (right). Dotted lines show FEM results computed within ±5Hz of the DEA results. with standard SEA calculations; relevant parameters such as the area of each subsystem have been listed in the Appendix B. The SEA coupling loss factors are obtained from the transmission coefficients (20) integrated over the wavenumber kin of the incoming rays. The attenuation is given by the damping factor µ; in the following we will assume hysteretic damping with µi = ωη/(2ci) for i = 1, 2. Configuration A features irregular shaped well separated pentagonal subsystems and thus SEA is expected to work well. In configuration B the size of the interface between the subsystems is increased reducing their dynamical separation and therefore the applicability of SEA. Configuration C includes a rectangular left-hand subsystem channeling rays out of the subsystem and introducing long-range corre- lations in the dynamics. In addition, the source is further from the intersection of the two subsystems. SEA is thus not expected to work well for this configuration. Note that SEA results are in general insensitive to the position of the source, whereas actual trajectory calculations may well depend on the exact position. Finite basis sets have been employed with n1, n2 = 0, .., N , which gives rise to matrices of size dimB = (N + 1)2(N1 +N2), with basis functions of the same order for position and momentum in both subsystems. Note that Ni, i = 1, 2 denotes the number of subdivisions of the boundary of subsystem i as defined in Section 4.2. Energy distributions have been studied as a function of the frequency with a hysteretic damping factor η = 0.01. Here and in the remainder of this work the subsystems are numbered 1, ..., NΩ from left to right. Fig. 3 shows approximations of the ratios of the total energy in each subsystem ‖G˜1‖2/‖G˜2‖2 in 10 10 7030 500 2 4 6 8 10 Frequency (Hz) R Configuration B SEA N=4 N=6 30 50 70100 10 20 30 40 50 60 70 80 Configuration C Frequency (Hz) R SEA N=4 N=6 N=8 Figure 4: (Color online) Ratio of total energies R = ‖G˜1‖2/‖G˜2‖2 in configuration B (left) and configu- ration C (right). Dotted lines show FEM results computed within ±5Hz of the DEA results. configuration A where ‖G˜i‖2 := ∫ Ωi |G˜(r, r0;ω)|2dr, i = 1, ..., NΩ. (23) The left subplot shows the results with c1 = c2 = 1ms −1 and the right with c1 = 0.5ms −1 and c2 = 1ms −1. The dotted lines represent solutions computed using the FEM (described in section 4.3) at an equi-spaced range of frequencies within ±5Hz of the frequencies used for the SEA and DEA computations. Note that the damping is fixed to the value employed for the central (SEA/DEA) frequency. In the right-hand plot the results only go up to 50Hz due to the high computational cost of the FEM code for the large wavenumbers in subsystem 1. Fast convergence with increasing basis size is evident in each case. It is clear that SEA works reasonably well for configuration A since the SEA prediction is close to that from DEA and within the range of FEM solution values. In particular the SEA prediction is good for low damping values (that is, low frequencies). At closer inspection one notices also that the divergence from the DEA result is smaller in the case when c1 6= c2, thus demonstrating an increase in the dynamical separation between subsystems in this case. Comparing SEA with the N = 6 case between 10Hz and 50Hz, the SEA results differ from DEA by between 8% and 15% when c1 = c2 = 1ms −1, but only by between 5% and 7% when c1 = 0.5ms −1 and c2 = 1ms −1. Figure 4 shows approximations of the ratios of the total energy in each subsystem in configurations B and C with c1 = c2 = 1ms −1. The dotted lines are as before and fast convergence with increasing basis size is again evident, although a slightly higher order was required for configuration C to capture the exponential decay due to dissipation along the rectangular cavity. As expected, the SEA prediction diverges from both the FEM and DEA predictions in configurations B and C. Comparing SEA with the N = 6 case for configuration B between 10Hz and 50Hz (for consistency with the data for configuration A), the SEA results differ from DEA by between 18% and 29%. For configuration C the deviation is about 30% in the range 10Hz to 50 Hz, although this grows considerably larger if one includes the data for 60 and 70Hz. 11 −3 −2 −1 0 1 2−0.6 −0.4 −0.2 0 0.2 0.4 0.6 0.8 1 1.2 −4 −3.5 −3 −2.5 −2 −1.5 −1 −0.5 Figure 5: (Color online) Distribution of log10(|G˜|2) in a five cavity system. 5.2 Complex built-up systems In this section the versatility and efficiency of the Chebyshev approximation with Gauss-Chebyshev quadrature are demonstrated by considering a complex built-up system. A configuration of five coupled acoustic cavities is considered as shown in Figure 5. The coordinates of the vertices and source point are given in Appendix B. The solution in the interior of each cavity is plotted and the source point in the central cavity is clearly evident. The subsystems are each convex polygonal regions as before, the jagged appearance of the boundary is a result of the plotted region being formed of the largest regular grid fitting strictly inside the boundary of each subsystem. The wave velocities are taken to be c1 = c2 = c4 = c5 = 1ms −1 and c3 = 0.5ms −1. Figure 5 shows the DEA approximation of the distribution of log10(|G˜|2) throughout the system with N = 8. The logarithm of the solution is taken since a large range of values are present between the peak of the source and the extremal subsystems. The plot is for the 10Hz case with the same frequency and damping correspondence as in the earlier two-cavity configurations. DEA clearly gives much more detailed spatial information about the wave energy distributions than SEA, which assumes a constant density in each subsystem. In particular here one can see local variations close to subsystem interfaces and a drop in the intensity as one moves away from the source. Note that more energy flows into the far right subsystem as compared to the far left subsystem due to there being a direct channel for the energy to travel along to the right of the source, but not to the left. Figure 6 shows approximations of ‖G˜i‖2 for i = 1, .., 5 computed using both SEA and DEA up to N = 8. The three figures represent the total energy (actually c40 = 1/16 multiplied by this quantity since G˜ rather than G has been computed) obtained for each subregion at three different frequencies and thus damping levels; using the same parameters as before the 10, 20 and 30 Hz cases are shown from left to right. Note that results are shown on a logarithmic scale and that the overall amplitude decreases with increasing frequency due to increased damping. Here a comparison with FEM simulations is not considered due to the high computational cost associated with computing high and multi-frequency solutions over large domains. We can deduce that SEA is working very well in subsystems 1 to 3 due to the level of agreement with the DEA calculations. Very few trajectories can move from the source directly into subsystem 1 and multiple scattering events lead to a local equidistribution, that is, incoming 12 1e-05 0.0001 0.001 0.01 1 2 3 4 5 SEA N=4 N=6 N=8 0.001 0.01 1 2 3 4 5 SEA N=4 N=6 N=8 0.0001 0.001 0.01 1 2 3 4 5 SEA N=4 N=6 N=8 En er gy Subsystem SubsystemSubsystem 10 Hz 20 Hz 30 Hz Figure 6: (Color online) A plot of ‖G˜i‖2 for subsystems Ωi, i = 1, .., 5 at three different frequencies. and outgoing rays in subsystem 2 are uncorrelated. The situation is different for subsystems 4 and 5 where the influence of the direct channel from the source to subsystem 5 becomes important. Compared to the SEA result, the DEA calculations show a noticeable increase in the values of ‖G˜5‖2 and a slight decrease in the values of ‖G˜4‖2, that is, more energy reaches subsystem 5 than predicted by a Markov approximation of the dynamics. The DEA calculations again appear to converge reasonably quickly between N = 6 and N = 8. It is also evident that SEA works best for the lower damping values here, which is consistent with our observations for the two-cavity configurations. 6 CONCLUSIONS Dynamical energy analysis has been reformulated in terms of a Chebyshev basis expansion allowing a greater degree of flexibility in the design of the method and more efficient coding. A comparison of the numerical results with finite element method computations showed that dynamical energy analysis is robust and retains accuracy in cases when SEA fails. Examples where the wave velocity varies between subsystems were also considered for the first time using DEA. An extension to built-up systems, facilitated by the efficient Chebyshev basis reformulation of DEA, showed that DEA is a flexible, robust and efficient method for estimating energy density distributions at high frequencies. Acknowledgments Support from the EPSRC (grant EP/F069391/1) and the EU (FP7IAPP grant MIDEA) is gratefully acknowledged. The authors also wish to thank Inutech Gmbh, Nu¨rnberg for Diffpack guidance and licences, and Dmitrii Maksimov for carefully reading the manuscript. A Implementation of the DG method In order to compute an approximation of G˜ in (22), we partition the domain Ω with shape-regular meshes Th formed by open triangles {K}K∈Th. We assume that in the interior of each element K ∈ Th, the wave velocity and the damping are constant, such values are denoted in the interior of K by cK and µK . Further, each element K can then be affinely mapped onto the generic reference element K̂. The diameter of an element K ∈ Th is denoted by hK . Due to our assumptions on the meshes, these diameters are of bounded variation, that is, there is a constant b1 ≥ 1 such that b−11 ≤ hK/hK ′ ≤ b1, (24) 13 whenever K and K ′ share a common edge. We store the elemental diameters in the mesh size vector h = {hK : K ∈ Th}. Similarly, we associate with each element K ∈ Th a polynomial degree pK ≥ 1 and define the degree vector p = {pK : K ∈ Th}. We assume that p is of bounded variation as well, that is, there is a constant b2 ≥ 1 such that b−12 ≤ pK/pK ′ ≤ b2, (25) whenever K and K ′ share a common edge. For a partition Th of Ω and a degree vector p, we define the hp-version discontinuous Galerkin finite element space Vh of complex valued functions by Vh = { v ∈ L2(Ω) : v|K ∈ PpK(K), K ∈ Th }. (26) Here, PpK(K) is the space of polynomials on K of total degree less than or equal to pK . Next, we define some trace operators that are required for the DG methods. To this end, we denote by EI(Th) the set of all interior edges and by EΓ(Th) the set of all boundary edges of the partition Th. Furthermore, we define E(Th) = EI(Th)∪EΓ(Th). The boundary ∂K of an element K and the sets ∂K \Γ and ∂K ∩ Γ will be identified in a natural way with the corresponding subsets of E(Th). Let K+ and K− be two adjacent elements of Th, and κ ∈ EI(Th) given by κ = ∂K+ ∩ ∂K−. Furthermore, let v be a complex scalar-valued function, that is smooth inside each element K±. By v±, we denote the traces of v on κ taken from within the interior of K±, respectively. Then, the weighted average of the diffusive flux c2∇hv along κ ∈ EI(Th) is given by {{c2∇hv}} = c 2 K−c 2 K+∇hv+ + c2K+c2K−∇hv− c2K+ + c 2 K− . Similarly, the jump of v across κ ∈ EI(Th) is given by [[v]] = v+ nK+ + v − nK−, where we denote by nK± the unit outward normal vector of ∂K ±, respectively. On a boundary edge κ ∈ EΓ(Th), we set {{c2∇hv}} = c2∇hv and [[v]] = vn , with n denoting the unit outward normal vector on the boundary Γ. For a mesh Th on Ω and a polynomial degree vector p, let Vh be the hp-version finite element space defined in (26). We consider the (symmetric) weighted interior penalty discretization [29] of (22): find G˜h ∈ Vh such that Ah(G˜h, v) = Fh(v) , for all v ∈ Vh , (27) where Ah(u, v) := ∑ K∈Th ∫ K c2K∇hu · ∇hv − (ω + iµKcK/2)2uv dr − ∑ κ∈E(Th) ∫ κ ({{c2∇hv}} · [[u]] + {{c2∇hu}} · [[v]]) ds + ∑ κ∈E(Th) ∫ κ c [[u]] · [[v]] ds, Fh(v) := ∫ Ω δ(r − r0)v dr , and ∇h denotes the element wise gradient operator. Since DG methods allow for discontinuities in the finite element approximation, the supports of the shape functions never extend to more than one element. 14 A consequence is that the stencil is minimal in the sense that each element communicates only with its direct neighbors and the communication happens across the edges of the mesh where the functions in the finite element space are not continuous. This makes it natural to include the last two terms in the definition of Ah(·, ·), which control the average and the flux of discontinuous functions across the edges. In particular the stability of the method is guaranteed by the third term, which penalizes the discontinuities across the edges. So the second and the third terms are peculiar to the DG method of choice, in contrast to the first term which depends on the PDE under consideration. Furthermore, the function c ∈ L∞(E(Th)) is the discontinuity stabilization function that is chosen as follows: we define the functions h ∈ L∞(E(Th)) and p ∈ L∞(E(Th)) by h(r) := { min(hK , hK ′), r ∈ κ ∈ EI(Th), κ = ∂K ∩ ∂K ′, hK , r ∈ κ ∈ EΓ(Th), κ ∈ ∂K ∩ Γ, p(r) := { max(pK , pK ′), r ∈ κ ∈ EI(Th), κ = ∂K ∩ ∂K ′, pK , r ∈ κ ∈ EΓ(Th), κ ∈ ∂K ∩ Γ, and set c = γ c2Kc 2 K ′ c2K + c 2 K ′ p2 h , (28) with a parameter γ > 0 that is independent of h, p, cK and cK ′. The definition of c is equivalent to an hp-version of the weighted penalty parameter in Ref. [29]. The definitions of h(r), p(r) and c are designed to work with hp-adaptivity where adjacent elements of very different sizes and orders are possible. In order to keep the method stable under the adaptation process it is necessary to penalize more discontinuities across the smaller edges and also across higher order elements. This can be seen straightaway from (28). B Geometric and SEA data For completeness the coordinates of the vertices for the systems treated numerically in the paper are detailed in Table 1. For consistency with the units quoted in the paper the distances should be considered in metres. In each configuration the vertices are ordered anticlockwise starting from the vertex with the maximum x-coordinate. For configurations A and B the source point is (−0.4, 0.5), for configuration C it is (−1.4, 0.4993) and for the five plate configuration the source is located at (−0.5, 0.4993). In configurations A, B and C the interface between the subsystems is located on the intersection with the line x = 0. For the five cavity configuration the interfaces are on the intersections with the lines x = −2, x = −1, x = 0 and x = 1. Table 2 gives additional geometric parameters useful for SEA verification. Note that in a DEA framework the SEA coupling loss factors are computed using the transmission law (20) and details of the damping, frequency and wave velocity are provided in Section 4. References [1] R.H. Lyon, “Statistical analysis of power injection and response in structures and rooms”, J. Acoust. Soc. Am. 45, 545-565 (1969). [2] R.H. Lyon and R.G. DeJong, Theory and Application of Statistical Energy Analysis, (Butterworth- Heinemann, Boston, MA, 2nd edition, 1995). 277 pages. 15 Table 1: Coordinates for the numerical examples in Section V Configuration Vertex x y A 1 1.4564 0.40381 2 0.87 1.1027 3 0.0 0.6993 4 -0.83 1.1720 5 -1.048 0.3582 6 -0.28 0.0 7 0.0 0.2993 8 0.69 -0.1328 B 1 1.4564 0.40381 2 0.87 1.1027 3 0.0 0.9493 4 -0.83 1.1720 5 -1.048 0.3582 6 -0.28 0.0 7 0.0 0.0493 8 0.69 -0.1328 C 1 1.4564 0.40381 2 0.87 1.1027 3 0.0 0.7993 4 -1.503 0.7993 5 -1.503 0.1993 6 0.0 0.1993 7 0.69 -0.1328 5 Cavity 1 2.0 0.41 2 1.8 1.1027 3 1.0 0.6993 4 0.87 1.1027 5 0.0 0.5993 6 -0.83 1.1720 7 -1.0 0.5993 8 -1.87 1.1027 9 -2.0 0.3493 10 -2.8 0.7527 11 -3.0 0.06 12 -2.65 -0.4828 13 -2.0 -0.0507 14 -1.69 -0.1328 15 -1.0 0.3993 16 -0.28 0.0 17 0.0 0.3993 18 0.69 -0.1328 19 1.0 0.2993 20 1.65 -0.1328 16 Table 2: Subsystem areas and interface lengths for the numerical examples in Section V Configuration Subsystem Area (to 4sf) Interface length (with next subsystem) A 1 0.7639 0.4 2 1.064 - B 1 0.9027 0.9 2 1.259 - C 1 0.9018 0.6 2 1.142 - 5 Cavity 1 0.7694 0.4 2 0.7713 0.2 3 0.6860 0.2 4 0.7398 0.4 5 0.7694 - [3] R.J.M Craik, Sound Transmission through Buildings using Statistical Energy Analysis, (Gower, Hampshire, UK, 1996). 261 pages. [4] H. Kuttruff, Room Acoustics, 4th ed. (Spon, London, 4th edition, 2000). 349 pages. [5] V. Cerveny, Seismic Ray Theory, (Cambridge University Press, Cambridge, UK, 2001). 724 pages. [6] A.S. Glasser, An Introduction to Ray Tracing, (Academic Press, London, 1989). 327 pages. [7] G. Tanner, “Dynamical energy analysis- Determining wave energy distributions in vibro-acoustical structures in the high-frequency regime”, J. Sound. Vib. 320, 1023-1038 (2009). [8] S. Kulkarni, F.G. Leppington and E.G. Broadbent, “Vibrations in several interconnected regions: a comparison of SEA, ray theory and numerical results”, Wave Motion 33, 79-96 (2001). [9] G. Tanner and N. Søndergaard, “Wave chaos in acoustics and elasticity”, J. Phys. A 40, R443-R509 (2007). [10] K.H. Heron, “Advanced Statistical Energy Analysis”, Phil. Trans. Roy. Soc. Lond. A 346, 501-510 (1994). [11] R.S. Langley, “A wave intensity technique for the analysis of high frequency vibrations”, J. Sound. Vib. 159, 483-502 (1992). [12] R.S. Langley and A.N. Bercin, “Wave intensity analysis for high frequency vibrations”, Phil. Trans. Roy. Soc. Lond. A 346, 489-499 (1994). [13] A. Le Bot, “A vibroacoustic model for high frequency analysis”, J. Sound. Vib. 211, 537-554 (1998). [14] A. Le Bot, “Energy transfer for high frequencies in built-up structures”, J. Sound. Vib. 250, 247-275 (2002). [15] J.P. Boyd, Chebyshev and Fourier Spectral Methods, 2nd ed. (Dover, Mineola, NY, 2nd edition, 2000). Chapter 2. [16] O. Runborg, “Mathematical Models and Numerical Methods for High Frequency Waves”, Commun. Comput. Phys. 2(5), 827-880 (2007). 17 [17] P. Cvitanovic´, R. Artuso, R. Mainieri, G. Tanner and G. Vattay, Chaos: Classical and Quantum, (Niels Bohr Institut, Copenhagen, ChaosBook.org, 2009), Part V. [18] M.C. Gutzwiller, Chaos in Classical and Quantum Mechanics, (Springer, New York, 1990). Chapter 17. [19] P. Cvitanovic´, R. Artuso, R. Mainieri, G. Tanner and G. Vattay, Chaos: Classical and Quantum, (Niels Bohr Institut, Copenhagen, ChaosBook.org, 2009), Chapter 16. [20] J.A. DeSanto, Scalar Wave Theory: Green’s Functions and Applications, (Springer-Verlag, Berlin, 1992). Chapter 3. [21] D.N. Arnold, F. Brezzi, B. Cockburn and L.D. Marini, “Unified analysis of discontinuous Galerkin methods for elliptic problems”, SIAM J. Numer. Anal. 39(5), 1749-1779 (2001). [22] R. Hartmann and P. Houston, “Adaptive discontinuous Galerkin finite element methods for nonlin- ear hyperbolic conservation laws”, SIAM J. Sci. Comput. 24(3), 979-1004 (2002). [23] R. Hartmann and P. Houston, “An Optimal Order Interior Penalty Discontinuous Galerkin Dis- cretization of the Compressible Navier–Stokes Equations”, J. Comp. Phys. 227, 9670-9685 (2008). [24] P. Houston, D. Scho¨tzau and T.P. Wihler, “Energy Norm A Posteriori Error Estimation of hp– Adaptive Discontinuous Galerkin Methods for Elliptic Problems”, Math. Mod. Meth. Appl. Sci. 17(1), 33-62 (2007) [25] P. Houston, C. Schwab and E. Su¨li, “Discontinuous hp-finite element methods for advection- diffusion-reaction problems”, SIAM J. Numer. Anal. 39(6), 2133-2163 (2002). [26] D. Scho¨tzau and L. Zhu, “A robust a-posteriori error estimator for discontinuous Galerkin methods for convection-diffusion equations”, Appl. Numer. Math. 59, 2236-2255 (2009). [27] L. Zhu , S. Giani, P. Houston and D. Scho¨tzau, “Energy norm a-posteriori error estimation for hp-adaptive discontinuous Galerkin methods for eliptic problems in three dimensions”, ePrints Not- tingham, http://eprints.nottingham.ac.uk/1140/, (2009). [28] T. Eibner and J.M. Melenk, “An adaptive strategy for hp-FEM based on testing for analyticity”, Comp. Mech. 39, 575-595 (2007). [29] A. Ern, A. Stephanses and P. Zunino, “A Discontinuous Galerkin method with weighted averages for advection-diffusion equations with locally vanishing and anisotropic diffusivity”, IMA J. Num. Anal. 29, 235256 (2005). 18 