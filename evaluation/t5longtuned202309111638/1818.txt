ABSTRACT: 
This paper presents a high-order accelerated algorithm for the solution of the integral-equation formulation of volumetric scattering problems. The scheme is particularly well suited to the analysis of “thin” structures as they arise in certain applications (e.g., material coatings); in addition, it is also designed to be used in conjunction with existing low-order FFT-based codes to upgrade their order of accuracy through a suitable treatment of material interfaces. The high-order convergence of the new procedure is attained through a combination of changes of parametric variables (to resolve the singularities of the Green function) and “partitions of unity” (to allow for a simple implementation of spectrally accurate quadratures away from singular points). Accelerated evaluations of the interaction between degrees of freedom, on the other hand, are accomplished by incorporating (two-face) equivalent source approximations on Cartesian grids. A detailed account of the main algorithmic components of the scheme are presented, together with a brief review of the corresponding error and performance analyses which are exemplified with a variety of numerical results. 
 
PREDICTION: 
This paper presents a numerical scheme for scalar thin-scale scattering simulations that can deliver highly accurate results with a reduced operation count. The method is based on an accurate numerical representation of the singular operators that arise in the integral equation formulation and on FFT-accelerated evaluations. The former are attained through specialized high-order quadratures, while the latter rely on the evaluation of equivalent sources on Cartesian grids. The theoretical and numerical results presented here demonstrate the viability of the approach in the context of acoustic scattering off thin structures that may be of indepent interest e.g., material coatings. 
 
FULL TEXT: 
  © 2007 Acoustical Society of America. DOI: 10.1121/1.2714919 PACS numbers: 43.20.Fn, 43.30.Ft TDM Pages: 2503–2514I. INTRODUCTION The evaluation of scattering returns from large three- dimensional penetrable scatters continues to constitute one of the most challenging problems in computational science. The main difficulties that are present in the problem arise from the need to accurately describe and manipulate highly oscil- latory functions. Although a large body of work has been devoted to the subject, scattering problems still cannot be considered completely solved, particularly from a computa- tional perspective, and they remain the subject matter of much ongoing research. A main reason for this lies in the dependence of the mathematical formulation and computa- tional complexities on the oscillations of the incident radia- tion and on the geometrical and acoustical or other physical and/or material properties, as the case might be specifics of the scatterer. The latter include, for instance, their geometri- cal shapes and material densities, velocities, absorption, and penetrability characteristics, to name but a few. This diversity of parameters and the different nature of the difficulties associated with particular instances make the case for specialized, application specific algorithms. One such important instance is that of scattering by three- dimensional “thin” scatterers. Thin thickness up to the order of the wavelength of the incoming radiation scatterers are used, for instance, to model coatings. Clearly, these have a wide range of practical applications, both for civilian and military purposes e.g., decoy detection, stealth technology, etc. In this paper, we present a new, efficient and high-order aElectronic mail: anand@acm.caltech.edu bElectronic mail: reitich@math.umn.edu J. Acoust. Soc. Am. 121 5, May 2007 0001-4966/2007/1215solver for the prediction of the acoustic response of such thin and possibly inhomogeneous structures, that is based on the integral equation formulation of the scattering problem. As we explain in the following, and beyond their intrinsic inter- est and applicability, our new schemes can also be viewed as providing a mechanism to upgrade current low-order e.g., FFT-based solvers to fast high-order schemes in the pres- ence of material discontinuities. Most existing algorithms for computing solutions to volumetric scattering problems can be broadly classified into three classes, depending on the underlying mathematical for- mulation of the problem: i Differential equation methods; ii variational methods; and iii integral equation methods. The methods in category i are based on direct discretization of the differential equation e.g., Eq. 1 and they include, most notably, finite difference schemes e.g., FDTD techniques1–3. Those in category ii, in contrast, work with the variational form of the equation, such as in all variants of the finite element FE method.4–6 In both cases, however, a central challenge facing these numerical procedures in con- nection with scattering applications relates to the need to truncate the infinite physical domain. This issue has re- ceived, and continues to receive, significant attention in the literature as the imposition of approximate absorbing or transparent boundary conditions, or the use of perfectly matched layers PML, can still yield, in some cases, unac- ceptable results. On the other hand, even when an approxi- mate treatment of the truncation boundary/region does not pollute the numerical solution e.g., when this is effected at a considerable distance from the scatterers, other sources of error may produce unwanted results. In this regards, perhaps the most prominent source can be attributed to the dispersive © 2007 Acoustical Society of America 2503/2503/12/$23.00 characteristics of standard low-order methods based on dif- ferential and variational formulations. A classical remedy re- sorts to smaller grid spacing, with a consequent increase in computational effort. A number of more sophisticated solutions to the low accuracy of standard FDTD and/or FE methodologies, how- ever, have been developed. Generically, these algorithms are based on the use of higher-order discretization schemes. Most notable among these are so-called “spectral methods,”7–11 based on the use of global spatial basis func- tions, that provide spectral accuracy in the approximation of smooth functions. In the time domain, different methods within this category handle temporal derivatives differently. For example, the pseudospectral time-domain PSTD methods7,8 use conventional differencing schemes, e.g., leap- frog, to evolve the solution in time. The “k-space method,” originally proposed by Bojarski12,13 and further developed by Mast et al.,10 on the other hand, uses a nonstandard finite difference approach for temporal integration, which is exact for the homogeneous case; spectral approximations in time have also been used.14 While extremely efficient and accurate within their do- main of applicability, the implementation of spectral meth- odologies is, however, nontrivial, and their convergence properties, specifically for those based on the more efficient Fourier spectral approximations, are dependent on the under- lying material properties. Indeed, for instance, when applied in a straightforward manner, these techniques suffer from so-called “wraparound effects,” caused by the lack of peri- odicity in the problem. As has been recently shown in the context of the PSTD and k-space approaches,9,11 however, these effects can be significantly mollified by employing a PML. In this manner, and for practical purposes, the result- ing schemes can be considered to converge with higher or- ders, at least in simulations that entail smooth scattering me- dia. The extension to scattering configurations that present material discontinuities, on the other hand, is substantially impeded by Gibbs-type phenomena that are inherent to spec- tral approximations. The modifications that have been pro- posed to date to alleviate these effects are not as satisfactory: Those based on filtering10,11 or NUFFTs15–17 clearly do not retain high-order convergence characteristics, while those that use postprocessing procedures e.g., Gegenbauer reconstruction18 are of limited applicability19,20 and, more- over, they can adversely affect the computational cost. As we mentioned, the work we present here relates to a new methodology for the solution of the volumetric inte- gral equation formulation of the scattering problem that pro- vides a high-order treatment of material discontinuities. Our approach, therefore, falls within the above-mentioned cat- egory iii and, as such, it obviates the need for the explicit imposition of radiation conditions as these are encoded in the Green’s function. Within this class of methods, perhaps the best known algorithms are those related to the CGFFT,21,22 which uses an iterative procedure conjugate gradients, in this case to solve the convolution integral equation; at each iteration the convolution is effected with fast Fourier transforms which, for a number N of unknowns, 2entails a cost of ON log N instead of the ON  cost of 2504 J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007direct evaluation. Again here, this solution procedure leads to very efficient numerics and is highly accurate for smoothly varying media, but its convergence degrades sig- nificantly in the presence of material discontinuities.17,23 In fact, to our knowledge, only limited attempts have been made toward the development of efficient higher-order integral-equation solvers for volumetric scattering applica- tions. A notable exception is the work of Zhu and Gedney,24,25 based on the “discontinuous FFT” of Fan and Liu.23 This latter scheme is based on the accurate evaluation of Fourier coefficients of discontinuous functions through Gaussian quadratures and careful interpolation from and to equispaced grids and, while it can be shown that this im- proves on the convergence of the CGFFT from first- to second-order accurate, in fact, it fails to address the Gibbs phenomenon which arises as the Fourier series is summed. A simpler and more efficient approach, based on a suitable de- composition of the Green’s function, and also leading to second-order convergence for discontinuous scatterers, has been recently proposed in Ref. 26. The rest of the paper is organized as follows. In Sec. II, we precisely define the concept of a “thin structure” and we review the mathematical formulation of the corresponding volumetric scattering problem, based on the solution of the Helmholtz equation. The main algorithmic components of our approach are detailed in Sec. III. In Sec. IV, an analysis of the accuracy and efficiency of the numerical scheme is presented. This is followed, in Sec. V, by a presentation of the results from a variety of numerical experiments that ex- emplify the properties of the procedure. We present, in Sec. VI, a brief discussion on the use of our thin volume integra- tor in conjunction with existing low-order FFT-based meth- ods to upgrade their order of accuracy in the presence of material discontinuity. Finally, our conclusions are summa- rized in Sec. VII. II. PRELIMINARIES A. Mathematical formulation As mentioned earlier, we shall consider the Helmholtz model of acoustic scattering by a bounded, inhomogeneous medium  of refractive index nx. Within this context, given an incident field ui, its interaction with the scatterer produces a scattered field us and the total field u=ui+us, satisfies the Helmholtz equation ux + 2n2xux = 0, x R3. 1 In addition, the Sommerfeld radiation condition is imposed on us to enforce its outgoing character. Equivalently,27 the total field u also satisfies the Lippmann-Schwinger integral equation ux + 2Kux = uix, x R3, 2 where Kux =  Gx,xmxuxdx, 3  A. Anand and F. Reitich: Thin structure acoustic scattering Gx,x = expx − x 4x − x is the Green’s function for the Helmholtz equation in three dimensions and m=1−n2. Note that m0 outside of  and also that the choice of Green’s function guarantees that us is outgoing. The solvability of the integral equation 2 has been thoroughly investigated, and positive results have been established for rather general contrast functions m; see, e.g., Refs. 27–30 As we said, our initial developments will be geared to- ward solvers for thin structures which we formally define next. B. Thin structures A thin structure  see Fig. 1 is described by a finite collection of patches P= Pp : p=1, . . . , P that cover the en- tire structure, i.e., =p=1 P Pp, where each patch is param- eterized by a smooth invertible map xp : 0,13→Pp, xp = xps,t, s,t = s1,s2,t 0,13. By convention, the two-dimensional variable s shall cor- respond to “parallel” coordinates while the variable t will describe the structure in the “transverse” direction. We say that the structure  is thin if the thickness sup s0,12 xps,1 − xps,0  4 for all p=1, . . . , P. Here, =2 / is the wavelength of the FIG. 1. Description of thin structures; overlapping patches and correspond- ing parametric spaces are constructed to cover the scatterer of thickness of the order of the wavelength of incoming radiation.incident radiation. J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007III. AN EFFICIENT HIGH-ORDER SOLVER Naturally, the possibility of producing fast and accurate solutions depends on our ability to evaluate the integral in Eq. 3 accurately and efficiently. Clearly, Gx ,x changes rapidly when the source point x is close to or, in other words, adjacent to the target point x and is singular when x=x. Thus, the first difficulty relates to the design of high order quadratures for Kux in the vicinity of the target point x. More precisely, for a neighborhood Nx of x, we can separate the integral in Eq. 3 into Kux =  Nx Gx,xmxuxdx +  \Nx Gx,xmxuxdx 5 corresponding to “adjacent” and “nonadjacent” interactions, respectively; the calculation of the singular adjacent inter- actions then necessitates the design of a specialized quadra- ture rule Sec. III A. Once these adjacent interactions have been computed, there will only remain to compute nonadja- cent interactions  \Nx Gx,xmxuxdx. The accurate evaluation of these though does not pose a ma- jor difficulty in the design of approximate quadratures as the integrand is regular. However their number entailing ON operations for each of N target points demands the design of a suitable “accelerator” Sec. III B. In summary, the goal is to design an algorithm that accurately evaluates the singular adjacent interactions without compromising speed and that can, at the same time, efficiently evaluate the voluminous number of nonadjacent interactions. A. Adjacent interactions The singular nature of the integral kernel Gx ,x causes the main difficulty in high-order evaluation of adja- cent interactions. Even though the use of the well-known strategy of “singularity subtraction” does give rise to bounded integrands, an application of classical high-order quadratures to these still fails to provide high-order results, since the higher order derivatives of the integrand are un- bounded. Thus, a specialized quadrature rule must be devel- oped and used to achieve high-order accuracy. To present the method, consider a partition of unity sub- ordinated to the covering P, that is a collection of functions wpx, p = 1, . . . ,P , 6 such that 1 wp is defined, smooth, and non-negative in , and it vanishes outside Pp, and 2 p=1 P wp=1 throughout .Then, we can write A. Anand and F. Reitich: Thin structure acoustic scattering 2505 Kux = p=1 P Kpux , where Kpux =  0 1  0,12 Gx,xps,tu ps,tdsdt 7 and u ps,t = mxps,tuxps,twpxps,tJps,t . Here, Jp is the Jacobian of the transformation xp. In the case when x does not lie on the integration patch Pp, the integrand in Eq. 7 is smooth and as a result can be integrated to high order. The fact that the integrands in the two-dimensional “parallel” integrals  0,12 Gx,xps,tu ps,tds vanish to high order at the boundary of the integration do- main 0,12 due to the presence of wp as a factor suggests the use of trapezoidal rule for the approximation as it is well known to achieve spectral accuracy for such smooth and periodic integrands. Indeed, (1) for xPp, use of trapezoidal rule to compute two-dimensional “parallel” integrals and a high-order composite Newton-Cotes quadrature for the transverse integral, on a uniform grid sij , tk = ihs1 , jhs2 ,kht on the parameter space of Pp, yields an overall highly accurate numerical quadrature. On the other hand, the case when x=xps , t lies in the integration patch Pp needs a more careful treatment if high- order accuracy is to be achieved, due to the singular nature of the integrand in Eq. 7. To this end, we begin by using a smooth cut-off function s satisfying ss = 1 for s − s r1, ss = 0 for s − s r0, 8 to localize the singularity Kpux =  0 1 Bs,r0 Gx,xps,tu ps,t ssdsdt +  0 1 0,12 Gx,xps,tu ps,t1 − ssdsdt, 9 where Bs ,r0 denotes the disc of radius r0 centered at s. The factor 1− in the integrand of the second integral in Eq. 9 removes the singularity of the Green’s function which can, therefore, be integrated to high-order directly as in the above-described case xPp, that is (2) if xPp, the integral away from the target point is approximated as in step (1). To deal with the first integral, on the other hand, we denote the “parallel” integrals corresponding to each t by pIut ;x, i.e., 2506 J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007Iu pt;x =  Bs,r0 Gx,xps,tu ps,t ssds 10 so that it can be rewritten as  0 1 Iu pt;xdt. 11 As we anticipated, evaluation of Iu pt ;x poses difficulties due to the singular character of integrand for t= t and the “near singularity” when t is close to t. To overcome these difficulties, the following twofold strategy is used: a A change to polar coordinates  , around the point s in the s plane, transforms the integral in Eq. 10 to Iu pt;x =  0 2 d 0 r0 Gx,xps + d,t u ps + d,t ss + d,td , where d= cos  , sin . The additional factor  makes possible the use of a uniform grid in  independent of  and t for the approximation of the  integrals, which can be performed accurately using trapezoidal rule in view of the -periodic smooth integrands. b Use of an additional change of variables = such that dmdm=0 = 0 for m = 0, . . . ,M 12 e.g., =M+1 gives Iu pt;x =  0 2 d 0 0  x − xps + d,t fup,;td , 13 FIG. 2. Color online Four patches used to cover the spherical shell and corresponding discretization grids used for the scattering computation.where A. Anand and F. Reitich: Thin structure acoustic scattering fup,;t = 1 4 expx − xps + d,t u ps + d,t ss + d,t and 0=−1r0. The integrand in Eq. 13 now has M deriva- tives in  that are uniformly bounded and it also vanishes to high order at the end points =0 and =0, so that a high- order integration in  can be achieved using the trapezoidal rule. Note that in order to perform the integration in Eq. 13, for each t, we need the density, u ps+d , t on a polar grid l1 ,l2 around s in the s plane a uniform grid in the  direction and a -transformed grid in the radial direction. In order to obtain this additional data from the original grid sij , tk, we use FFT-refined polynomial interpolation proce- dure described in the following. (3) Obtain the Fourier coefficients of the density up for each of the planes s , tk :s 0,12 using two-dimensional fast Fourier transforms, FFTup. (4) Evaluate the Fourier series on a much finer equis- paced grid sij /F , tk, where F is the level of refinement e.g., FIG. 3. Color online Scattering of an incoming plane-wave by a thin sphe field, respectively; d, e, and f the corresponding cross-sectional view.F=2,4 ,8 , . . .. These evaluations can be obtained efficiently J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007using two-dimensional fast Fourier transforms, FFT−1. As a result of steps 3 and 4, we achieve a spectrally accurate “trigonometric” interpolation of smooth and periodic density on an F-times finer grid. 5 Two-dimensional polynomial interpolation of a fixed order R e.g., bicubic, R=4 can be performed locally on the fine grid sij /F , tk to obtain the interpolated density values on the polar grid l1 ,l2. The resulting FFT-refined polyno- mial interpolation scheme is much more accurate for our smooth periodic density than a polynomial interpolation alone as the error is proportional to hs1 /F R+ hs2 /F R rather than simply to hs1 R +hs2 R . Finally, 6 if xPp and for integration near the target point, use the interpolated data to evaluate an accurate approxima- tion of the parallel integral (13) in the form of the trapezoi- dal rule in the transformed variables  ,, Iu pt;x  l1,l2 Gx,xps + l1dl2,t u ps + l1dl2,t ss + l1dl2,t l1l1 . shell. a, b, and c The surface view of the incident, total, and scatteredricalFinally, the integration in the transverse direction A. Anand and F. Reitich: Thin structure acoustic scattering 2507 t-direction in Eq. 11 can be handled through a high-order quadrature rule, if carefully partitioned. Indeed the integrand Iu pt ;x is precisely a single layer potential supported on the surface St = x ps,t:s 0,12 and it is therefore smooth for 0 t t and for t t1 in fact, it has a corner type singularity at t= t27. Hence we rewrite Eq. 11 as  0 t Iu pt;xdt +  t 1 Iu pt;xdt, 14 where each integrand is smooth and can therefore be treated with a high-order composite Newton quadrature with a num- ber Q of points. To this end, however, we need the values of Iu pt ;x at points, say t˜k, other than the original grid points tk , to evaluate Eq. 14 when t is near 0 or 1 so that there are enough data points on the grid between 0 and t or t and 1 to enable a high-order quadrature of the integrands in Eq. 14. To obtain these extra values, we pursue the following scheme: 7 For each sij on an equispaced grid, we interpolate the smooth density u psij , t to obtain additional values in t-direction at points t˜k near the end points t=0 and t=1. 8 Perform the parallel local integration in Eq. (13) (again in transformed variables) to obtain the values Iupt˜k ;x at these additional points. Once we have the additional data, we 9 evaluate the full local integral (14) with a high-order Newton-Cotes quadrature in the transverse direction. As a result, steps 1–9 provide a high-order quadrature for adjacent interactions. As we said, the use of a partition of unity 6 allows for the integration of the nonsingular non- adjacent interactions to be performed to high order with a simple use of the trapezoidal rule. There, however, the cen- tral issue is one of computational cost; a strategy to reduce this is described in the following. B. Nonadjacent interactions: Acceleration As we noted in Sec. III A, difficulties in integration arise only when the source point is close to the target point due to the behavior of the kernel Gx ,x. The above-described integration scheme for adjacent interactions is unnecessary for source points that are sufficiently away from the target point and, in fact, a more efficient strategy can be devised. Indeed, for these, a direct application of the trapezoidal rule yields superalgebraic convergence, on account of the smooth p TABLE I. Convergence study. Plane-wave scattering =10 by a spherical shell radius=1; thickness=0.025. Grid size Unknowns Samp. densitya E Order 416165 5 120 1.6 4.680310−2 ¯ 432325 20 480 3.2 1.999810−3 4.5487 464645 81 920 6.4 9.209510−5 4.4406 41281285 327 680 12.8 1.777410−6 5.6953 aNumber of points per wavelength.vanishing of the functions w x in Eq. 6. However such a 2508 J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007procedure results in an ON2 algorithm which may be suit- able only for relatively small N. For large N, on the other hand, we propose a variant of the acceleration strategy intro- duced in Ref. 31, for surface scattering that is suitable to our volumetric problem. Specifically, as in Ref. 31, our acceleration strategy is based on certain distributions of “equivalent sources” on Cartesian grids. More precisely, we begin by bounding the obstacle by a cube C of side length A which is then parti- tioned into L3 identical cubes Ci of side H=A /L. We then replace the true sources contained in the cube Ci by a number Mequiv of “equivalent sources” on the faces of Ci in such a way that the field produced by these equivalent sources coincides, to high-order accuracy, with the field gen- erated by the “true sources” volume discretization data in Ci at all points in space that are “not adjacent” to Ci. Three independent sets F il, l=1,2 ,3 of equivalent sources, com- prising both monopoles of intensity i,j l i,j l Gx ,xi,j l  and dipoles of intensity i,j l i,j l Gx ,xi,j l  /xl, are used for this calculation. These equivalent sources in F il are placed on an equispaced grid xi,j l , j=1, . . . ,Mequiv on the union of two faces of Ci that are parallel to coordinate plane xl=0. The field generated by these equivalent sources Kna,eq l,Ci ux = j=1 1/2Mequiv i,jl Gx,xi,jl  + i,j l  Gx,x xl  x=xi,j l  15 approximates the field generated by true sources in Ci within TABLE II. Computational efficiency. Spherical shell geometry.  Thickness N  E R 2 0.1 5 120 0.325 1.312110−3 ¯ 4 0.05 20 480 0.419 7.871810−4 3.1 8 0.025 81 920 0.490 8.480310−5 3.4 16 0.0125 327 680 0.546 4.429510−4 3.8 FIG. 4. Color online Patches used for the bean shaped scattering geometry and corresponding discretization grids for computation. A. Anand and F. Reitich: Thin structure acoustic scattering a prescribed tolerance , provided Mequiv is chosen as31 Mequiv = max42A2L2 ,4c2 , 16 where c = − log log3 . Denoting the field generated by the true sources within the cell Ci by KtrueCi ux, the intensities i,jl and i,jl are then chosen such that the vector formed by the differences Ktrue Ci ux−Kna,eq l,Ci ux is minimized in the mean-square norm as x varies over a number ncoll2Mequiv collocation points on Si, where the “supercube” Si is union of Ci and its neighboring cells. Thus for stability reasons these intensi- ties are obtained as the least-squares solution of an overde- termined linear system. Now, recalling the definitions of adjacent and nonadja- cent interactions, and replacing Nx in Eq. 5 with Si, we have for xCi, Kux = Kaux + Knaux , where Kaux =  Si Gx,xmxuxdx 17 and Knaux =  ˙ \Si Gx,xmxuxdx. 18 For each l=1,2 ,3, we define Kna,eq l ux = i=1 L3 Kna,eq l,Ci ux − iCiSi Kna,eq l,Ci ux , 19 which provide accurate approximations to Knau throughout the boundary of each cell Ci. The key observation here, of course, is that both summations in Eq. 19, being exact con- volutions on a Cartesian grid, can be evaluated efficiently by means of fast Fourier transforms. Finally, the evaluation of the field values at the true source location from its values at the boundaries of each cell Ci amounts to solving Dirichlet boundary value problems within each Ci. Such Dirichlet problems can be solved uniquely and in a stable manner since the size of the cells can be chosen so that internal resonances do not occur.31 For efficiency, the field values inside a cell are obtained using a discretized plane wave expansion,32 Kna,equx = k=1 nwave k expdk · x , 20 that approximates Knaux. Here dk are unit vectors defin- ing directions of wave propagation and  = 1 ,2 , . . . ,nwave is a vector of expansion coefficients. Since Knaux does not contain contributions from cells adjacent to x, the expansion 20 converges exponentially J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007fast with increasing number of wave vectors dk. The wave direction vectors dk are chosen so that they sample the surface of the unit sphere with a sufficient degree of uni- formity. The coefficients k, on the other hand, are chosen such that the expansion 20 matches the field values on the boundary of Ci. The matching procedure thus requires solution of a system of linear equations A = b , 21 where the nfacenwave-matrix A consists of elements expd·x evaluated at the equivalent-source points x =xi,j l on the boundary of Ci and at the discrete direction vectors d=dk. The right-hand side of Eq. 21, b = b1 ,b2 , . . . ,bnface, is a vector of known values of Knau at all the equivalent-source points xi,j l on the boundary of Ci. Again here, due to stability considerations, the problem is set up such that the associated linear system 21 is overdetermined. Note that the identical geometry of cells Ci enables us to compute the QR-factorization of A only once and to store it for repeated use. IV. ACCURACY AND EFFICIENCY The above-presented integration schemes for computing adjacent and nonadjacent interactions are designed with the dual goal of achieving high order accuracy and computa- tional efficiency. In this section we provide a brief summary of the arguments that substantiate these claims; numerical examples that further confirm these derivations are presented in Sec. V. Specifically, first, in Sec. IV A, we show that our numerical solution indeed converges to the exact solution with a tunable convergence order. In Sec. IV B then, we provide a derivation that delivers an optimal choice to mini- mize computational effort for the number L3 of cells to be used in the acceleration procedure cf. Sec. III B. A. Accuracy: Error analysis A careful derivation of an estimate for the error incurred by the algorithm presented in Sec. III can be performed in a rather straightforward manner, much as in other standard analyses of schemes for the solution of integral equations see, e.g., Ref. 33. The basic estimate relates to that of the quadrature error, as an appeal to the uniform invertibility of the discretized operators then translates this into the actual error in the computed solution. In our case, the quadrature error can be easily estimated, through bounds on the error incurred at each step of our procedure. Briefly, for instance, the error in the trapezoidal rule of steps 1 and 2 presented earlier is proportional to hs k where k denotes the degree of smoothness of the field within , and hs denotes the parallel grid spacing. Similarly, the error in the composite Newton-Cotes quadrature is no larger than a constant multiple of ht Q , where ht is the grid size in the transverse direction. The error in the Fourier/polynomial in- terpolation of steps 3–5, on the other hand, is bounded by a constant times hs /FR and, similarly, that in step 7 by ht R . The adjacent, parallel integration of steps 6 and 8, in turn, kincur an error proportional to hs and, finally, the transverse A. Anand and F. Reitich: Thin structure acoustic scattering 2509 al vieintegration in step 9 approximates the true value within Oht Q. Combining these observations, and letting F be such that hs /F ht, we obtain Max Error Consths k + ht minQ,R . The above-presented analysis of the numerical scheme establishes the high-order convergence of the algorithm. The remaining issue of computational efficiency is analyzed in the following. B. Efficiency: Operation count The number of floating point operations required to compute Ku depends on L and Mequiv cf. Sec. III B, in addition to the number N of volume discretization points. The latter must, of course, be chosen so as to correctly sample the field, on the scale of the wavelength of radiation, as well as to resolve material/geometrical variations. The equiv FIG. 5. Color online Scattering of an incoming plane wave by a bean-sh scattered field, respectively; d, e, and f the corresponding cross-sectionnumber M , in turn, should guarantee that the equivalent 2510 J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007field is also well-resolved. Since Mequiv is the number of points on a face of a cell Ci, of area A /L2, we must have Mequiv  2A2/L2. 22 The number L, on the other hand, is at our disposal and can therefore be chosen so to minimize the computational effort to attain a prescribed accuracy . To this end, we must evalu- ate the cost of each step of our procedure, as a function of L; the optimal choice then can be easily and, explicitly de- rived as that which minimizes the resulting overall cost. To evaluate the cost of each step, we first note that, for a thin structure, only OL / AL2=OL3 / A out of a total of L3 cells Ci contain source points; the rest are empty. As a result, OAN/L3 23 discretization points lie, on average, in each of the nonempty thin scatterer. a, b, and c The surface view of the incident, total, and w.apedcells. A. Anand and F. Reitich: Thin structure acoustic scattering Thus, the total number of operations required for the local integration cf. Sec. III A is as follows. 1 Cost of adjacent integrations=ONAN /L3 =OAN2 /L3. The interpolations necessary to allow for this integration steps 3, 4, 5, and 7 in Sec. III A, on the other hand, cost no more than 2 Cost of interpolation=ON log N on account of the FFT refinement. The cost of the acceleration scheme, finally, is largely determined by the need to perform three convolutions through FFTs on three-dimensional grids of size L3Mequiv L planes containing L2Mequiv equivalent sources each. 3 Cost of evaluation of equivalent source interactions =OL3Mequiv logL3Mequiv. In addition to this cost, we must also consider that of the corrections in Eq. 19 corresponding to cells CiSi, and that of the least-squares problems that determine the equiva- lent sources and the coefficients of plane wave expansions cf. Eq. 21. The former can be computed with three- dimensional FFTs of size Mequiv on each cell, for a total cost of 4 Cost of corrections to equiv. source interactions =OL3 / AMequiv logMequiv, while the latter demands the QR factorization of a single matrix of size Mequiv and the FIG. 6. Color online Scattering of an incoming plane wave by a thin scatterer with singularities. a and b The surface view and cross-sectional view of the computed scattered field, respectively, corresponding to an in- cident plane wave expx3 with =5.evaluation of the right-hand sides, for a cost of J. Acoust. Soc. Am., Vol. 121, No. 5, May 20075 Cost of solution of all least-squares problems =OMequiv3+ONMequiv. This last equality uses the fact that Mequiv is no bigger that the number of points per non-empty box cf. Eq. 23, which follows from Eq. 22 and the fact that N must be at least as large as the acoustic volume 2A2 of the scatterer, Mequiv  OAL AL OAL AL  2 OAL NL2 = OA NL3 . 24 Collecting these costs leads to an expression that, for each given N, can be minimized in L. A simple calculation then reveals that the optimal value of L is Lopt = ON4−/8 if 4/5   1ON4+/12 if  4/5,  25 where N,A = log2A2/logN 26 is a relative measure of the refinement of the grid. With these choices we have Optimal Cost = ON7+4/8 log N if 4/5   1ON+4/4 log N if  4/5.  27 Note that in the first case, corresponding to coarser discreti- zations, the operation count lies between ON6/5 log N and ON11/8 log N. In the more relevant case of  4/5, i.e., for more refined grids, the operation is lower and it ap- proaches N log N with increasing refinement. In any case, as we said, the count is never higher than ON11/8 log N. V. NUMERICAL RESULTS In this section, we present numerical experiments for various thin structures in three dimensions. In all of the ex- amples, the linear systems resulting from the discretization of Eq. 2 are solved by means of the iterative solver GMRES34 in fully complex arithmetic. The first example involves scattering computations for a thin spherical shell of refractive index 2 resulting from the incoming wave uix = ed·x 28 for which an exact solution can be computed. Four patches see Fig. 2 were used to describe the thin spherical shell via smooth local parametrizations and the parameter values F =4, Q=5, and R=4 were used for the numerical computa- tions. Recall that the parameter F is the level of refinement used in the trigonometric interpolation steps 3 and 4, Q is the number of points used for the Newton-Cotes quadrature steps 1, 2, and 9, and R1 is the degree of the interpolating polynomials steps 5 and 7. The surface and cross-sectional views of the computed fields in the case d= 0,0 ,1 are pre- sented in Fig. 3. A. Anand and F. Reitich: Thin structure acoustic scattering 2511 Numerical results on the maximum relative near-field error E, E = maxu exact − ucomputed maxuexact , for the example of Fig. 3 are presented in Table I. Clearly, these results confirm the high-order convergence of the scheme cf. Sec. IV A. In Table II, on the other hand, we present a numerical study of the computational complexity associated with this example. To this end we consider a se- quence of scattering problems with increasing frequencies and wherein the thickness of the domain is correspondingly reduced so as to continue to satisfy the thinness assumption 4. Table II shows that the computational effort grows as predicted by Eq. 27. To display this, the growth in the computational cost for successive doublings of the wave number, and consequent quadrupling of the number of points, is measured by TABLE III. a Maximum relative near field error a configuration in Fig. 8 with N discretization points. waves of increasing frequency and corresponding in a N Samp. densitya Max error 3162 4 2.3795E−1 3322 8 1.8715E−3 3642 16 2.6252E−5 31282 32 1.3674E−7 a FIG. 7. Color online Variable index example. a and b The surface and cross-sectional view of the computed scattered field, respectively, corresponNumber of points per wavelength 2512 J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007R = T2/log 4N 1/q2 T/log N1/q . Here T and T2 are the computational times corresponding to  and 2, respectively, and q= 4+ /4 and q2= 4 +2 /4 denote the powers in the count 27. As predicted the ratios R do not exceed 4, the ratio of the number of points. Our algorithm, of course, is not constrained by the ge- ometry of the scattering object. In fact, the only requirement to handle any given geometry is that suitable local param- etrizations be constructed. To demonstrate this, we present two additional examples involving a bean-shaped thin scat- terer and a thin volume geometry with conic singularities, with n2=2. The former geometry corresponds to the param- etrization pared with the analytical solution for the scattering Computational time per iteration for incident plane es in the number of unknowns. b r a N Time/iter. s Order 4 3322 7 8 3642 35 1.2 16 31282 151 1.1 256 32562 688 1.1 s-sectional views of the refractive index. c and d The surface view and to an incident plane wave expx3 with =10.s com b creas Orde 6.99 6.16 7.58cros dingA. Anand and F. Reitich: Thin structure acoustic scattering x1 2 a2 + 1A cos x1A + x2 2 b21 − 2 cos x1A  + x3 2 c21 − 3 cos x1A  = A21 − Bt2 with a=1.0, b=1.0, c=1.0, 1=0.3, 2=0.4, 3=0.1, A =1.0, B=0.1, and 0 t1 see Fig. 4. The field compu- tations for this configuration =10, d= 0,0 ,1 are pre- sented in Fig. 5. Results for the singular geometry x1 2 + x2 2 + sin2x32c  = 1 − Bt2 with c=5.0, B=0.1, and 0 t1, in turn, are presented in Fig. 6 =5, d= 0,0 ,1. By design, our algorithm is also not restricted to consid- eration of constant or piecewise constant refractive indices. An example with variable refractive index is included in Fig. 7 for a spherical shell scatterer. The refractive index is given by nr,, = 1 + cos2  and the incidence is a plane wave with =10 and d FIG. 8. Color online a The decomposition of an inhomogeneity a cir- cular cylinder with radius a and constant refractive index n=2 into two thin-volume patches and one bulk patch, with the associated discretization mesh. b The near field intensity of the solution u due to an incident plane wave traveling from lower-left to upper-right with a=4.= 0,0 ,1. J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007VI. DISCUSSION Our present work concentrates on the specialized treat- ment of regions near material discontinuities, which we view as thin scatterers. Here, however, we briefly discuss the ap- plication of these ideas to the general case, wherein we couple our new schemes to the more classical approaches, such as those described in Ref. 26, to deliver fast and accu- rate solutions in the presence of discontinuities. The basic premise here is that, as we mentioned, these latter spectral methodologies deliver highly accurate solutions whenever the scattering media vary smoothly. In Fig. 8 we display some preliminary results of the integration of the spectral scheme proposed in Ref. 26 with our new thin-volume scat- tering solver. Figure 8a shows the “partition of unity” used here to smoothly separate the “bulk” of the domain, to be treated with the method of Ref. 26, from the thin “boundary volumes” to which the schemes presented in this text are applied. The interaction between the bulk and boundary vol- umes are effected via FFTs and equivalent source calcula- tions see Sec. III B. Table III, on the other hand, shows that high-order accuracy is indeed attained, and that the cost grows only linearly with problem size. A thorough analysis and further applications of such integrated algorithms, how- ever, are left for future work. The numerical experiments indicate that the number of iterations required by GMRES to solve the linear system arising from the discretized integral equation, without any preconditioning, increases quadratically with the problem size e.g., a. For example, 23 iterations were needed in the above-presented example for a=4. Although a considerable research effort has been devoted to the development of ef- fective preconditioning techniques for such scattering problems,35,36 it still cannot be considered completely solved and remains the subject matter of much ongoing research. VII. CONCLUSIONS We have presented a numerical scheme for scalar thin- structure scattering simulations that can deliver highly accu- rate results with a reduced operation count. The method is based on an accurate numerical representation of the singular operators that arise in the integral equation formulation and on FFT-accelerated evaluations. The former are attained through specialized high-order quadratures, while the latter rely on the evaluation of equivalent sources on Cartesian grids. The theoretical and numerical results presented here demonstrate the viability of the approach in the context of acoustic scattering off thin structures that may be of indepen- dent interest e.g., material coatings. As follows from our discussion, however, the basic ideas behind our schemes can be readily extended to other wave models electromagnetics, elasto-dynamics. More importantly perhaps, we have also explained how our new algorithms can provide an effective means to upgrade existing FFT-based numerical methods to allow these to accurately handle material discontinuities, by smoothly separating the scatterer into an interior bulk and thin boundary volumes. Indeed, as we said, any method that can efficiently and accurately compute the scatter off A. Anand and F. Reitich: Thin structure acoustic scattering 2513 smoothly varying media can be used to treat the bulk, and interfaced with the thin volume solver presented here to compute the fields in the vicinity of discontinuities. As we have shown, this interface can be made seamless and in a manner that provides high-order convergence without com- promising efficiency. ACKNOWLEDGMENTS F.R. gratefully acknowledges support from AFOSR through Contract No. FA9550-05-1-0019, from NSF through Grant No. DMS-0311763, and from the Army High Perfor- mance Computing Research Center AHPCRC under Army Research Laboratory Cooperative Agreement No. DAAD19- 01-2-0014. The computations for this project were carried out at the Minnesota Supercomputing Institute, whose sup- port is also gratefully acknowledged. 1G. Cohen and P. Joly, “Construction and analysis of fourth order finite difference schemes for the acoustic wave equations in nonhomogeneous media,” SIAM Soc. Ind. Appl. Math. J. Numer. Anal. 33, 1266–1302 1996. 2A. Bamberger, R. Glowinski, and Q. H. Tran, “A domain decomposition method for the acoustic wave equation with discontinuous coefficients and grid change,” SIAM Soc. Ind. Appl. Math. J. Numer. Anal. 34, 603–639 1997. 3B. Gustafsson and P. Wahlund, “Time compact difference methods for wave propagation in discontinuous media,” SIAM J. Sci. Comput. USA 26, 272–293 2004. 4A. Kirsch and P. Monk, “Convergence analysis of a coupled finite-element and spectral method in acoustic scattering,” IMA J. Numer. Anal. 10, 425–447 1990. 5W. Rachowicz and L. Demkowicz, “An hp-adaptive finite element method for electromagnetics. 1. Data structure and constrained approximation,” Comput. Methods Appl. Mech. Eng. 187, 307–335 2000. 6A. Kirsch and P. Monk, “An analysis of the coupling of finite-element and nystrom methods in acoustic scattering,” IMA J. Numer. Anal. 14, 523– 544 1994. 7Q. H. Liu, “Large scale simulations of electromagnetic and acoustic mea- surements using the pseudospectral time-domain method pstd algo- rithm,” IEEE Trans. Geosci. Remote Sens. 37, 917–226 1999. 8B. Yang, D. Gottlieb, and J. S. Hesthaven, “Spectral simulations of elec- tromagnetic wave scattering,” J. Comput. Phys. 134, 216–230 1997. 9Q. H. Liu, “The pseudospectral time-domain pstd algorithm for acoustic waves in absorptive media,” IEEE Trans. Ultrason. Ferroelectr. Freq. Con- trol 45, 1044–1055 1998. 10T. D. Mast, L. P. Souriau, D. L. D. Liu, M. Tabei, A. I. Nachman, and R. C. Waag, “A k-space method for large scale-models of wave propagation in tissue,” IEEE Trans. Ultrason. Ferroelectr. Freq. Control 48, 341–354 2001. 11M. Tabei, T. D. Mast, and R. C. Waag, “A k-space method for coupled first-order acoustic propagation equations,” J. Acoust. Soc. Am. 111, 53–63 2002. 12N. N. Bojarski, “The k-space formulation of the scattering problem in the time domain,” J. Acoust. Soc. Am. 72, 570–884 1982. 13N. N. Bojarski, “The k-space formulation of the scattering problem in the time domain: An improved single propagator formulation,” J. Acoust. Soc. Am. 77, 826–831 1985. 14J. Lu, J. Pan, and B. Xu, “Time-domain calculation of acoustical wave2514 J. Acoust. Soc. Am., Vol. 121, No. 5, May 2007propagation in discontinuous media using acoustical wave propagator with mapped pseudospectral method,” J. Acoust. Soc. Am. 118, 3408–3419 2005. 15A. Dutt and V. Rokhlin, “Fast Fourier transform for nonequispaced data,” SIAM J. Sci. Comput. USA 14, 1368–1393 1993. 16N. Nguyen and Q. H. Liu, “The regular Fourier matrices and non-uniform fast Fourier transforms,” SIAM J. Sci. Comput. USA 21, 283–293 1999. 17Q. H. Liu, X. M. Xu, B. Tian, and Z. Q. Zhang, “Applications of non- uniform fast Fourier transform algorithms in numerical solutions of differ- ential and integral equations,” IEEE Trans. Geosci. Remote Sens. 38, 1551–1560 2000. 18D. Gottlieb, C. W. Shu, A. Solomonoff, and H. Vandeven, “On the Gibbs phenomenon. i. Recovering exponential accuracy from the Fourier partial sum of a nonperiodic analytic function,” J. Comput. Appl. Math. 43, 81–98 1992. 19S. A. Sarra, “Spectral methods with postprocessing for numerical hyper- bolic heat transfer,” Numer. Heat Transfer, Part A 43, 717–730 2003. 20J. P. Boyd, “Trouble with Gegenbauer reconstruction for defeating Gibbs’ phenomenon: Runge phenomenon in the diagonal limit of Gegenbauer polynomial approximations,” J. Comput. Phys. 204, 253–264 2005. 21X. M. Xu and Q. H. Liu, “Fast spectral method for acoustic scattering problems,” IEEE Trans. Ultrason. Ferroelectr. Freq. Control 48, 522–529 2001. 22P. Zwamborn and P. D. van den Berg, “The three-dimensional weak form of the conjugate gradient fft method for solving scattering problems,” IEEE Trans. Microwave Theory Tech. 40, 1757–1766 1992. 23G. X. Fan and Q. H. Liu, “The CGFFT method with a discontinuous FFT algorithm,” Microwave Opt. Technol. Lett. 29, 47–49 2001. 24G. Liu and S. D. Gedney, “High-order nystrom solution of the volume— efie for te-wave scattering,” Electromagnetics 21, 1–13 2001. 25A. Zhu and S. D. Gedney, “A quadrature-sampled pre-corrected FFT method for the electromagnetic scattering from inhomogeneous objects,” IEEE Antennas Wireless Propag. Lett. 2, 50–53 2003. 26E. M. Hyde and O. P. Bruno, “A fast, higher-order solver for scattering by penetrable bodies in three dimensions,” J. Comput. Phys. 202, 236–261 2005. 27D. Colton and R. Kress, Inverse Acoustic and Electromagnetic Scattering Theory, 2nd ed. Springer, Berlin, 1998. 28P. Werner, “Zur mathematischen theorie akustischer wellenfelder On the mathematical theory of acoustic wave fields,” Arch. Ration. Mech. Anal. 6, 231–260 1960. 29P. Werner, “Beugungsprobleme der mathematischen akustik Diffraction problems of mathematical acoustics,” Arch. Ration. Mech. Anal. 12, 155–184 1963. 30P. A. Martin, “Acoustic scattering by inhomogeneous obstacles,” SIAM J. Appl. Math. 64, 297–308 2003. 31O. P. Bruno and L. A. Kunyansky, “A fast, high-order algorithm for the solution of surface scattering problems: Basic implementation, tests and applications,” J. Comput. Phys. 169, 80–110 2001. 32L. B. Felsen and N. Markuvitz, Radiation and Scattering of Waves Prentice-Hall, New York, 1973. 33R. Kress, Linear Integral Equations Springer, Berlin, 1989. 34Y. Saad and M. H. Schultz, “Gmres: A generalized minimal residual algo- rithm for solving non-symmetric linear systems,” SIAM Soc. Ind. Appl. Math. J. Sci. Stat. Comput. 7, 856–869 1986. 35J. Lee, J. Zhang, and C. C. Lu, “Incomplete Lu preconditioning for large scale dense complex linear systems from electromagnetic wave scattering problems,” J. Comput. Phys. 185, 158–175 2003. 36E. M. Hyde and O. P. Bruno, “An efficient, preconditioned, high-order solver for scattering by two-dimensional inhomogeneous media,” J. Com- put. Phys. 200, 670–694 2004.A. Anand and F. Reitich: Thin structure acoustic scattering 