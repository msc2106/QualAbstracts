ABSTRACT: 
Many estimators and tests are of the form of a ratio of quadratic forms in normal variables. Excepting a few very special cases little is known about the density or distribution of these ratios, particularly if we allow for noncentrality in the quadratic forms. This paper assumes this generality and derives saddlepoint approximations for this class of statistics. We first derive and prove the existence of an exact inversion based on the joint characteristic function. Then the saddlepoint algorithm is applied and the leading term found, and analytic justification of the asymptotic nature of the approximation is given. As an illustration we consider the calculation of sizes and powers of F-tests, where a new exact result is found. 
 
PREDICTION: 
This paper assumes the generality and derives saddlepoint approximations for this class of statistics. We first derive and prove the existence of an exact inversion based on the joint characteristic function, and the leading term found, and analytic justification of the asymptotic nature of the approximation is given. A an illustration we consider the calculation of sizes and powers of F-tests, where a new exact result is found. 
 
FULL TEXT: 
 This is a repository copy of Saddlepoint approximations for noncentral quadratic forms. White Rose Research Online URL for this paper: http://eprints.whiterose.ac.uk/594/ Article: Marsh, P.W.N. (1998) Saddlepoint approximations for noncentral quadratic forms. Econometric Theory. pp. 539-559. ISSN 0266-4666 https://doi.org/10.1017/S0266466698145012 eprints@whiterose.ac.uk https://eprints.whiterose.ac.uk/ Reuse Items deposited in White Rose Research Online are protected by copyright, with all rights reserved unless indicated otherwise. They may be downloaded and/or printed for private study, or other acts as permitted by national copyright laws. The publisher or other rights holders may allow further reproduction and re-use of the full text version. This is indicated by the licence information on the White Rose Research Online record for the item. Takedown If you consider content in White Rose Research Online to be in breach of UK law, please notify us by emailing eprints@whiterose.ac.uk including the URL of the record and the reason for the withdrawal request. SADDLEPOINT APPROXIMATIONS FOR NONCENTRAL QUADRATIC FORMS PATRICK W.N. MARSH University of York Many estimators and tests are of the form of a ratio of quadratic forms in normal variables+ Excepting a few very special cases little is known about the density or distribution of these ratios, particularly if we allow for noncentrality in the qua- dratic forms+ This paper assumes this generality and derives saddlepoint approxi- mations for this class of statistics+We first derive and prove the existence of an exact inversion based on the joint characteristic function+ Then the saddlepoint algorithm is applied and the leading term found, and analytic justification of the asymptotic nature of the approximation is given+As an illustration we consider the calculation of sizes and powers of F-tests, where a new exact result is found+ 1. INTRODUCTION The problem of finding algorithms and explicit formulae for the moments, den- sity, and distributions, or approximations thereof, of a ratio of quadratic forms has been the subject of much attention historically+ The reason is simply that a sizable bulk of estimators and test statistics are of this form+ Just considering the linear regression model, a battery of specification and misspecification tests con- forms to this functional form+ To fix matters we will be interested in a class of statistics, q~v!, with q~v! 5 v 'A1v v 'A2v , (1.1) with v an N-dimensional random vector, and A1 and A2 N 3 N constant matrices+ In this paper we restrict attention to the class of statistics with v distributed N-dimensional normal, both for computational reasons and simply because it seems most natural, if we have to make some distributional assumption+We will not assume independence of the numerator and denominator, nor that v has zero I thank Grant Hillier for instructive supervision during my Ph+D+, from which this paper originates+ Thanks also to John Knight, Jan Podivinsky, Steve Satchell, Irene Valsecchi, participants at the 7th World Congress of the Econo- metric Society, at Keio University,Tokyo, and two anonymous referees for their comments+ Financial support in the form of ESRC awards R00429334128 and R000236627 is gratefully acknowledged+ Address correspondence to: Patrick Marsh, Department of Mathematics, University of York, Heslington, York, YO1 5DD, United Kingdom; e-mail: pwnm1@york+ac+uk+ Econometric Theory, 14, 1998, 539–559+ Printed in the United States of America+ © 1998 Cambridge University Press 0266-4666098 $9+50 539 mean+ The latter may be interpreted as an opportunity to study properties of tests under both the null and the alternative+ In this paper, for such a class of statistics, we will derive saddlepoint approx- imations for the densities and distributions+ Tractable algorithms are presented, and we are able to test both the applicability and accuracy of the approximation by considering size and power calculations for F-tests in the linear regression model+ The method is to apply the saddlepoint technique for approximating in- tegrals ~e+g+, see Bleistein and Handelsman, 1975; De Bruijn, 1961! to obtain an approximation for the density and distribution of q~v!+ In a statistical context the technique was first exploited by Daniels ~1954! and ~1956! to obtain approxima- tions for the density of sums of independent variables and for the correlation coefficient+ For a full account of the application of the technique, Jensen ~1995! contains many results, applications, and a full survey of the literature+ Recently,Lieberman ~1994a, 1994b, 1997! has considered saddlepoint-type ap- proximations for statistics similar to q~v!+ In Lieberman ~1994a!, approximate moments were found for v having some unspecified distribution, while in Lie- berman ~1994b!, approximations for the density and distribution were found, with v standard normal+ Robustness of such approximations was investigated in Lieberman ~1997! by allowing v to have some arbitrary, but well-specified, cu- mulant structure+ The approaches there and here are subtly different+ Here we begin with the joint characteristic function, rather than the moment generating function ~m+g+f+!, and obtain, by suitable deformation of the parameter and con- tour of integration, an inversion dual to that of Geary ~1944!+ We do so only because the implicit assumption of the existence of the joint m+g+f+ seems unrea- sonable, particularly because we are interested in a class of statistics where often it will not ~see, e+g+, Johnson, Kotz, and Balakrishnan 1995!+ However, as will become clear later, on application of the saddlepoint technique, the two ap- proaches are essentially identical+ This observation becomes apparent because of the approach taken here+ Even restricting attention to normality, only in the most special cases are the exact densities and distributions known, i+e+, when A1 and A2 are symmetric and idempotent ~leading to standard, noncentral, and doubly noncentral F-statistics!+ For instance consider estimates of autoregressive parameters, with or without exogenous regressors, corresponding to the central or noncentral cases+ For these statistics we invariably rely upon approximation techniques, such as here, nu- merical methods such as Imhof’s ~1961! procedure, or tedious Monte Carlo stud- ies+ For a much fuller account of the properties of statistics of the form given in ~1+1!, for instance for special cases or alternative approximations in more general cases, see Johnson et al+ ~1995!, for example, Chapters 27 through 32 and refer- ences therein+ In the context of the linear model, Koerts and Abrahamse ~1969! investigated the distribution of ratios of such quadratic forms+ The plan for the remainder of the paper is as follows+ Section 2+1 derives an appropriate inversion for the density based on the characteristic function, and 2+2 applies the properties of the statistic q~v! to obtain an exact inversion for the 540 PATRICK W.N. MARSH density, for which we are able to prove existence+ Section 3+1 gives the applica- tion of the saddlepoint algorithm, and in particular the leading term approxima- tion+We then derive some limited analytic properties of the asymptotic nature of the approximation in 3+2+ Sections 4+1 and 4+2 derive analogous results for the distribution of the statistic+ Section 5 then applies the approximations to the cal- culation of sizes and powers of F-tests and demonstrates that approximate size calculations are in fact exact, whereas those for the powers are of high accuracy+ Concluding remarks are contained in Section 6, and the Appendixes contain some technical derivations+ 2. INVERSION FORMULA FOR THE DENSITY 2.1. Preliminaries As we have noted, because the quadratic forms in ~1+1! are noncentral and pos- sibly dependent, and further because we do not assume the existence of the joint m+g+f+, Geary’s ~1944! inversion formula is not directly applicable+ Instead we derive a dual inversion, based on the joint characteristic function+ This inver- sion is seen to be of the form of those given by Gurland ~1948!+We define our statistic as q~v! 5 v 'A1v v 'A2v 5 b1 b2 and the joint characteristic function of b1 and b2 as x~u1,u2!, and we formally make the following assumption+ Assumption 1+ ~i! v; N~m, IN !+ ~ii! A1 and A2 are symmetric and A2 is positive definite+ ~iii! The function x~u1,u2! exists and is convergent in a strip of positive width around the imaginary axes, i+e+, x~t1 1 iv1,t2 1 iv2! , `, for some t1,t2 [ R1+ Arising from Assumption 1 we note the following+ First, that v has an identity covariance matrix is not restrictive, because we can always define a v *5S2102v, if v; N~m,S!+ Second, because A2 is positive definite then Pr~b2 # 0!5 Pr~v 'A2v# 0!5 0, by continuity of densities+ Finally part ~iii! assumes that x~{,{! remains conver- gent after deformation in the real direction of the complex plane+Under Assump- tion 1, and denoting the density of q~v! at a point q as g~q!,we have the following lemma+ SADDLEPOINT APPROXIMATIONS 541 LEMMA 1+ The exact density of q~v! is obtained by the inversion g~q! 5 1 2pi E t2i` t1i` ]x~u1,u2! ]u2 * u252qu1 du1, (2.1) for some t# t1 of Assumption 1+ Proof+ Lemma 1 follows from a similar result found in Daniels ~1956!, based on the joint m+g+f+ n In the following subsection we will apply inversion ~2+1! to the form of statis- tics given in ~1+1!+ The aim is to write the inversion entirely in functions of the fundamental properties of q~v!, that is, the matrices A1 and A2 and the noncen- trality parameter m+ 2.2. The Inversion Formula Notice that in ~2+1! the function x~{,{! is no longer the characteristic function itself, but a deformation in the real direction of the complex planes of u1 and u2+ More generally ~2+1! is the complex Laplace transform of the joint density of b1 and b2+ LEMMA 2+ The Laplace transform x~u1,u2!, under Assumption 1, is given by x~u1,u2! 5 exp $2l%exp Hm 'D21m2 J 6D 62102, (2.2) where l5m 'm02 and D 5 @IN 2 2u1 A1 2 2u2 A2# + Proof+ Derivation of Lemma 2 follows fromAbadir and Larsson ~1996!,Theo- rem 2+1, and existence for u1 and u2 complex is guaranteed by Ingham ~1933!, whereas for u1 and u2 real we also require that D is positive definite+ As a note, Assumption 1~iii! is automatically satisfied when u1 and u2 are complex+ n Proceeding, we utilize the joint characteristic function to obtain an exact in- version for all statistics given by ~1+1! and Assumption 1+What we require is the derivative of ~2+2!with respect to u2 and then evaluate at the set of points ~u1,2qu1!+ Finally we check for existence of the resulting inversion, on substitution into ~2+1!+ Thus we have the following result+ THEOREM 1+ ~i! The exact density of q~v! at q is g~q! 5 exp $2l% 2pi 3 E t2i` t1i` expHm 'G21m2 J 6G 62102 @Tr@G21A2#1m '~G21A2 G21 !m# du1, (2.3) with G 5 IN 2 2u1F and F 5 @A1 2 qA2# + 542 PATRICK W.N. MARSH ~ii! Inversion ~2+3! exists and is continuous everywhere over u1+ Proof+ Part ~i! is derived by evaluating the derivative of x~u1,u2! with respect to u2 at u2 5 2qu1+ For part ~ii!, supposing u1 complex, we make the following points ~again the argument follows that of Ingham, 1933!+ ~i! Because F is real and symmetric its eigenvalues are real, and so the eigenvalues of G are continuous in u1+ Hence 6G 6 is continuous in u1+ ~ii! Also, because limu1r0 6G 6 is bounded away from zero and by the continuity, above, 6G 6 is never 0+ ~iii! As a consequence of ~ii! we ensure the existence of both 6G 62102 and G21+ Further because all other terms are constants, for a given statistic, then inversion ~2+3! exists for all u1 and q as defined in Assumption 1+ n Because a convergent series representation of the density is as yet unobtain- able, in the proceeding section we demonstrate the applicability of a leading term saddlepoint approximation+ 3. SADDLEPOINT APPROXIMATIONS 3.1. The Leading Term In this section we outline how inversion formula ~2+3! is of a form for which a saddlepoint approximation is easily obtainable+ In particular, through an appro- priate expansion of the kernel and subsequent transformation, the method of La- place ~see Barndorff-Nielsen and Cox, 1989, Ch+ 3; De Bruijn, 1961, Ch+ 4! delivers a leading term saddlepoint approximation, relatively tractable in form+ We can rewrite ~2+3! so that g~q! 5 exp $2l% 2pi E t2i` t1i` exp $P~u1!%Q~u1! du1, (3.1) where we have defined P~u1! 5 P~t,v1!5 2 1 2~Tr@G21S#2 ln6G 6! and Q~u1! 5 P~t,v1!5 Tr@G21A2~G21S 1 I !# , where above S5mm ' is a positive semidefinite matrix, possibly zero only through m5 0, with G and A2 defined before, and noting u1 5 t1 iv1+ Inversion ~3+1! is of the form considered by De Bruijn ~1961,Ch+ 4!, and hence the leading term saddlepoint approximation is simply [g~q! 5 exp $2l%exp $P~ [t!%Q~ [t! %2p6P ''~ [t!6 , (3.2) SADDLEPOINT APPROXIMATIONS 543 where P~ [t!5 P~ [t,0! and Q~ [t!5 Q~ [t,0! and the saddlepoint [t is defined by P '~ [t! 5 P~t,v1!6t5 [t,v150 5 0+ (3.3) In summary, we have basically transformed the integration problem, equation ~3+1!, into the optimization problem ~3+3!+ Strictly speaking, the saddlepoint de- fined by ~3+3! is a saddlepoint only of P and consequently exp $P %, not the kernel itself as in Daniels ~1954, 1987!+ However, the technique suffices in this case because the exponent dominates the remaining term in ~3+1!+ We can apply approximation ~3+2! to our inversion formula ~2+3!, noting that P '~t! 5 Tr@G21F~G21S 1 I !# and P ''~t! 5 2 Tr@~G21F!2~2G21S 1 I !# + (3.4) Denoting ZG as G evaluated at the point u1 5 [t, then the leading term saddlepoint approximation to the density of a ratio of dependent, noncentral quadratic forms is [g~q! 5 exp $2l%etr$ ZG21S %Tr@ ZG21A2~ ZG 21A2~ ZG 21S 1 I !# 6 ZG 6% 4p6Tr@~ ZG21F!2~2 ZG21S 1 I !#6 , (3.5) and the saddlepoint [t is defined by Tr~G21F~G21S 1 I !! 5 0+ (3.6) Unfortunately, for computational purposes ~3+6! is of little use, because sym- bolic matrices are computationally expensive to invert, however, in Appendix A, we demonstrate that the function P~u1! may be written as P~u1! 5 1 2 F(i51 N ~ui ! 2~1 2 2u1 fi ! 21 2( i51 N ln~1 2 2u1 fi !G, (3.7) where the fi are the ordered eigenvalues of F, the ui are the elements of the vector u 5 Rm, and R diagonalizes G+ Differentiating ~3+7! directly then gives P '~u1! 5 F( i51 N ~ui ! 2~1 2 2u1 fi ! 22 fi 1( i51 N ~1 2 2u1 fi ! 21 fiG , (3.8) whose roots can be found by most numerical packages+ In particular, there are N 21 solutions to ~3+8!, each lying between the asymptotes ~2fi!21+ Because Ig~q! is real only for [t [ ~~2 max i ~ fi !! 21, ~2 min i ~ fi !! 21 !, (3.9) ~see Daniels, 1954!, the saddlepoint is found by employing a line search in ~3+8!, constrained to this region+ It has been found in applications of ~3+5! that the roots 544 PATRICK W.N. MARSH of ~3+8! tend to be more numerically stable than those obtained from ~3+6!, hence the suggested use of this form+ Calculations in this paper were performed with Mathematicay ~see Wolfram, 1991!; for other packages, the roots of ~3+6! may turn out to be more stable+ As a note, because the saddlepoint is constrained to the region defined in ~3+9!, then obviously ZG21 exists+ Hence for the set of points q and u1~q!5 [t, inversion ~2+3! exists, independently of the argument of Theorem 1+As a consequence, as far as the saddlepoint technique is concerned, the joint m+g+f+ approach will also yield a valid approximation+ Given approximation ~3+5!, one pertinent question is, to what extent is it a higher-order asymptotic expansion? We address this issue next+ 3.2. Asymptotic Nature in the Tails Here we consider the issue of examining the asymptotic nature of the approxi- mation+We note immediately that the form of approximation ~3+5! differs from those given in Daniels ~1954, 1956!+ There, the function we define as P~u1! is obviously O~N !, and hence the asymptotic nature of those series was simple, i+e+, in powers of N21+ In our case P~u1! and Q~u1! depend more subtly with N, and to obtain analytic results we examine only the far tails of the distribution+We note that for extreme values of q the numerical value of the exact density is zero; our aim here is to determine the rate of convergence in N, of the approximation to this value+ First we demonstrate the limiting relation between q and [t ~i+e+, between the evaluation point and the saddlepoint!, which we present as the following lemma+ LEMMA 3+ For mÞ 0 and 6q 6 sufficiently large, there exists the unique sad- dlepoint, not necessarily finite, given by [t~q! 5 Tr@~S 1 I !F# 2 Tr@F 2 # , (3.10) where the dependence of [t ~the saddlepoint! upon q ~the point at which the approximation is evaluated ! is made explicit in the limit+ Proof+ The proof of Lemma 3 is given in Appendix B+ Utilizing the previous lemma, we are able to examine asymptotic behavior of the approximations in the very far tails of the distribution+Upon full expansion of ~3+1! and ignoring constants, a typical term is hj,m~ [t! 5 F Q ~ j !~ [t!Q~ [t!$P ''~ [t!% j02 GF(k53 ` P ~k!~ [t! $P ''~ [t!% k02 Gm, (3.11) j,m 5 0,1,2, + + + , SADDLEPOINT APPROXIMATIONS 545 where Q ~ j !~ [t!~P ~k!~ [t!! is the jth ~kth! derivative of Q~P ! at u1 5 [t+ Further, we can show that Q ~ j !~ [t! } Tr@~ ZG21F! j ZG21A2~ j ZG 21S 1 I !# , P ~k!~ [t! } Tr@~ ZG21F!k~k ZG21S 1 I !# , (3.12) verified by differentiation and thence by induction from the j, k 5 1 case+ In Appendix C we demonstrate that 6q 6r `, lim 6q 6r` Q ~ j !~ [t~q!! 5 O~N ! P ~k!~ [t~q!!5 O~N ! J ∀ j, k, (3.13) and consequently we have hj,m~ [t~q!! } 1 N j02 F 1N k0221 Gm+ (3.14) Because odd powers disappear upon integration the leading term has order of error O~N21!, the leading term plus first correction O~N22!, and so on+ Having derived the leading term for the density we now turn our attention to the distribution function of q~v!+ 4. APPROXIMATING THE DISTRIBUTION 4.1. An Inversion Here we consider the problem of finding an approximation for the distribution function of q~v!, i+e+, G~q!5 Pr$q~v! # q%, or if q~v! is in particular some test statistic, the tail area probability, Pr$q~v!. q%512G~q!+We can proceed in two possible ways+ First, we could simply numerically integrate approximation ~3+2! over the relevant range+Alternatively,we can seek to provide an analytic solution to this problem, i+e+, find an approximation for the distribution analogous to that found for the density+ Clearly there are benefits to finding an analytic rather than a numeric approximation, particularly if the accuracy of the approximation re- mains good, for instance, if q~v! is a test statistic then finding critical values will prove far simpler in this case+ To begin we require an inversion for the distribution; the following lemma, simply derived from Lemma 1, gives the result+ LEMMA 4+ Under the conditions of Assumption 1, and denoting the distribu- tion of q~v! as G~q!, then G~q! 5 1 2 exp $2l% 2pi E t2i` t1i` exp $P~u1!% u1 du1+ (4.1) 546 PATRICK W.N. MARSH Because inversion ~4+1! is essentially similar in nature to the inversion formula for the density, equation ~3+1!, but with Q~u1! replaced by u121 , then an attempt to apply the saddlepoint technique to approximate it seems natural+ 4.2. Saddlepoint Approximation for the Distribution Simple application of the saddlepoint method, for inversion ~4+1!, breaks down because the range of integration will pass through both a pole ~at u1 5 0! and a saddlepoint ~at u1 5 [t!+ To obtain an approximation reliable over the entire range we show here that the integral in ~4+1! may be transformed to a form that yields the Lugannani and Rice ~1980! approximation+Again we consider only the inte- gral in ~4+1!, defined as Iq 5 1 2pi E t2i` t1i` exp $P~u1!% u1 du1 (4.2) such that G~q! 5 1 2 exp $2l%Iq + Following Daniels ~1987!, the saddlepoint approximation to ~4+2!, on isolation of the pole, is the Lugannani and Rice formula: Îq 5 1 2F~ [p!1 f~ [p!F 1[r 2 1[pG+ (4.3) Here, f~{! and F~{! are the standard normal density and distribution func- tions, respectively, [p and [r are real and defined by [p 5 sign~ [t!% 26P~ [t!6 and [r 5 [t% 26P ''~ [t!6 (4.4) and once again [t defined by the relevant root of ~3+8!+Alternatively, Jensen ~1995, Ch+ 3!, suggested the alternative form Îq 5 FS2 [p 1 1[p logF [p[r GD for the saddlepoint approximation for ~4+2!+ If we return to our statistic q~v!, noting expressions found for P~ [t! and P ''~ [t! previously and substituting into [p and [r gives us that the saddlepoint approxima- tion for the distribution function of q~v! is given by ZG~q! 5 ~1 2 e2l !1 e2lSF~ [p!2 f~ [p!F 1[r 2 1[pGD (4.5a) SADDLEPOINT APPROXIMATIONS 547 ~Daniels, 1987! and ZG~q! 5 ~1 2 e2l !1 e2lFS [p 2 1[p logF [p[r GD (4.5b) ~Jensen, 1995!, with [p and [r given by [p 5 sign~ [t!%6Tr@ ZG21S#2 ln6 ZG 66, [r 5 2 [t%6Tr@~ ZG21F!2~2 ZG21S 1 I !#6, and l is defined previously+As a note, the approximations in ~4+5! may be inter- preted as an exponential mixture of Dirac ~unit point mass on the first term! and normal distributions, where the mixture depends only upon the noncentrality parameter l, not upon the matrices A1 and A2, whose role is limited to the argu- ment of the normal+1 In ~3+7! and ~4+5! we have leading term saddlepoint approximations for the density and distribution of q~v!, under Assumption 1+ In the following section we will apply these results to the calculation of sizes and powers of F-tests in a linear regression+ 5. THE SIZE AND POWER OF F -TESTS Take the linear regression model, defined by Y 5 Xb1 «, where «;N~0,s2I !, with Y 5 $ y1, y2, + + + , yN %, X is an N 3 k matrix of regressors of full rank and b is a k 3 1 vector of coefficients, and consider the problem of testing the simple null hypothesis: H0: b 5 0 against H1: b5 b*+ Because in general there exists no uniformly most powerful test for this problem, the F-test, which maximizes average power, is most often employed+ The test statistic, in our notation, has the form F 5 N 2 k k q~Y !, q~Y ! 5 Y 'PX Y Y 'MX Y 5 q1 q2 , where PX 5 X~X 'X !21X ' and MX 5 I 2 PX +We may also note that q~Y ! may be interpreted as the likelihood ratio test, for this hypothesis+ We utilize the results of the previous sections to calculate approximations for the density and distribution of q~v! under both the null ~the central case! and alternative ~the noncentral case!+ We then compare the approximation for the 548 PATRICK W.N. MARSH power of the F-test with the exact result to indicate the numerical accuracy of the approximation+ 5.1. The Null Hypothesis Under the null hypothesis q~v! is a ratio of independent central quadratic forms ~i+e+, m5 Xb5 0!+ The Laplace transform, yielding the joint characteristic func- tion and m+g+f+, is given by equation ~2+1! with m5 0: x~u1,u2! 5 6I 2 2u1 PX 2 2u2 MX62102, and noting MX 5 I 2 PX , where PX is idempotent, then we obtain the well-known result x~u1,u2! 5 ~1 2 2u1!2k02~1 2 2u2!2~N2k!02+ (5.1) To calculate the appropriate inversion formula, we may either directly differen- tiate ~5+1! or the more general ~2+2!; the latter yields ]x~u1,u2! ]u2 * u252qu1 5 6aI 1 bPX 62102 Tr@~aI 1 bPX !21MX # , (5.2) where a 5 ~11 2qu1! and b 5 22u1~11 q!+ After some manipulation we find the inversion formula for q~v! under the null is g~q! 5 ~N 2 k! 2pi E t2i` t1i` ~1 2 2u1! 2k02~1 1 2qu1! 2~N2k!0221 du1+ (5.3) In the notation of this paper we write the inversion formula in terms of the func- tions P and Q, as before, where for this example P~u1! 5 2 2 1 2ln@6aI 1 bPX 6# and Q~u1!5 Tr@~aI 1 bPX !21MX # , and so application of ~3+2! is relatively straightforward, and in particular the relevant derivatives of P are P '~u1! 5 Tr@~aI 1 bPX ! 21~PX 2 qMX !#5 k ~1 2 2u1! 2 q~N 2 k! ~1 1 2qu1! , P ''~u1! 5 2 Tr@~~aI 1 bPX ! 21~PX 2 qMX !! 2 # 5 2S k~1 2 2u1!2 2 q 2~N 2 k! ~1 1 2qu1! 2D+ (5.4) The saddlepoint for this example is defined by P '~u1! 5 0, which yields the unique saddlepoint [t 5 q~N 2 k!2 k 2qN + (5.5) SADDLEPOINT APPROXIMATIONS 549 Substitution of the saddlepoint into P and Q of equation ~5+4! and some manip- ulation give us the leading term saddlepoint approximation for q~v! under the null as [g~q! 5 k2~k11!02~N 2 k!2~N2k11!02~1 1 q!2N02q2~k12!02 2!pN ~N11!02 + (5.6) Moreover, as a direct consequence of approximation ~5+6! we obtain the follow- ing result+ Result+ The leading term saddlepoint approximation for q~v! under the null is exact, up to a normalizing constant+ If we write the approximation as [g~q! 5 a~k,N !~1 1 q!2N02q2~k12!02, with a~k,N ! a constant, then renormalizing in the sense of Daniels ~1954! gives the exact density, because E q ~1 1 q!2N02q2~k12!02 dq 5 BS k2 , N 2 k2 D, the beta function+ This adds to the list of cases for which the saddlepoint tech- nique yields exact distributional results ~see Daniels, 1980!, although the result here is different in nature, because the statistic is not a sum of independent and identically distributed ~i+i+d+! variables+ n Now because the saddlepoint technique yields an exact density for q~v! under the null, then the simple transformation to the central F-statistic will yield exact densities+Consequently,we do not require the approximation for the distribution, because integration of ~5+6! is straightforward+ 5.2. The Alternative Hypothesis Under the alternative, b5 b*, q~v! is a ratio of a noncentral and a central qua- dratic form, again independent+Again we utilize equation ~2+1!+ In our example this becomes x~u1,u2! 5 e2l exp H b*'X '~I 2 2u1 PX 2 2u2 MX !21Xb*2 J 3 6I 2 2u1 PX 2 2u2 MX 62102+ (5.7) Proceeding as in the central case we find 6I 2 2u1 PX 2 2u2 MX 62102 5 ~1 2 2u1!2k02~1 2 2u2!2~N2k!02, ~I 2 2u1 PX 2 2u2 MX ! 21 5 1 ~1 2 2u2! SI 1 2~u1 2 u2!1 2 2u2 PXD , 550 PATRICK W.N. MARSH which gives us the well-known result x~u1,u2! 5 exp H 2lu11 2 2u1J~1 2 2u1!2k02~1 2 2u2!2~N2k!02+ (5.8) The relevant inversion formula under the alternative can be obtained again by directly differentiating ~5+8!, or equation ~2+2!, yielding ]x~u1,u2! ]u2 * u252qu1 5 ~N 2 k! exp H lu1~1 2 2u1!J~1 2 2u1!2~N2k!02~1 1 2qu2!2k0221, (5.9) which we simply substitute into the inversion+ After further manipulation we have the saddlepoint approximation for the density of q~v!, in the noncentral case, as [g~q! 5 ~N 2 k! exp H l [t1 2 2 [tJ~1 1 2q [t!2~N2k!0221~1 2 2 [t!2k02 !4p* 2l~1 2 2 [t!3 1 k ~1 2 2 [t!2 * , (5.10) with the saddlepoint defined by substitution into ~3+8!+ For the alternative the approximation is no longer exact, and an approximation for the distribution ~and hence powers! follows from substitution into equation ~4+5a!+We shall not report the detail here+ Because the application of the approximations has proved relatively straight- forward, if somewhat messy in the noncentral case, for the remainder of this example we will concentrate upon a comparison of their accuracy with “exact” results+ First we report tables comparing approximate versus exact tail area prob- abilities for the noncentral F distribution with k 51, N 510 or 20, and l51 or 2+ Tables 1 and 2 give tail area probabilities for two noncentral F-statistics, i+e+, the F-test under the alternative, corresponding to the linear regression with a single regressor, and sample sizes 10 and 20+Table 1 assumes the alternative is such that b*'X 'Xb*5 1, whereas Table 2 assumes an alternative such that b*'X 'Xb*5 2+ The accuracy of the approximation for these tail area probabilities is exceedingly good, always within 5% or so, even at a sample size of 10, although we can see a slight, but noticeable, improvement as the sample size increases to 20, giving some further justification to the asymptotic nature of the approximation+ In fact this approximation clearly outperforms the limiting approximation, i+e+, F~k,N2k,2l! ' r x '2~k,2l! as Nr `, even though this limiting distribution is itself little simpler than the exact, al- though details of this are not given+ SADDLEPOINT APPROXIMATIONS 551 Tables 3 and 4 tabulate power functions for testing the simple hypothesis men- tioned previously, at the 5% significance level+ The values given in the table are the tail area probabilities from the critical values given by fixing the size of the test at 5% and varying the alternative b*, such that l* takes the values given+ These critical values are given by Table 3: k 5 1; N 5 10: F~1,9!+05 5 5+12; N 5 20: F~1,19!+05 5 4+38, Table 4: k 5 3; N 5 10: F~3,9!+05 5 3+86; N 5 20: F~3,19!+05 5 3+13+ Table 1. Noncentrality parameter, l5 0+5 Pr$F~1,9,1! . q*% Pr$F~1,19,1! . q*% q* Exact Approximation Exact Approximation 5 0+129275 0+134001 0+150660 0+144903 5+5 0+110217 0+113113 0+131793 0+124794 6 0+094202 0+095699 0+115736 0+107909 6+5 0+080707 0+081152 0+102004 0+093669 7 0+069303 0+068974 0+090209 0+081610 7+5 0+059643 0+058757 0+080035 0+071355 8 0+051440 0+050166 0+071226 0+062599 8+5 0+044457 0+042926 0+063570 0+055095 9 0+038500 0+036810 0+056894 0+048640 9+5 0+033408 0+031633 0+051053 0+043067 Table 2. Noncentrality parameter, l5 1 Pr$F~1,9,2! . q*% Pr$F~1,19,2! . q*% q* Exact Approximation Exact Approximation 5 0+228381 0+234579 0+251153 0+242923 5+5 0+200162 0+204274 0+224330 0+214261 6 0+175571 0+177930 0+200815 0+189371 6+5 0+154137 0+155062 0+180156 0+167733 7 0+135448 0+135225 0+161966 0+148891 7+5 0+119142 0+118022 0+145917 0+132456 8 0+104907 0+103103 0+131725 0+118092 8+5 0+092472 0+090161 0+119149 0+105512 9 0+081599 0+078928 0+107981 0+094472 9+5 0+072085 0+069172 0+098044 0+084762 552 PATRICK W.N. MARSH Again we notice the high accuracy of the approximation; the approximation always lies within 5% of the exact over the range considered here, and there is slight improvement asymptotically+ 6. CONCLUDING REMARKS The paper has established the existence of inversion formulae for the density and distribution of a ratio of noncentral quadratic forms in normal variables+ The saddlepoint approximation to these inversions has been found, and we have il- Table 3. Number of regressors, k 5 1 Power ~N 5 10! Power ~N 5 20! 2l* Exact Approximation Exact Approximation 0+1 0+068609 0+069257 0+070964 0+081296 0+3 0+106821 0+103103 0+114035 0+122003 0+5 0+145846 0+139860 0+158127 0+166110 0+7 0+185269 0+177861 0+202660 0+211083 0+9 0+224735 0+216413 0+247140 0+256088 1+1 0+263939 0+255083 0+291155 0+300547 1+3 0+302622 0+293525 0+334361 0+344027 1+5 0+340569 0+331458 0+376478 0+386202 1+7 0+377603 0+368655 0+417285 0+426837 1+9 0+413578 0+404936 0+456609 0+465763 Table 4. Number of regressors, k 5 3 Power ~N 5 10! Power ~N 5 20! 2l* Exact Approximation Exact Approximation 0+1 0+058138 0+053187 0+059683 0+068165 0+3 0+075032 0+065629 0+080503 0+085004 0+5 0+092868 0+080508 0+102770 0+105736 0+7 0+111534 0+096708 0+126289 0+128370 0+9 0+130924 0+113917 0+150867 0+152354 1+1 0+150936 0+131967 0+176321 0+177379 1+3 0+171471 0+150734 0+202472 0+203210 1+5 0+192434 0+170111 0+229155 0+229646 1+7 0+213738 0+190003 0+256211 0+256508 1+9 0+235298 0+210320 0+283493 0+283632 SADDLEPOINT APPROXIMATIONS 553 lustrated the procedure with a simple example+ Using a joint characteristic function–based approach, not only do we establish the existence of exact inver- sions to which the technique may be applied, but we also demonstrate that by defining the saddlepoint suitably, the approximations can equally be obtained via an inversion of the joint m+g+f+ We have also considered the application of the approximations to the simplest cases, the central and noncentral F-statistics+ In particular we obtain a further example of where the technique delivers an exact result, the central case, and demonstrate the accuracy of the approximation in the noncentral case+Other pos- sible applications for the results obtained here are numerous+ As examples we could consider tests for an autoregressive parameter in the linear regression, based on its ordinary least squares ~OLS! estimate, or for likelihood ~variance! ratio tests for non-nested models+ In both cases the exact densities are unknown, but the statistics conform to our statistic and assumptions+ However, the issues in- volved in such applications quickly become computational in nature, i+e+, the issue of finding a solution to the saddlepoint defining equation+ For these cases an approximate, rather than exact, saddlepoint may prove more useful+ Whereas explicit analytic results for the asymptotic nature of the approxima- tion are difficult to obtain, we have given some justification to the claim of a higher-order asymptotic expansion, although only in the far tails+ However, per- haps a more relevant criterion is that the approximations seem competitive with exact results and also significantly improve upon the first-order result+ NOTE 1+ Thanks are due to an anonymous referee for this interpretation+ REFERENCES Abadir, K+M+ & R+ Larsson ~1996! The joint moment generating function of quadratic forms in multivariate autoregressive series+ Econometric Theory 12, 682–704+ Barndorff-Nielsen, O+E+ & D+R+ Cox ~1989! Asymptotic Techniques for Use in Statistics. London: Chapman and Hall Ltd+ Bleistein,N+& N+Handelsman ~1975! Asymptotic Expansions of Integrals. New York:Holt,Reinhart and Winston+ De Bruijn, N+G+ ~1961! Asymptotic Methods in Analysis. Amsterdam: North-Holland+ Daniels, H+E+ ~1954! Saddlepoint approximations in statistics+ Annals of Mathematics and Statistics 25, 631–650+ Daniels,H+E+ ~1956!The approximate distribution of the serial correlation coefficient+Biometrika 43, 169–185+ Daniels, H+E+ ~1980! Exact saddlepoint approximations+ Biometrika 67, 53–58+ Daniels, H+E+ ~1987! Tail probability approximations+ International Statistical Review 55, 37–48+ Geary, R+C+ ~1944! Extension of a theorem by Harold Cramer on the frequency distribution of two variables+ Journal of the Royal Statistical Society, Series B 107, 65–67+ Gurland, J+ ~1948! Inversion formula for the distribution of ratios+ Annals of Mathematical Statistics 19, 228–237+ Imhof, J+P+ ~1961! Computing the distribution of quadratic forms in normal variables+ Biometrika 48, 419–426+ 554 PATRICK W.N. MARSH Ingham, A+E+ ~1933! An integral which appears in statistics+ Proceedings of the Cambridge Philo- sophical Society 29, 271–276+ Jensen, J+L+ ~1995! Saddlepoint Approximations. Oxford Statistical Science Series 16+ Oxford: Clar- endon Press+ Johnson, N+, N+L+ Kotz, & N+ Balakrishnan ~1995! Continuous Univariate Distributions, vol+ 2, 2nd ed+ New York:Wiley+ Koerts, J+ & A+P+J+ Abrahamse ~1969! The Theory and Application of the General Linear Model. Rotterdam: University Press+ Lieberman, O+ ~1994a! A Laplace approximation to the moments of a ratio of quadratic forms+ Biometrika 81, 681–690+ Lieberman,O+ ~1994b! Saddlepoint approximations to the distribution of a ratio of quadratic forms in normal variables+ Journal of the American Statistical Association 89, 924–928+ Lieberman, O+ ~1997! On the effect of non-normality+ Econometric Theory 13, 52–78+ Lugannani, R+ & S+ Rice ~1980! Saddlepoint approximations for the distribution of the sum of inde- pendent random variables+ Advances in Applied Probability 12, 475–490+ Magnus, J+R+& H+Neudecker ~1988!Matrix Differential Calculus with Applications in Statistics and Econometrics. Wiley Series in Probability and Statistics+ New York:Wiley+ Wolfram, S+ ~1991!Mathematica: A System for Doing Mathematics by Computer, 2nd ed+New York: Addison-Wesley+ APPENDIX A: ON THE SADDLEPOINT DEFINING EQUATION Returning to equation ~3+8!, we first note that the trace in P~u1! is equal to the quadratic form w~u1! 5 m '~I 2 2u1F! 21m+ (A.1) Now let R be the N 3 N diagonalizing matrix such that RG21R ' 5 D~g2!, where D~g2! is the N 3 N diagonal matrix with structure D~g2! 5 1 g1 2 0 + 0 0 g2 2 : : + : 0 + + gN2 2 and the gi 2 are the N ordered eigenvalues of G21 such that g1 2 . g2 2 . {{{ . gN 2 + Consequently, the quadratic form w~u1! may be expressed in canonical form as w~u1! 5 ( i51 N ~ui ! 2gi 2 + (A.2) SADDLEPOINT APPROXIMATIONS 555 Further, because we have that G and hence G21 are of full rank then gi2 Þ 0 ∀ i+ So defining a series $gi% the eigenvalues of G with gi 2 5 ~gi!21 and the gi 2 preserve their order+ Thus we have the simpler form w~u1! 5 ( i51 N ~ui ! 2~gi ! 21+ From the definition G 5 ~I 2 2u1F!, the eigenvalues of G are gi 5 ~1 2 2u1 fi !, where the fi are the N eigenvalues of F, and so we can write w~u1! in terms only of the parameter u1 and the eigenvalues of the known matrix, F 5 A1 2 qA2, i+e+, w~u1! 5 ( i51 N ~ui ! 2~1 2 2u1 fi ! 21+ (A.3) Now if we return to the remaining term in the definition of P~u1!, i+e+, ln6G 6, the well- known result gives us ln6G 6 5 ln6I 2 2u1F 65( i51 N ln~1 2 2u1 fi !, (A.4) where the fi are the eigenvalues defined and ordered as previously+ So in light of ~A+4! and ~A+2! we can write P~u1! 5 1 2 F(i51 N ~ui ! 2~1 2 2u1 fi ! 21 2( i51 N ln~1 2 2u1 fi !G (A.5) and hence is a function entirely of the eigenvalues of the known constant matrix F and the argument of the inversion formula+ n APPENDIX B: PROOF OF LEMMA 3 Recall the saddlepoint defining equation: Tr@G21F~G21S 1 I !# 5 0, (B.1) and F and G defined previously+ If 6q 6 is sufficiently large then either F positive definite; q , 0, F negative definite; q . 0+ 556 PATRICK W.N. MARSH We take q . 0 and note that the opposite case follows similarly+ Because F is negative definite, write 2F 5 BB ', with B;N 3 m, of rank m # N+ Hence G 5 I 1 2u1 BB ', and so Tr@G21BB '~G21S 1 I !# 5 0, or alternatively Tr@B 'G2102~G2102SG2102 1 I !G2102B# 5 0+ (B.2) Because mÞ 0, S . 0 and ~G2102SG2102 1 I !. 0, so ~B+1! holds for all [t and hence ZG that satisfy ~ ZG2102S ZG2102 1 I ! ZG2102B 5 0+ (B.3) ~B+3! follows because, for W . 0, Tr$X 'WX # 5 0m WX 5 0, as in Magnus and Neudecker ~1988, Sect+ 12, p+ 367!+We have shown ZG2102 exists, and so ~B+3! implies ~S ZG21 1 I !B 5 0, which gives us the useful relations B 5 2S ZG21B, BB 'B 5 2S ZG21BB 'B, 2 [tBB 'B 5 2S ZG21~ ZG 2 I !B 5 2~B 1 SB!, SB 5 2B~Im 1 2 [tB 'B!+ (B.4) Returning our attention to ~B+1! then we also have ZG21 5 I 2 2 [tB@Im 1 2 [tB 'B#21B ', ZG21S 5 S 2 2 [tB@Im 1 2 [tB 'B#21B 'S (B.5) and because ~B 'S!5 ~SB!' and from ~B+4! ZG21S 5 S 1 2 [tBB ' ~5 S 2 2 [tF!+ So ~B+1! may be rewritten as Tr@~S 1 2 [tBB ' 1 I ! ZG21F# 5 0, (B.6) and we also have S ZG21 5 S 2 2 [tF ~by symmetry!, 2 [tBB ' ZG21 5 2 [tB~Im 1 2 [tB 'B!21B ' ~from ~B+4! and ~B+5!!, (B.7) SADDLEPOINT APPROXIMATIONS 557 then simply collecting terms in ~B+6! and writing [t5 [t~q!, Tr@~ ZG21S 1 I ! ZG21F# 5 0 gives Tr@SF 2 2 [t~q!F 2 1 F#5 0 and hence the result+ n APPENDIX C: ON ASYMPTOTICS IN THE TAILS From Lemma 2 we have [t~q! 5 Tr@~S 1 I !F# 2 Tr@F 2 # , and writing F 5 q~q21A1 2 A2!, then lim 6q 6r` [t~q!q 5 Tr@~S 1 I !A2# Tr@A2 2 # 5 ( i ai, im i 2 1 2( iÞj ( ai, jm im j 1( i ai, i ( i ai, i 2 1 2( iÞj ( ai, j2 , (C.1) where the ai, j and m i are the elements of A2 and m+ Because the ai, j and m i are finite we write b1 5 ( i ai, im i 2 N ; b2 5 ( iÞj ( ai, jm im j 2 1 2N~N 2 1! ; b3 5 ( i ai, i N ; b4 5 ( i ai, i 2 N and b5 5 ( iÞj ( ai, j2 2 1 2N~N 2 1! , and so [t~q!q 5 Nb1 1 N~N 2 1!b2 1 Nb3 Nb4 1 N~N 2 1!b5 , and lim 6q 6r` [t~q!q 5 O~1!+ 558 PATRICK W.N. MARSH The relevant terms in Q ~ j !~ [t! and P ~k!~ [t! are ZG21F 5 [t@q21 [tI 2 2~q21A1 2 A2!# 21~q21A1 2 A2!, ZG21S 5 [tq21 @q21 [tI 2 2~q21A1 2 A2!# 21S, ZG21A2 5 [tq 21 @q21 [tI 2 2~q21A1 2 A2!# 21A2 (C.2) and substitute back into their definitions+Consequently, noting extraneous [t and q21 terms cancel, the asymptotic nature is determined by examining lim 6q 6r` @q21 [t~q!I 2 2~q21A1 2 A2!# 21~q21A1 2 A2! 5 @q 21 [t~q!A2 21 2 2I #21, lim 6q 6r` @q21 [t~q!I 2 2~q21A1 2 A2!# 21S 5 @q21 [t~q!S21 2 2A2 S 21 #21, lim 6q 6r` @q21 [t~q!I 2 2~q21A1 2 A2!# 21A2 5 @q 21 [t~q!A2 2 2I # 21+ Noting [t~q!q 5 O~1! we thus have lim 6q 6r` Tr@~ [t~q!q ZG21F! j~ [t~q!q ZG21A2!~ j [t~q!q ZG 21S 1 I !# 5 O~N !; lim 6q 6r` Tr@~ [t~q!q ZG21F!k~ j [t~q!q ZG21S 1 I !# 5 O~N !, (C.3) that is, we have shown lim 6q 6r`HQ ~ j !~ [t~q!!P ~k!~ [t~q!! 5 O~N ! ∀ j, k, as required+ n SADDLEPOINT APPROXIMATIONS 559 