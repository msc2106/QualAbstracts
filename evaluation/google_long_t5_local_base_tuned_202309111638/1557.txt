ABSTRACT: 
Theories of classification distinguish classes with some good structure theorem from those for which none is possible. Some classes (dense linear orders, for instance) are non-classifiable in general, but are classifiable when we consider only countable members. This paper explores such a notion for classes of computable structures by working out a sequence of examples. We follow recent work by Goncharov and Knight in using the degree of the isomorphism problem for a class to distinguish classifiable classes from non-classifiable. In this paper, we calculate the degree of the isomorphism problem for Abelian $p$-groups of bounded Ulm length. The result is a sequence of classes whose isomorphism problems are cofinal in the hyperarithmetical hierarchy. In the process, new back-and-forth relations on such groups are calculated.Comment: 15 page. 
 
PREDICTION: 
This paper provides a number of theoretical arguments for a class of computable bounded Ulm length. In this paper, we calculate the degree of the isomorphism problem for Abelian p-groups of bounded Ulm length. The result is a sequence of classes whose isomorphism problems are cofinal in the hyperarithmetical hierarchy. In the process, new back-and-forth relations on such groups are calculated. 
 
FULL TEXT: 
  classifiable. In this paper, we calculate the degree of the isomorphism problem for Abelian p-groups of bounded Ulm length. The result is a sequence of classes whose isomorphism problems are cofinal in the hyperarithmetical hierarchy. In the process, new back-and-forth relations on such groups are calculated. 1. Introduction In an earlier paper [4], we began to consider a notion of “classification” for classes of computable structures. For some classes, there is a “classification,” or “structure theorem” of some kind. For instance, the classification of algebraically closed fields states that a single cardinal (the transcendence degree) completely determines the structure up to isomorphism. For other classes (graphs, for example, or arbitrary groups) such a result would be surprising, and when we introduce the necessary rigor we can prove that there is none to be found. They simply have more diversity than any structure theorem could describe. We assume all structures have for a universe some computable subset of ω and identify a structure with its atomic diagram. Thus, for instance, a structure is com- putable if and only if its atomic diagram is computable, as a set of Go¨del numbers of sentences. Alternatively, we could use the quantifier-free diagram instead of the atomic diagram. Similarly, a structure is associated with the index of a Turing ma- chine which enumerates its atomic diagram (assuming its universe is computable). In this paper, I will write Aa for the computable structure with atomic diagramWa and will always assume that a class K of structures has only computable members. The following definition was recently proposed by Goncharov and Knight [7]. Definition 1.1. The isomorphism problem, denoted E(K), is the set {(a, b)|Aa,Ab ∈ K, and Aa ≃ Ab} If the set of indices for computable members of K, denoted I(K), is hyperarith- metical, then E(K) is Σ11. Intuitively, in the worst case, where E(K) is properly 1991 Mathematics Subject Classification. 03D45, 03C57, 20K10. Key words and phrases. Classification, Computable, Ulm, Back-and-forth. The author was partially supported by NSF Grants DMS 9970452 and DMS 0139626. The author wishes to thank J. F. Knight for many helpful comments on this paper. 1 2 WESLEY CALVERT Σ11, the easiest way to say that two members of K are isomorphic is to say, “There exists a function which is an isomorphism between them.” Often there are easier ways to check isomorphism, such as counting basis elements of vector spaces. Such a “shortcut” is a classification. There is also a natural “floor” to the complexity of E(K), since to say that a ∈ I(K) requires saying that a is an index for some structure, which is already Π02. This notion is closely related to work in descriptive set theory, originating in the work of Friedman and Stanley [6]. In that context, the set of countable models of a theory is viewed as a topological space, and we would calculate the topological complexity of the isomorphism relation as a subset of the Cartesian product of two copies of the space (for a more complete description of the topological situation, see [9]). Many of the proofs that a class has maximal complexity, like the Friedman – Stanley proof of the Borel completeness of fields [6], require only minor modification. Several classes are well-known to have maximally complicated isomorphism prob- lems. The following theorem summarizes several classical results. Proofs may be found in articles by Rabin and Scott [16], Goncharov and Knight [7], Morozov [14], and Nies [15]. Theorem 1.2. If K is the set of computable members of any of the following classes, then E(K) is Σ11 complete: (1) Undirected graphs (2) Linear orders (3) Trees (4) Boolean algebras (5) Abelian p-groups The following additions to the list follow easily from recent work by Hirschfeldt, Khoussainov, Shore, and Slinko [8]. Theorem 1.3 (Hirschfeldt – Khoussainov – Shore – Slinko). If K is the set of computable members of any of the following classes, then E(K) is Σ11 complete: (1) Rings (2) Distributive lattices (3) Nilpotent groups (4) Semigroups In an earlier paper [4], the following were added: Theorem 1.4. (1) If K is the set of computable members of any of the following classes, then E(K) is Σ11 complete: (a) Fields of any fixed characteristic (b) Real Closed Fields (2) If K is the set of computable members of any of the following classes, then E(K) is Π03 complete: (a) Vector spaces over a fixed computable field (b) Algebraically closed fields of fixed characteristic (c) Archimedean real closed fields In this paper, the complexity of the isomorphism problem will be calculated for other classes. Two major goals which are partially achieved here are the answers to the following questions: ISOMORPHISM PROBLEM FOR ABELIAN p-GROUPS 3 Question 1.5. What are the possible complexities of the isomorphism problem for classes of structures? Question 1.6. Do classes with high complexity acquire it all at once? Considering Abelian p-groups of bounded Ulm length will give us a sequence of isomorphism problems whose degrees are cofinal in the hyperarithmetical degrees. In some sense, this also shows a smooth transition from very low complexity (say, Π03 complete) to the “non-classifiable” (that is, properly Σ 1 1). 2. Notation and Terminology for Abelian p-groups Let p be an arbitrary prime number. Abelian p-groups are Abelian groups in which each element has some power of p for its order. We will consider only count- able Abelian p-groups. These groups are of particular interest because of their classification up to isomorphism by Ulm. For a classical discussion of this theorem and a more detailed discussion of this class of groups, consult Kaplansky’s book [10]. Generally, notation here will be similar to Kaplansky’s. It is often helpful to follow L. Rogers [18] in representing these groups by trees. Consider a tree T . The Abelian p-group G(T ) is the group generated by the nodes in T (among which the root is 0), subject to the relations stating that the group is Abelian and that px is the predecessor of x in the tree. Reduced Abelian p-groups, from this perspective, are represented by trees with no infinite paths. The idea of Ulm’s theorem is that it generalizes the notion that to determine a finitely generated torsion Abelian group it is only necessary to determine how many cyclic components of each order are included in a direct sum decomposition. Let G be an Abelian p-group. We will produce an ordinal sequence (usually transfinite) of cardinals uβ(G) (each at most countable), which is constant after some ordinal (called the “length” of G). If H is also an Abelian p-group and for all β we have uβ(G) = uβ(H), then H ≃ G (this is still subject to another condition we have yet to define). First set G0 = G. Now we inductively define Gβ+1 = pGβ = {px|x ∈ Gβ}, where px denotes the sum of x with itself p times. We also define, for limit β, the subgroup Gβ = ⋂ γ<β Gγ . Further, let P (G) denote the subgroup of elements x for which px = 0, and let Pβ(G) = P ∩Gβ . Now the quotient Pβ(G)/Pβ+1(G) is a Zp vector space, and we call its dimension uβ(G). Where no confusion is likely, we will omit the argument G and simply write Pβ , and so forth. For any Abelian p-group G, there will be some least ordinal λ(G) such that Gλ(G) = Gλ(G)+1. This is called the length of G. If Gλ(G) = {0}, then we say that G is reduced. Equivalently, G is reduced if and only if it has no divisible subgroup. The height of an element x is the unique β such that x ∈ Gβ , but x /∈ Gβ+1. It is conventional to write h(0) = ∞, where ∞ is greater than any ordinal. Similarly, if our group contains a divisible element x, we write h(x) = ∞. In the course of this paper, we will only consider reduced groups. When G is a direct sum of cyclic groups, un(G) is exactly equal to the number of direct summands of order p n+1. We can now state Ulm’s theorem, but we will not prove it here. Theorem 2.1 (Ulm). Let G and H be reduced countable Abelian p-groups. Then G ≃ H if and only if for every countable ordinal β we have uβ(G) = uβ(H). 4 WESLEY CALVERT It is interesting to note that this theorem is not “recursively true.” Lin showed that if two computable groups satisfying the hypotheses of this theorem have iden- tical Ulm invariants, they may not be computably isomorphic [12]. However, it is known that (depending heavily on the particular statement of the theorem), Ulm’s theorem is equivalent to the formal system ATR0 [5, 19]. Related work from a constructivist perspective may be found in a paper by Richman [17]. A calculation of the complexity of the isomorphism problem for special classes of computable reduced Abelian p-groups is essentially a computation of the complexity of checking the equality of Ulm invariants. Given some computable ordinal α, we will consider the class of reduced Abelian p-groups of length at most α. 3. Bounds on Isomorphism Problems When we begin to consider special classes of Abelian p-groups from the per- spective described in section 1, it quickly becomes apparent that all examples in Theorems 1.2, 1.3, and 1.4 were especially nice ones. In all of these cases, I(K) was Π02 and E(K) was something worse. It is easy to see that I(K) ≤T E(K), since I(K) = {a|(a, a) ∈ E(K)} For instance, if K is the class of reduced Abelian p-groups of length at most ω, I(K) is Π03 complete. Then to show that E(K) is Π 0 3 complete, it is enough to show that E(K) is Π03, and this is not difficult (the reader interested in the details of this may wish to glance ahead to Proposition 4.1). However, this doesn’t tell us whether E(K) has high complexity “on its own,” or just by virtue of it being hard to tell whether we have something in K. In a talk in Almaty in the summer of 2002, J. Knight proposed the following definition to clear up the distinction: Definition 3.1. Suppose A ⊆ B. Let Γ be some complexity class (e.g. Π03), and K a class of computable structures. Then A is Γ within B if and only if there is some R ∈ Γ such that A = R ∩B In the example above, saying that E(K) is Π03 within I(K)× I(K) means that there is a Π03 relation R(a, b) such that if a and b are indices for computable reduced Abelian p-groups, then R(a, b) defines the relation “Aa has the same Ulm invariants as Ab.” In general, it is possible that A is not Γ but that A is Γ within B. Consider for instance the case of a theory which is ℵ0-categorical. If K is the class of models of such a theory, then E(K) is not computable, but E(K) is computable within I(K)× I(K). We can also define a reducibility “within B”, which will, in turn, give us a notion of completeness. Definition 3.2. Let A,B, and Γ be as in the previous definition. (1) S ≤m A within B if there is a computable f : ω → B such that for all n, n ∈ S ⇐⇒ f(n) ∈ A. (2) A is Γ complete within B if A is Γ within B and for any S ∈ Γ we have S ≤m A within B. Essentially, this definition says that A is Γ complete within B if it is Γ within B and there is a function witnessing that it is Γ complete which only calls for questions about things in B. In fact, the questions are only about members of a c.e. subset of ISOMORPHISM PROBLEM FOR ABELIAN p-GROUPS 5 B. We will usually write “within K” for “within I(K)× I(K).” All results stated in section 1 remain true when we add “within K” to their statements, and the original proofs still work. In fact, this is intuitively the “right” way to say that the structure of a class is complicated: we say that if we look at some members, it is difficult to tell whether they are isomorphic. It would be unconvincing to argue that the structure of a class is complicated simply because it is difficult to tell whether things are in the class or not. For any computable ordinal α, it is somewhat straightforward to write a com- putable infinitary sentence stating that G is a reduced Abelian p-group of length at most α and that G and H have the same Ulm invariants up to α. In particular, Barker [3] verified the following. Lemma 3.3. Let G be a computable Abelian p-group. (1) Gω·α is Π 0 2α. (2) Gω·α+m is Σ 0 2α+1. (3) Pω·α is Π 0 2α. (4) Pω·α+m is Σ 0 2α+1. Proof. It is easy to see that 3 and 4 follow from 1 and 2 respectively. Toward 1 and 2, note the following: x ∈ Gm ⇐⇒ ∃y(p my = x) x ∈ Gω ⇐⇒ ∧ m∈ω ∧ ∃y(pmy = x) x ∈ Gω·α+m ⇐⇒ ∃y[p my = x ∧Gω·α(y)] x ∈ Gω·α+ω ⇐⇒ ∧ m∈ω ∧ ∃y[pmy = x ∧Gω·α(y)] x ∈ Gω·α ⇐⇒ ∧ γ<α ∧ Gω·γ(x) for limit α  Work by Lin [13], when viewed from our perspective, shows that for any m ∈ ω, there is a group G in which Gm is Σ 0 1 complete. Given this lemma, we can place bounds on the complexity of I(K) and E(K). Lemma 3.4. If Kα is the class of reduced Abelian p-groups of length at most α, then I(Kω·β+m) is Π 0 2β+1. Proof. The classKω·m+β may be characterized by the axioms of an Abelian p-group (which are Π02), together with the condition ∀x[x ∈ Gω·β+m → x = 0] Since the previous lemma guarantees that this condition is Π02β+1, we know that I(Kω·β+m) is also Π 0 2β+1.  Lemma 3.5. If Kα is as in the previous lemma, we use αˆ to denote sup ω·γ<α (2γ + 3). Then E(Kα) is Π 0 αˆ within K. 6 WESLEY CALVERT Proof. Note that the relation “there are at least n elements of height β which are Zp-independent over Gβ+1” is defined in the following way. To say that xi, . . . , xn are Zp-independent over Gβ+1, we write the computable Π 0 2β+1 formula Dn,β(x1, . . . , xn) = ∧ b1,...bn∈Zp ( n∑ i=1 bixi /∈ Gβ+1) Now to write “there are at least n independent elements of height β and order p,” we use the sentence Bn,β = ∃x1, . . . , xn[( n∧ i=1 Gβ(xi)) ∧ ( n∧ i=1 pxi = 0)) ∧Dn,β(x)] which is a computable Σ02β+2 sentence. Now we can define isomorphism by ∧ n∈ω β<α ∧ Aa |= Bn,β ⇔ Ab |= Bn,β We write each β < α as β = ω · γ + m, where m ∈ ω. If αˆ is as defined in the statement of the lemma, then this can be expressed by a computable Π0αˆ sentence.  4. Completeness for Length ω ·m Proposition 4.1. If Kω is the class of computable Abelian p-groups of length at most ω, then E(Kω) is Π 0 3 complete within Kω. Proof. We first observe that the set is Π03 within K, by applying the previous lemma. Now let S = ∀e∃y˜∀zR(n, e, y, z) be an arbitrary Π03 set. We can represent S as the set defined by ∀e∃<∞y R(n, e, y) where ∃<∞ is read “there exist at most finitely many.” Consider the Abelian p-group Gω with Ulm sequence uα = { ω if α < ω 0 otherwise We will build a uniformly computable sequence Hn of reduced Abelian p - groups of height at most ω such that Hn ≃ Gω if and only if n ∈ S. Let Gω,∞ denote the direct sum of countably many copies of the smallest divisible Abelian p-group Z(p∞), and note that Gω,∞ has a computable copy, as a direct sum of copies of a subgroup of Q/Z. We will denote the element where x occurs in the ith place with zeros elsewhere by (x)i. For instance, G ω,∞ set-wise is the collection of all sequences of proper fractions whose denominators are powers of p, and the element ( 1 p )2 denotes the element (0, 1 p , 0, 0, . . . ). List the atomic sentences by φe, the pairs of elements in G ω,∞ by ξe, and set D−1 = C−1 = Ye,−1 = Xe,−1 = X˜e,−1 = Te,−1 = ∅. We will build groups to meet the following requirements: ISOMORPHISM PROBLEM FOR ABELIAN p-GROUPS 7 Pe : There are infinitely many independent elements x ∈ Hn of order p and height exactly e if and only if there are at most finitely many y such that R(n, e, y). Qe : If ξe = (a, b) and a, b ∈ Hn, then a+ b ∈ Hn. Ze : If all parameters occurring in φe are in H n, then exactly one of φe ∈ D or ¬φe ∈ D. Roughly speaking, Ds will be the diagram of H n, and Cs will be its domain. For each e, the set Ye,s will keep track of the y already seen, Xe,s the x created of height at least e, and X˜e,s the x which are given greater height, as in Pe. The set Te,s will keep track of the heights greater than e already used to put elements from Xe in X˜e, so that we do not accidentally make infinitely many elements of height e+ 1. We say that Pe requires attention at stage s if there is some y < s such that y /∈ Ye,s−1 and R(n, e, y) and there is also some x ∈ Xe,s−1 \ X˜e,s−1, or if for all y < s we have either y ∈ Ye,s−1 or ¬R(n, e, y). We say that Qe requires attention at stage s if ξe = (a, b) and a, b ∈ Cs−1 but a+ b /∈ Cs−1. We say that Ze requires attention at stage s if all parameters that occur in φe are in Cs−1 and Ds−1 does not include either φe or ¬φe. At stage s, to satisfy Pe, we will act by first looking for some y < s such that y /∈ Ye,s−1 and R(n, e, y). If none is found, the action will be to enumerate a new independent x of height at least e. To do this, find the first k such that ( 1 p )k does not occur in Cs−1 or in any element of Ds−1. Let Cs = Cs−1 ∪ {( 1 pj )k|j = 1, . . . , (e− 1)} and set Xe,s = Xe,s−1 ∪ {( 1 p )k}, X˜e,s = X˜e,s−1, Te,s = Te,s−1, and Ye,s = Ye,s−1. If such a y is found, on the other hand, the action will be to give all existing element of Xe,s−1 height greater than e. To do this, collect K = {k|( 1 p )k ∈ Xe,s−1 \ X˜e,s−1} and the least positive r /∈ Te,s−1. Note that K is finite. Set Cs = Cs−1 ∪ ⋃ k∈K {( 1 pj )k|j = (e, . . . , e+ r + 1)} and set Te,s = Te,s−1 ∪ {r}, X˜e,s = X˜e,s−1 ∪ {( 1 p )k|k ∈ K}, Xe,s = Xe,s−1, and Ye,s = Ye,s−1 ∪ {y}. To satisfy Qe at stage s we will look to see whether the elements of ξe = (a, b) are in Cs−1. If they are both there, set Cs = Cs−1∪{a+b}. Otherwise, set Cs = Cs−1. To satisfy Ze, we will act at stage s by first looking for the parameters in φe in Cs−1. If all of them are there and G ω,∞ |= φe, then set Ds = Ds−1 ∪ {φe}. If all of them are there and Gω,∞ |= ¬φe, then set Ds = Ds−1 ∪ {¬φe}. If some of the parameters are not in Cs−1, we set Ds = Ds−1. Now if n ∈ S, for each e we have Qe to guarantee that ue(Hn) will be infinite, so Hn ≃ Gω. If n /∈ S, there is some e such that Qe guarantees that ue(H n) is finite, so Hn 6≃ Gω .  Since this result is perfectly uniform, we can use it for induction. What we actually have established is the following: 8 WESLEY CALVERT Proposition 4.2. If S is a set which is Π03 relative to X, then there is a uniformly X-computable sequence of reduced Abelian p-groups (Hn)n∈ω, each of length at most ω, such that Hn ≃ Gω if and only if n ∈ S. There is a result of Khisamiev [11], which allows us to transfer these X-computable groups down to the computable level. Proposition 4.3 (Khisamiev). If G is a X ′′-computable reduced Abelian p-group, then there is an X-computable reduced Abelian p-group H such that Hω ≃ G and un(H) = ω for all n ∈ ω. Moreover, from an index for G, we can effectively compute an index for H. These two results together can be used to establish Proposition 4.4. If Kω·m is the class of computable reduced Abelian p-groups of length at most ω ·m, then E(Kω·m) is Π02m+1 complete within K. Proof. Let S be an arbitrary Π02m+1 set. Since S is Π 0 3 in ∅ (2m−1), we have a uniformly ∅(2m+1)-computable sequence of reduced Abelian p-groups (Hn)n∈ω, each of length at most ω, such that Hn ≃ Gω if and only if n ∈ S. Now we can step each Hn down to a lower level using Khisamiev’s result, so that we have a uniformly ∅(2n−3) = ∅(2(n−1)−1)-computable sequence (H2,n)n∈ω of reduced Abelian p-groups, each of height ω ·2 which again have the property that H2,n has a constantly infinite Ulm sequence if and only if n ∈ S. By induction, we define (Hi,n)n∈ω, and when we get to (Hm,n)n∈ω, it will be a uniformly computable sequence of groups of length at most ω ·m such that Hm,n has constantly infinite Ulm sequence if and only if n ∈ S.  5. Completeness for Higher Bounds on Length Giving completeness results for higher levels requires more elaborate machinery. We will prove a more general result using an α-system, in the sense of Ash. These systems are explained in detail, along with several other variants, in the book of Ash and Knight [2]. The “metatheorem” for α-systems was proved in a paper by Ash [1]. Roughly speaking, an α-system describes all possible priority constructions of a given kind, and the metatheorem states that given an “instruction function” which is ∆0α, the system will produce a c.e. set (in our case, the diagram of a group) which incorporates the information given in the instruction function. More formally, we make the following definition: Definition 5.1 (Ash). Let α be a computable ordinal. An α-system is a structure (L,U, P, ℓˆ, E, (≤β)β<α) where L and U are c.e. sets, E is a partial computable function on L (it will eventually enumerate the diagram of the structure we are building), P is a c.e. alternating tree on L and U (that is, a set of strings with letters alternating between L and U) in which all members start with ℓˆ ∈ L, and ≤β are uniformly c.e. binary relations on L, where the following properties are satisfied: (1) ≤β is reflexive and transitive for all β < α (2) a ≤γ b⇒ a ≤β b for all β < γ < α (3) If a ≤0 b, then E(a) ⊆ E(b) ISOMORPHISM PROBLEM FOR ABELIAN p-GROUPS 9 (4) If σu ∈ P , where σ ends in ℓ0, and ℓ0 ≤β0 ℓ 1 ≤β1 · · · ≤βk−1 ℓ k where β0 > β1 > · · · > βk, then there exists some ℓ∗ such that σuℓ∗ ∈ P and for all i ≤ k, we have ℓi ≤βi ℓ ∗. If we have such a system, we say that an instruction function for P is a function q from the set of sequences in P of odd length (i.e. those with a last term in L) to U , so that for any σ in the domain of q, σq(σ) ∈ P . The following theorem, due to Ash [1], guarantees that if we have such a function, there is a string which represents “carrying out” the instructions while enumerating a c.e. set. We call an infinite string π = ℓˆu1ℓ1u2ℓ2 . . . a “run” of (P, q) if it is a path through P with the property that for any initial segment σu we have u = q(σ). The metatheorem also guarantees that there is a run with the property that ⋃ i∈ω E(ℓi) is computably enumerable. Proposition 5.2 (Ash Metatheorem). If we have an α-system (L,U, P, ℓˆ, E, (≤β)β<α) and if q is a ∆0α instruction function for P , then there is a run π : ω → (L ∪ U) of (P, q) such that ⋃ i∈ω E(π(2i)) is c.e. Further, from computable indices for the components of the system and a ∆0α index for q, we can effectively determine a c.e. index for ⋃ i∈ω E(π(2i)). What this means is that if we can set up an appropriate system, then given some highly undecidable requirements, we can build a computable group to satisfy them. The difficulty (aside from digesting the metatheorem itself) mainly consists of defining the right system. Afterwards, it is no trouble to write out the high-level requirements we want to meet. Using such a system, we will prove the following generalization of Proposition 4.4. Theorem 5.3. Let α be a computable limit ordinal, and let αˆ = sup ω·γ<α (2γ + 3), as in Proposition 3.5. If Kα is the class of reduced Abelian p-groups of length at most α then E(Kα) is Π 0 αˆ complete within Kα. Proof. Let (αi)i∈ω\{0} be a sequence cofinal in α (for instance, if α = ω · ω, then αi = ω · i would do, or if α = ω · (β + 1), we could use αi = ω · β + i). Consider the family of groups (Gˆi)i∈ω, each of length α where Gˆ0 has uniformly infinite Ulm sequence and uβ(Gˆ i) = { ω if β < αi or if β is even 0 otherwise Since the Ulm sequences of these groups are uniformly computable, there is a uniformly computable sequence (Gi)i∈ω such that G i ≃ Gˆi for all i, and such that in each of these groups, for any β, the predicate “x has height β” is computable. The proof of this, which is due to Oates, is a modification of an argument of L. Rogers [18], and may be found in Barker’s paper [3]. For any set S ∈ Π0αˆ, we will construct a sequence of groups (H n)n∈ω such that if n ∈ S then Hn ≃ G0, and otherwise, Hn ≃ Gi for some i 6= 0. To do this, we will define an αˆ-system. Let L be the set of pairs (j, p), where j ∈ ω and p is a finite 10 WESLEY CALVERT injective partial function from ω to Gj . Let U be the set {0, 1}. By E(j, p), we will mean the first |dom(p)| atomic or negation atomic sentences with parameters from the image of p which are true in Gj . Let ℓˆ = (0, ∅), and P be the set of strings of the form ℓˆu1ℓ1u2ℓ2 . . . which satisfy the following properties: (1) ui ∈ U and ℓi ∈ L (2) If ui = 1 then ui+1 = 1 (3) If ℓi = (ji, pi), then both the domain and range of pi contain at least the first i members of ω (4) If ℓi = (j, p) and ui = 1, then j 6= 0. Otherwise, j = 0. Further, if ui−1 = 1 and ℓi−1 = (ji−1, q), then j = ji−1. For the ≤β we will modify the standard back-and-forth relations on Abelian p-groups. In general, the standard back-and-forth relations on a class K are char- acterized as relations on pairs (A, a) where A ∈ K and a is a finite tuple of A. Definition 5.4. If a ⊆ A and b ⊆ B are finite tuples of equal length, then we define the standard back-and-forth relations ≤β as follows: (1) (A, a) ≤1 (B, b) if and only if for all finitary Σ01 formulas true of b in B are true of a in A. (2) (A, a) ≤β (B, b) if and only if for any finite d ⊂ B and any γ with 1 ≤ γ < β there is some c ⊂ A of equal length such that (B, b, d) ≤γ (A, a, c). This definition extends naturally to tuples of different length as follows: we say that (A, a) ≤β (B, b) if and only if a is no longer than b and that for the initial segment b ′ ⊂ b of length equal to that of a, we have (A, a) ≤β (B, b ′ ). Barker [3] gave a useful characterization of these relations in the case of Abelian p-groups A and B, where A = B. Proposition 5.5 (Barker). If ≤β are the standard back-and-forth relations on reduced Abelian p-groups, and if a and b are finite subsets of equal length in an Abelian p-group with the height of elements given by h respectively and with equal cardinality, with a function f mapping elements of b¯ to corresponding elements of a¯, then the following hold: (1) a ≤2·δ b if and only if the two generate isomorphic subgroups and for every b ∈ b and a = f(b) we have h(a) = h(b) < ω · δ or h(b), h(a) ≥ ω · δ (2) a ≤2·δ+1 b if and only if the two generate isomorphic subgroups and for every b ∈ b and a = f(b) we have (a) In the case that Pω·δ+k is infinite for every k ∈ ω, h(a) = h(b) < ω · δ or h(b) ≥ ω · δ and h(a) ≥ min{h(b), ω · δ + ω} (b) In the case that Pω·δ+k is infinite and Pω·δ+k+1 is finite, h(a) = h(b) < ω · δ or ω · δ ≤ h(b) ≤ h(a) ≤ ω · δ + k ISOMORPHISM PROBLEM FOR ABELIAN p-GROUPS 11 or h(a) = h(b) > ω · δ + k (c) In the case that Pω·δ is finite, h(x) = h(x) Since in all groups with which we are concerned, Pω·δ+k will be infinite for all δ < α, we will have no need for the more complicated cases. Also, it is helpful to deal with groups which satisfy the stronger condition that they have infinite Ulm invariants at each limit level. Definition 5.6. Let A,B be countable reduced Abelian p-groups of length at most α such that for any limit ordinal ν < α we have uν(A) = uν(B) = ω. Let the height of an element in its respective group be given by h. Let a, b be finite sequences of equal length from A and B, respectively. Then define (≤δ)δ<ω1 by the following: (1) (A, a) ≤2·δ (B, b) if and only if (a) The function matching elements of a to corresponding elements of b extends to an isomorphism f :< b >→< a >, (b) for every b ∈ b and a = f(b) we have h(a) = h(b) < ω · δ or h(b), h(a) ≥ ω · δ and (c) for all β < ω · δ we have uβ(A) = uβ(B). (2) (A, a) ≤2·δ+1 (B, b) if and only if (a) The function matching respective elements in a and b extends to an isomorphism f :< b >→< a >, (b) for every b ∈ b and a = f(b) we have h(a) = h(b) < ω · δ or h(b) ≥ ω · δ and h(a) ≥ min{h(b), ω · δ + ω} (c) for all β < ω · δ we have uβ(A) = uβ(B). (d) for all β ∈ [ω · δ, ω · δ + ω) we have uβ(A) ≥ uβ(B). In order to verify that we have an αˆ-system, the following lemma will be impor- tant. Lemma 5.7. Suppose (A, a) ≤β (B, b). Then for any η < β and for any finite sequence d ⊆ B there exists a sequence c ⊆ A of equal length such that (B, b, d) ≤η (A, a, c). Proof. Suppose that the conditions stated for ≤2·δ hold. Now suppose δ = γ + 1. It suffices to show that for all finite sequences d ⊆ B there exists a sequence c ⊆ A of equal length such that (B, b, d) ≤2·δ+1 (A, a, c). We will extend f to d one element at a time. Let d ∈ d, and suppose that d /∈< b > (since if it were in that subgroup, we could simply map it to the corresponding element of < c >. Further suppose, without loss of generality, that pd ∈< b > and that h(d) ≥ h(d + s) for any s ∈< b >. This last condition is often stated “d is proper with respect to < b >.” These assumptions are reasonable, since if we need to extend f to an element farther afield, we can go one element at a time and work down to it. From this point, we essentially follow Kaplansky’s proof of Ulm’s theorem [10] to find the 12 WESLEY CALVERT appropriate match for d. Use z to denote f(pd). It now suffices to find some c of height h(d) which is proper with respect to < a > and such that pc = z. First suppose that h(z) = h(d) + 1. Now both z and pd must be nonzero. For c we may choose any element of (A)h(d) with pc = z. The height of z tells us that there must exist such an element. We first check that h(c) ≤ h(d), which is easy, since if h(c) > h(d), we would have h(z) = h(pc) ≥ h(c) + 1  h(d) + 1 Finally, it is necessary to show that c is proper with respect to < a >. Suppose that c ∈< a >. Then c = f(y) for some y ∈< b >. Then pd = py and d− y /∈< b > to avoid d ∈< b >. Further, h(d − y) = h(d), since h(y) = h(d) and d is proper with respect to < b >. However, h(p(x− y)) = h(0) =∞  h(d) + 1 contradicting the maximality of h(px). Thus c /∈< a >. Now suppose we have h (c + t) ≥ h(d) + 1 for some r ∈< a > with r = f(s). Since c + r 6= 0 (to avoid the case that c = −r ∈< a >), we know that h(p(w + r)) ≥ h(d) + 2, so that h(p(d + s)) ≥ h(d) + 2. Since h(r) ≥ h(d), we also have h(s) ≥ h(d), so h(d+ s) = h(d), contradicting the maximality of h(pd). Suppose that h(z) > h(d) + 1. Now there is some v ∈ (B)h(d)+1 such that pd = pv. Then the element d− v is in Ph(d)(B), has height h(d), and is thus proper with respect to < b >. I make the following claim. Claim 5.8 (Lemma 13 of [10]). Let the function r : (< b >h(d) ∩p −1(B)h(d+2))→ Ph(d)(B) be defined as follows: For any x ∈ (< b >h(d) ∩p −1(B)h(d)+2) there exists some y ∈ (B)h(d)+1 such that py = px. Define Y by Y : x 7→ x − y and let Yˆ be the composition of this map with the projection onto Ph(d)(B)/Ph(d)+1(B). If F : (< b >h(d) ∩p −1(B)h(d)+2)/ < b >h(d)+1−→ Ph(d)(B)/Ph(d)+1(B) is the map induced by Yˆ on the quotient, then the following are equivalent: (1) The range of F is not all of Ph(d)(B)/Ph(d)+1(B). (2) There exists in Ph(d)(B) an element of height h(d) which is proper with respect to < b >. Proof. To show 2 → 1, suppose w ∈ Ph(d) has height h(d) and is proper with respect to < b >. Then the coset of w is not in the range of F . Otherwise, w = x− y+ q for some x ∈< b >, some y ∈ (B)h(d), and some q ∈ Ph(d)+1(B). But then h(w − x) > h(d), so w was not proper. To show the other implication, suppose that w is an element of Ph(d)(B) repre- senting a coset not in the range of F . Then h(w) = h(d). Further, w is proper, since if it were not, and if h(s−w) > h(d) witnessed this, we could write s−w = pζ with ζ ∈ (B)h(d). But then ps = pζ since pw = 0. But then F will map s to the coset of v, giving a contradiction.  Now since d− v is such an element as is described in the second condition of the claim, we know that the range of F is not all of Ph(d)(B)/Ph(d)+1(B). Since the vector spaces are finite (and thus finite dimensional), we know that the dimension ISOMORPHISM PROBLEM FOR ABELIAN p-GROUPS 13 of (< b >h(d) ∩p −1(B)h(d)+2)/ < b >h(d)+1 is less that uh(d)(B). However, since f was height preserving, it maps (< b >h(d) ∩p −1(B)h(d)+2)/ < b >h(d)+1 ↓ onto (< a >h(d) ∩p −1(A)h(d)+2)/ < a >h(d)+1 Thus the dimension of (< a >h(d) ∩p −1(A)h(d)+2)/ < a >h(d)+1 is less than uh(d)(B). In the case that h(d) < ω · δ + ω, we now know that the dimension of ( < a >h(d) ∩ p −1 (A)h(d)+2)/ < a >h(d)+1 is less than uh(d)(A), so there is an element c1 in A such that pc1 = 0, h(pc1) = h(d), and which is proper with respect to < a >. Since h(z) > h(d) + 1, we may write z = pc2 where c2 ∈ (B)h(d)+1. Now we write c = c1 + c2 and note that pc = z, that h(c) = h(d), and finally that c is proper with respect to < a >. If h(d) ≥ ω · δ + ω, we need considerably less. In particular, it suffices to find some c such that pc = z, such that c is proper with respect to < a >, and such that h(c) = ω · δ + ω. This can be achieved by replacing h(d) with ω · δ + ω in the preceding argument, and noting that since ω ·δ is a limit, uω·δ = ω. This completes the proof for the case (A, a) ≤2·δ (B, b) with δ a successor. If δ is a limit ordinal, it suffices to consider some odd successor ordinal 2 ·η+1 < 2 · δ and to show that for any d ∈ B there is some c ∈ A such that (B, b, d) ≤2·η+1 (A, a, c). Then the proof is exactly as in the successor case. In the case that we start with (A, a) ≤2·δ+1 (B, b) , we need to show that for any d ∈ B there is some c ∈ A such that (B, b, d) ≤2·δ (A, a, c). Now we can follow the proof exactly as in the even successor case, except that we replace ω · δ + ω with ω · δ.  We now adapt the relations ≤β on pairs (A, a¯), (B, b¯) to relations on L. Definition 5.9. We say that (j1, p1) ≤β (j2, p2) if and only if (Gj1 , ran(p1)) ≤β (G j2 , ran(p2)) We need to verify that (L,U, P, ℓˆ, E, (≤β)β<αˆ) is an αˆ-system. For the necessary effectiveness, notice that we need only consider ≤β on members of L, so only the groups Gi are considered. Conditions 1 – 3 are clear, as is the fact that (≤β)β<αˆ is uniformly c.e. It remains to verify the following: Lemma 5.10. If σu ∈ P where σ ends in ℓ0 and ℓ0 ≤β0 ℓ 1 ≤β1 · · · ≤βk−1 ℓ k where β0 > β1 > · · · > βk, then there exists some ℓ∗ such that σuℓ∗ ∈ P and for all i ≤ k, we have ℓi ≤β0 ℓ ∗. Proof. We write ℓi = (ji, pi). By Lemma 5.7, given ℓ k−1 ≤βk−1 ℓ k we can produce an ℓ˜k−1 = (j˜k−1, p˜k−1) such that p˜ extends pk−1 (mapping into the same structure) and ℓk ≤βk ℓ˜ k−1. Similarly, for each i, produce ℓ˜i such that ℓi+1 ≤βi+1 ℓ˜ i. It will then be the case that for all i, ℓi ≤βi ℓ˜ 0. If u = 0 or if 1 occurs somewhere in σ, let ℓ∗ = (j˜0, p ∗), where p∗ extends p˜0 and its domain and range each contain the first n constants, where 2n+1 is the length of σ. Now σuℓ∗ ∈ P and for all i, ℓi ≤β0 ℓ ∗. 14 WESLEY CALVERT If, on the other hand, u = 1 and 1 does not occur in σ, then we may be sure that j˜0 = 0. In this case, find some j ∗ > 0 such that αj∗ > β0. Note that since for each β < αj∗ we have uβ(G j∗) = uβ(G 0), it follows that (Gj ∗ , ∅) ≤β0+1 (G 0, ∅). Thus, by Lemma 5.7, we have some sequence ran(p∗) ⊆ Gj ∗ such that (G0, ran(p˜)) ≤β0 (Gj ∗ , ran(p∗)) and having length n where 2n+ 1 is the length of σ. We define p∗ to be the function taking each of an initial sequence of the natural numbers to the corresponding element of that sequence. Then clearly σuℓ∗ ∈ P , and for any i, we have ℓi ≤β0 (G 0, ran(p˜)) ≤β0 (G j∗ , ran(p∗))  Now let S be an arbitrary Π0αˆ set. There is a ∆ 0 αˆ function g(n, s) : ω 2 → 2 such that for all n, we have n ∈ S if and only if ∀s[g(n, s) = 0], and such that for all n, s ∈ ω, if g(n, s) = 1 then g(n, s + 1) = 1. We define a ∆0αˆ instruction function qn as follows. If σ ∈ P and σ is of length m, then we define qn(σ) = g(n,m). Now we certainly can find computable indices for all the components of the αˆ-system, and we can uniformly find a ∆0αˆ index for each qn, so the Ash metathe- orem gives us (uniformly in n), a run πn of (P, qn) and the index for the c.e. set⋃ i∈ω E(πn(2i)). Let H n denote the group whose diagram this is. Note that if n ∈ S, then qn(m) = 0 for all m, and so H n ≃ G0. Otherwise there is some mˆ such that for all m > mˆ, we have qn(m) = 1, and so H n ≃ Gi for some i 6= 0.  References [1] C. J. Ash. Labelling systems and r.e. structures. Annals of Pure and Applied Logic, 47:99–119, 1990. [2] C. J. Ash and J. F. Knight. Computable structures and the hyperarithmetical hierarchy. Elsevier, 2000. [3] E. Barker. Back and forth relations for reduced Abelian p-groups. Annals of Pure and Applied Logic, 75:223–249, 1995. [4] W. Calvert. The isomorphism problem for classes of computable fields. preprint, 2003. [5] H. Friedman, S. Simpson, and R. Smith. Countable algebra and set existence axioms. Annals of Pure and Applied Logic, 25:141–181, 1983. [6] H. Friedman and L. Stanley. A Borel reducibility theory for classes of countable structures. Journal of Symbolic Logic, 54:894–914, 1989. [7] S. S. Goncharov and J. F. Knight. Computable structure and non-structure theorems. Algebra and Logic, 41:351–373, 2002. [8] D. Hirschfeldt, B. Khoussainov, R. Shore, and A. M. Slinko. Degree spectra and computable dimensions in algebraic structures. Annals of Pure and Applied Logic, 115:71–113, 2002. [9] G. Hjorth. Classification and orbit equivalence relations. American Mathematical Society, 1999. [10] I. Kaplansky. Infinite Abelian groups. University of Michigan Press, 1969. [11] N. G. Khisamiev. Constructive Abelian p-groups. Siberian Advances in Mathematics, 2:68– 113, 1992. [12] C. Lin. The effective content of Ulm’s theorem. In Aspects of effective algebra, pages 147–160. Upside Down A Book Company, 1979. [13] C. Lin. Recursively presented Abelian groups: effective p-group theory I. Journal of Symbolic Logic, 46:617 – 624, 1981. [14] A. S. Morozov. Functional trees and automorphisms of models. Algebra and Logic, 32:28–38, 1993. [15] A. Nies. Undecidable fragments of elementary theories. Algebra Universalis, 35:8–33, 1996. [16] M. O. Rabin and D. Scott. The undecidability of some simple theories. preprint. [17] F. Richman. The constructive theory of countable Abelian p-groups. Pacific Journal of Math- ematics, 45:621 – 624, 1973. [18] L. Rogers. The structure of p-trees: algebraic systems related to Abelian groups. In Abelian Group Theory: 2nd New Mexico State Conference, pages 57–72. Springer-Verlag, 1976. ISOMORPHISM PROBLEM FOR ABELIAN p-GROUPS 15 [19] S. Simpson. Subsystems of second order arithmetic. Springer-Verlag, 1999. Department of Mathematics, 255 Hurley Hall, University of Notre Dame, Notre Dame, Indiana, 46556 E-mail address: wcalvert@nd.edu 