ABSTRACT: 
In this work, the use of binary amplitude holography is investigated as a mechanism to focus broadband acoustic pulses generated by high peak-power pulsed lasers. Two algorithms are described for the calculation of the binary holograms; one using ray-tracing, and one using an optimization based on direct binary search. It is shown using numerical simulations that when a binary amplitude hologram is excited by a train of laser pulses at its design frequency, the acoustic field can be focused at a pre-determined distribution of points, including single and multiple focal points, and line and square foci. The numerical results are validated by acoustic field measurements from binary amplitude holograms, excited by a high peak-power laser. 
 
PREDICTION: 
In this work, the use of binary amplitude holography is investigated as a mechanism to focus broadband acoustic pulses generated by high peak-power pulsed lasers. Two algorithms are described for the calculation of the binary holograms; one using ray-tracing, and one using an optimization based on direct binary search. It is shown using numerical simulations that when a binary amplitude hologram is excited by a train of laser pulses at its design frequency, the acoustic field can be focused at a pre-determined distribution of points, including single and multiple focal points, and line and square foci. The numerical results are validated by acoustic field measurements from binary amplitude holograms, excited by a high peak-power laser. 
 
FULL TEXT: 
 Control of broadband optically generated ultrasound pulsesusing binary amplitude hologramsa)Michael D. Brown,1,b) Jiri Jaros,2 Ben T. Cox,1 and Bradley E. Treeby11Department of Medical Physics and Biomedical Engineering, University College London,2-10 Stephenson Way, NW1 2HE London, United Kingdom2Faculty of Information Technology, Brno University of Technology, Bozetechova 2, 612 66 Brno,Czech Republic(Received 15 September 2015; revised 26 February 2016; accepted 11 March 2016; publishedonline 6 April 2016)In this work, the use of binary amplitude holography is investigated as a mechanism to focusbroadband acoustic pulses generated by high peak-power pulsed lasers. Two algorithms aredescribed for the calculation of the binary holograms; one using ray-tracing, and one usingan optimization based on direct binary search. It is shown using numerical simulations thatwhen a binary amplitude hologram is excited by a train of laser pulses at its design frequency,the acoustic field can be focused at a pre-determined distribution of points, including singleand multiple focal points, and line and square foci. The numerical results are validated byacoustic field measurements from binary amplitude holograms, excited by a high peak-power laser.VC 2016 Author(s). All article content, except where otherwise noted, is licensed under a CreativeCommons Attribution (CC BY) license (http://creativecommons.org/licenses/by/4.0/).[http://dx.doi.org/10.1121/1.4944758][JDM] Pages: 1637–1647I. INTRODUCTIONThe photoacoustic effect occurs when a time varying op-tical source, which can be coherent or incoherent, is incidenton an optically absorbing material. The incident photons areabsorbed and converted to heat by non-radiative de-excita-tion. This causes a small temperature rise resulting in localpressure increase which generates an acoustic pulse.1 Withinthe past decade there has been increasing interest in opticallygenerated ultrasound (OGUS) for biomedical applicationsdue to a steady increase in the acoustic pressures that can begenerated. This is principally due to the development ofmaterials with higher photoacoustic efficiencies.2 For exam-ple, nano-composites composed of separate elastomeric andabsorbing components possessing high optical absorption, ef-ficient heat transduction, and high thermal expansion havebeen used to generate focused pressures of 50MPa.3 OGUShas several clear advantages compared to piezoelectics.These include very wide bandwidths of 100 s of MHz,4 non-contact excitation, and flexible element size.5 In addition, bycontrolling both the optical pulse shape and spatial illumina-tion pattern to a two-dimensional (2-D) absorber, it is possi-ble to achieve a high degree of control over the resultingacoustic field in three dimensions, without the drawbacksassociated with 2-D capacitive micromachined ultrasonictransducer (CMUT)6 and piezoelectric arrays.7One configuration for the optical generation of ultra-sound uses a laser and a thin layer of a highly absorbing ma-terial. The laser pulse is first expanded, then absorbed by thelayer where it generates a plane wave.5 By controlling thespatial pattern of optical energy incident on the absorber, theresulting acoustic pulse can be focused or particular frequen-cies excited. For example, generating an annular patternusing an axicon lens8,9 or spatial light modulator (SLM)10results in a more intense acoustic signal at the center of thering. Alternatively, generating a stationary fringe by interfer-ing two laser pulses,11 or a moving fringe by interfering twofrequency shifted laser pulses12 results in an acoustic pulsewith peaks in its spectra determined by the fringe spacing.An equivalent effect can also be achieved by patterning theabsorbing layer. The initial distribution of pressure is thencontrolled by absorption differences over this layer. Bothdiffraction gratings and Fresnel zone plates (FZPs) havebeen manufactured in this way for applications usingsurface13,14 and longitudinal waves,15 respectively.By controlling the temporal application of the opticalradiation to the absorber, the spectrum of the resulting pulsecan be further controlled. For example, a single short opticalpulse can excite an acoustic pulse with a broadband spec-trum.4 Using multiple short optical pulses with an even tem-poral spacing results in an acoustic signal with a spectrumpossessing peaks at the pulsing repetition frequency (PRF)and at harmonics contained in the initially broadband spec-trum.16 Alternatively, if the optical intensity is modulatedsinusoidally, the resulting acoustic spectrum has a singlepeak at the modulation frequency.17,18Both spatial and temporal modulation have been com-bined in several works. Sharples et al. used a mode lockedQ-switched laser that generated 30 pulses with a spacing of12.1 ns to excite surface acoustic waves.19 The pulses pro-duced by this laser were patterned with an SLM into a seriesof concentric arcs. By matching the acoustic transit timea)Portions of this work were presented in “Control of Optically GeneratedUltrasound Fields Using Binary Amplitude Holograms,” IEEEInternational Ultrasonics Symposium, Chicago, IL, September 2014.b)Electronic mail: michael.brown.13@ucl.ac.ukJ. Acoust. Soc. Am. 139 (4), April 2016 VC Author(s) 2016. 16370001-4966/2016/139(4)/1637/11between neighboring arcs to the repetition rate of the laser,the amplitude at the focus was maximized. Meyer et al.18modulated the intensity of a 10 ls 550 mJ laser pulse to varysinusoidally such that it excited narrowband acoustic tonebursts.20 The spatial intensity or relative phase of the laserpulse was then also modulated using an SLM. The result wasa 2-D acoustic pulse with a predetermined frequency andspatial pattern. The 3-D acoustic field could then be con-trolled using binary amplitude or phase holography. Theresulting system was used to generate several novel acousticpatterns including a line and an annular focus.Accurate spatial control of optically generated acousticfields is therefore possible for narrowband pulses by usingholographic patterns to control where the acoustic wavesconstructively interfere. However, it is difficult to achievehigh acoustic pressures (e.g., those needed in biomedicalultrasound) using this approach due to lower peak powers ofthese optical sources. For example, the pressures reported inRef. 20 were limited to 10 kPa. One approach to overcomethis limitation is to use short duration high peak powerpulses from a Q-switched laser. These lasers have signifi-cantly greater peak-powers so have the potential to generatemuch higher acoustic pressures. Spectral control of theacoustic field can be achieved by the use of multiple pulsesapplied with a high PRF (MHz). This could enable opticallygenerated ultrasound to become a practical modality for 2-Dultrasound arrays. However, consideration also needs to begiven to the optimal design of binary holograms for thisapplication.In this work, the properties of the acoustic fields thatcan be generated by the use of pulsed lasers and binary am-plitude holograms are explored in detail. The first sectioninvestigates numerically the acoustic fields generated by bi-nary amplitude holograms with a single focus, establishingthe experimental conditions influencing the generation of afocus. In the second section, this is extended to binaryamplitude holograms with multiple foci, exploring their pos-sibilities and limitations. The third section validates thenumerical model and demonstrates that this approach can beapplied experimentally with the use of patterned opticalabsorbers and a Q-switch laser.II. SINGLE FOCUS HOLOGRAMSA. Computer generated binary amplitude hologramsA binary amplitude hologram is a 2-D binary patterndesigned to control the distribution of light or sound of a par-ticular wavelength in three dimensions. Pixels that are “on”in the pattern transmit waves which constructively interfereat the design points. Pixels that are “off” do not transmit.A ray-based algorithm was implemented for the calcula-tion of binary amplitude holograms designed to generate asingle acoustic focus. For each hologram, a target point,aperture size (i.e., hologram size), pixel size (i.e., the size ofa hologram element), and design wavelength are defined.The pressure p(x, y) on the surface of the 2-D hologram isthen calculated by approximating the focal point as a mono-chromatic point source oscillating at the design frequency,wherep x; yð Þ ¼ Re 1reikrþU : (1)Here r is the distance from the focal point to each positionon the hologram surface, k is the wavenumber at the designfrequency f (where k¼ 2pf/c, and c is the soundspeed), andU is an arbitrary phase offset (the effect of which is dis-cussed further in Sec. II F). The calculated 2-D pressure onthe hologram surface is then thresholded with positive valuesof p(x, y) set to 1 and negative values set to 0 to produce a bi-nary hologram. An example hologram is plotted in Fig. 2.For the holograms depicted in this work, black pixels are“on” and white pixels are “off.”A binary amplitude hologram with a single focus isknown as a FZP. A FZP consists of a series of alternatingdark and light rings. The path length difference to the focusfrom neighboring rings differs by half a wavelength of thedesign frequency. It is possible to derive an expression forone set of radii for the center of each “on” ring of a FZP witha focus at depth d from Eq. (1) by setting U ¼ ð2pdÞ=k,which yieldsln ¼ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ2nkd þ n2k2p: (2)Here ln is the radii of the nth ring on the zone plate, d is thefocal depth, and k is the design wavelength. For most FZPk d, so for small n, Eq. (2) can be approximated byln ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ2nkdp: (3)In addition to the main focus, FZP’s have several less intensehigher order foci along the main axis corresponding to pointswhere the path length difference is nk for odd n. These occurat distances of approximately d/n.B. Hologram acoustic field simulationsThe acoustic fields generated by binary amplitude holo-grams when excited by a set of laser pulses spaced at theirdesign frequency were simulated using the k-Wave tool-box.22,23 This uses a k-space pseudo-spectral model for timedomain simulations of acoustic waves. For all simulationsthe medium was homogeneous with a density of 1000 kgm3 and a sound speed of 1500m s1. Unless otherwisestated the simulations were carried out on a regular512 512 512 Cartesian grid with a grid point spacing of25 lm, time steps of 5 ns, and a maximum supported fre-quency of 30MHz. The thickness of the perfectly matchedlayer was set to ten grid points. Holograms were inserted atone edge of the simulation domain as a source mask. Laserpulses incident on the absorber were represented temporallyas impulses at discrete simulation time points inserted at thenearest point to the analytic pulsing frequency. The temporalinput was filtered at 30MHz to remove frequencies not sup-ported by the spatial grid.C. Pulsed acoustic sources vs monochromaticThe calculation of a binary amplitude hologram usingEq. (1) assumes a monochromatic input spectrum. In1638 J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al.comparison, the spectrum of the acoustic wave generated bya short optical pulse is broadband or, if generated at a setrepetition rate, has peaks at the PRF and harmonics of thePRF contained in the broadband spectrum of the singlepulse.To establish the effect the difference between theassumed spectra and the actual spectra has on the resultingfield, the monochromatic and pulsed inputs were comparedin simulation. A hologram was calculated for a designfrequency of 5MHz, with a 0.03mm pixel spacing, a1.5 cm 1.5 cm aperture, and a focus at 1.5 cm. The fieldsgenerated from this hologram were simulated on a540 540 1536 grid, with a grid spacing of 0.03mm. Themaximum supported frequency was 25MHz. The hologramwas inserted as a source distribution in the (x, y) plane alongthe edge of the grid. The two optical inputs were representedin the simulation using a sinusoid (for the monochromaticinput), and using a train of delta functions spaced at 5MHz(to represent a pulsed laser input). Figure 1(a) shows themaximum amplitude projection (MAP) of the peak pressurein each voxel of the hologram field generated with a pulsedlaser input. Figure 1(b) is the MAP of the same field gener-ated by a monochromatic input.There are several significant differences introduced bythe harmonics in the acoustic spectrum. First, the volume ofthe design focus labeled f0 in both figures, measured bythresholding the maximum pressure data at 50% of the over-all maximum, is reduced by 92% compared to the mono-chromatic input. Second, the signal to noise of the focusrelative to the background is decreased. Third, there areseveral additional foci present in the pulsed field not presentin the monochromatic field. These are generated by the har-monics in the source spectrum. From Eq. (3) it can be seenthat halving the wavelength k and keeping the radii constantapproximately doubles the focal length d. Therefore, thehologram focuses each harmonic at a point further awayfrom the hologram aperture. As with the fundamental, eachharmonic also generates higher order foci at points wherethe path length from subsequent rings differs by an odd num-ber of wavelengths of that harmonic, an example is labeledin Fig. 1(a) as f4=3. This is the third order foci for the fourthharmonic. Certain higher order foci of odd harmonic fre-quencies also spatially coincide with the design focus, forexample, f3=3. This spatial overlapping is responsible for thereduction in focus volume observed in the pulsed input rela-tive to the monochromatic input.D. Zone plate resolution and pulse numberTo understand the parameters required to represent ahologram and generate an axial focus, the effect of resolu-tion (pixel size) and the number of laser pulses on the focusvolume and peak pressure was investigated. Simulationswere carried out using four equivalent holograms calculatedwith resolutions of k=16; k=8; k=4, and k=2 relative to thedesign frequency of 3.75MHz. Each hologram had a1 cm 1 cm aperture and a focus at a depth of 1 cm. Foreach hologram, 15 simulations were carried out increasingthe number of pulses applied from 1 to 15. The volume ofthe focus was evaluated in each simulation by thresholdingthe maximum pressure at each simulation voxel at 50% ofthe maximum pressure at the focus then calculating thenumber of voxels in the cluster containing the target focuspoint.As shown in Fig. 2(b), the volume of the focusdecreases with each additional pulse, reaching a steadystate for each hologram at approximately six pulses, whichmatches the number of rings on the hologram. It is also thepoint where the temporal spacing between the first and lastpulses in the input signal matches the travel time differencebetween waves from the edge and center of the hologramto the focus. The largest decrease in focal volume is seenbetween the one and two pulse inputs. This is because fora single pulse the acoustic field is not axially focused asFIG. 1. (Color online) (a) Maximum amplitude projection (MAP) of maxi-mum pressure generated by the hologram with a pulsed input, normalized topeak pressure in simulation. (b) MAP of maximum pressure generated bythe hologram with a monochromatic input, normalized to peak pressure insimulation. The pulsed input generates a lower focus volume but also gener-ates several additional foci and has lower signal to noise.FIG. 2. (Color online) (a) Four holograms used in the simulations. The reso-lutions from left to right are k=16; k=8; k=4, and k=2. (b) Variation in focusvolume with number of pulses applied in the simulation for each hologram.(c) Variation in maximum pressure at the focus with number of pulses foreach hologram. Maximum pressure increases and focus volume decreaseswith increasing hologram resolution and increasing pulse numbers.J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al. 1639there is no temporal overlap between the acoustic signalfrom different rings. For two or more pulses the acousticsignal from neighboring rings can constructively interferegenerating a focus. The volume of the focus at any givenpulse number decreases with increasing hologram resolu-tion. However, the fractional improvement reduces witheach subsequent increase in resolution, e.g., a gain of only8% is seen between the k=8 and k=16 holograms. Similartrends are observed for maximum pressure as shown inFig. 2(c).The spacing between rings on a zone plate, and theirwidth, decreases with increasing distance from the center[this can be seen in Figs. 4(c) and 4(d)]. This means both theresolution required to represent the zone plate and the num-ber of pulses needed for the field to converge will increasewith increasing aperture size. Both parameters will also varydepending on the depth of focus relative to the aperture andif the focus is moved off the hologram center. However, thesimulations demonstrate that a focus can be generated with arelatively low hologram resolution k=2 (corresponding to75 lm for 10MHz), and with as few as two optical pulses.E. Optical pulsing frequencyAfter establishing the conditions required for conver-gence of the field from a particular hologram, the degree towhich the acoustic field of individual holograms can be var-ied was considered. The focal length of a hologram variesdepending on the input frequency. As the spectrum gener-ated by a train of optical pulses is determined by the PRF, itshould be possible to vary the axial focus position by alteringthe PRF.A prediction of the focal depth of each ring on the holo-gram can be calculated by inverting Eq. (2),dn ¼ l2n2nk nk2: (4)Here dn is the prediction for the focal depth from the nthradii. By substituting in the appropriate wavelength and tak-ing the average of dn this gives a prediction of the focusdepth for each PRF.To validate Eq. (4) its predictions were comparedagainst simulations. A hologram was calculated for a designfrequency of 9MHz, with a 0.75 cm 0.75 cm aperture, anda focus at 0.75 cm. The fields generated by this hologramwere simulated altering the PRF between 4.5MHz and13.5MHz. For each simulation the input source was filteredat 2.2 points per wavelength (PPW) relative to the pulsingfrequency and the magnitude was normalized. The focusposition was recorded in each simulation as the depth fromthe hologram at which the peak pressure occurred. The peakpressure and lateral FWHM of the focus (beamwidth) werealso both evaluated.Figure 3(a) shows the measured variation in focus depthwith pulsing frequency compared to the prediction from Eq.(4). The two are in close agreement. Figure 3(b) shows thevariation in peak pressure and beamwidth at the focus as afunction of pulsing frequency. With increasing pulsingfrequency compared to the design, the pressure at the focusand the beamwidth remain approximately constant.Conversely, as the pulsing frequency drops, the peak pres-sure lowers and the beamwidth increases. One possible causeis that the variation in the focus depth predicted by differentrings becomes larger as the pulsing frequency decreases. Atmuch lower pulsing frequencies the focus is observed to splitinto a series of smaller foci at different depths. This isaccompanied by a large drop in peak pressure. MAPs of themaximum pressure recorded in each voxel of the simulationare shown in Figs. 3(c) and 3(d) for pulsing frequencies of5.7 and 11.7MHz. These demonstrate the change in focusposition.F. Zone plate phase offsetA series of zone plates with identical focusing parametersbut with rings at different positions can be generated by vary-ing the phase offset U in Eq. (1). It has been found for opticalzone plates that the choice of this parameter can influence themagnitude generated at both the focus and side lobes.24 Totest the impact of this parameter for acoustic holograms, a setof 60 equivalent holograms were generated by varying Ubetween 0 and 2p. Each hologram had a design frequency of9MHz, a 1 cm 1 cm aperture and a focus at 1 cm. Theacoustic field generated by each hologram was simulated withthe application of 2, 4, and 40 pulses. The measured variationin beamwidth and maximum pressure are shown in Fig. 4.For two pulses, the variation in beamwidth between thebest and worst phase offset is 66% [Fig. 4(a)]. As the numberof pulses used increases, a similar trend is observed, how-ever, the fractional variation between the best and worst casedecreases. For 40 pulses, where the field has reached steadyFIG. 3. (Color online) (a) Variation in focus depth with pulsing frequency,as measured in simulation and predicted by Eq. (4). The simulated data andthe prediction show good agreement. (b) Variation in peak pressure andfocus width with pulsing frequency. The dotted lines in (a) and (b) indicatethe design frequency. (c) MAP of the maximum pressure field for a pulsingfrequency of 5.7MHz. Pressure is normalized relative to maximum in (d).(d) MAP of the maximum pressure field for a pulsing frequency of11.7MHz. The crosses in (c) and (d) indicate the position of the target focusat 9MHz.1640 J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al.state, a variation of 9% occurs. From Figs. 4(c) and 4(d) itcan be seen that the beamwidth is maximized when the areaof the hologram’s central region is large and active, and isminimized for a small active central region. This is also thecase, with small variations, for lower pulse numbers, beforethe field has reached steady state. The peak simulation pres-sure is also seen to change with phase offset, however, themeasured variation is low compared to that seen in thebeamwidth [Fig. 4(b)]. The choice of U therefore has a sig-nificant impact on the resulting acoustic field.III. MULTI-FOCI HOLOGRAMSA. Computer generated holograms: Direct binarysearchHaving established the properties of the acoustic fieldsgenerated by binary amplitude holograms with a singledesign focus, the properties of holograms that target multipledistinct points and continuous patterns were investigated.Binary amplitude holograms with multiple focal points canbe generated using the ray-based algorithm. This is done byevaluating the pressure p(x, y) generated by each target pointover the hologram using Eq. (1) separately, then superimpos-ing the contribution of each point and thresholding theresulting pressure at 0. However, the acoustic fields gener-ated by these holograms show large variations in pressuregenerated at different target points.An example of this is given in Fig. 5. In Fig. 5(a) a holo-gram calculated to focus over the outline of a square isshown. The acoustic field generated by this hologram is plot-ted in Fig. 5(b). The acoustic field is significantly moreintense at the corners of the square, which makes the outlineof the square difficult to resolve. This effect is due to thequantization of the hologram. For optical holograms, it hasbeen previously found that binarization of the output of ray-based algorithms generates holograms that produce greaterintensity along edges and corners and significantly lowerintensities from other areas of the target pattern.25As a result an optimization approach was developed forthe calculation of holograms with multiple foci. The holo-gram is initialized in a randomized binary state. The costassociated with this state is evaluated using a cost functionfirst used by Clark in the design of binary optical phase holo-grams.26 This is given byC ¼ jpj þ ar; (5)where jpj is the average magnitude of the complex pressureat the target points, r is the standard deviation of the pres-sure over the target points, and a is a factor weighting thetwo terms. Empirically a value between 1 and 2 for a wasfound to provide a good balance between maximizing thepressure at each target point and minimizing the variation.The pressure at each focal point is evaluated using theRayleigh-Sommerfeld integral, that is,p ¼ð ðH x; yð Þ eikrrdxdy: (6)Here H(x, y) is the value of the hologram at the point (x, y),and r is the distance from the (x, y) pixel to the focal point.The optimization then proceeds via direct binary search, firstused by Seldowitz et al.27 The state of single pixels areFIG. 4. (Color online) (a) Variation in beamwidth with choice of phase off-set U for simulations using 2, 4, and 40 pulses, each normalized against thelargest beamwidth. (b) Variation in maximum pressure at the focus withchoice of phase offset for simulations using 2, 4, and 40 pulses, each nor-malized against the overall maximum pressure. (c) Hologram that generatedsmallest focal width with the application of 40 pulses. (d) Hologram thatgenerated the largest focal width with the application of 40 pulses.FIG. 5. (Color online) (a) Binary hologram designed to focus over the outlineof a 1.5 cm square, in a plane 3 cm from the hologram. Hologram was calcu-lated for a frequency of 3 MHz using the ray-based algorithm. (b) Maximumpressure in target plane of square generated by the hologram in (a) whensimulated. (c) Binary hologram calculated for the same target points and fre-quency as the hologram in (a) using the direct binary search algorithm. (d)Maximum pressure in target plane of square generated by the hologram in (c)when simulated. The optimization algorithm produces a significantly betterrepresentation of the target pressure.J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al. 1641flipped, the change in cost is evaluated, and the new statekept if it decreased. Pixels are chosen randomly, with eachpixel on the hologram being explored once before repeattests. This continues until the number of changes that occurin an iteration is less than 0.01% of the overall number ofpixels. The random-exhaustive approach to pixel selectionwas found to converge more rapidly than ordered or non-exhaustive selection. The random initialization and orderingof the pixel selection means the algorithm converges to dif-ferent holograms between model runs. However, the differ-ences in the acoustic fields generated by these hologramsover the points of interest was found to be small (<0.5%). Asummary of the algorithm is shown in Fig. 6.The optimization approach offers significant flexibilityover the resulting holograms. Additional terms can be addedto the cost function to control the acoustic field in differentways. For example, arbitrary weightings can be included tovary the pressure at different focal points, or the relativephase at different target points can be controlled.Figures 5(c) and 5(d) show the hologram and acousticfield that result from applying the optimization algorithmto the same problem of generating the outline of a square.In this case, the square can be clearly resolved relative tothe background, and the pressure is significantly moreuniform.B. Multi-foci holograms simulation parametersTwo further cases were investigated as a test of multi-foci holograms: an acoustic field with a line focus, and afield with a square array of foci. These were used to investi-gate the sampling rate needed to represent a continuousshape, and the change in pressure and foci size as a field ismade to focus at several points. Simulations were carried outon a 256 256 256 grid, with a grid spacing of 0.167mm,time steps of 33 ns, and a maximum supported frequency of4.5MHz. Holograms were calculated for a design frequencyof 3MHz, over an aperture of 3.33 cm.C. Line focusThe generation of a continuous pattern of pressure wasinvestigated first. The target used was a line focus, 1.66 cmin length in a plane 3.33 cm from and parallel to the holo-gram aperture. As an input to the optimization algorithm, theline had to be discretized into a set of points. The spacing ofthese points was varied between 33.3k to 0.168k, and a holo-gram was generated for each spacing. The acoustic fieldgenerated by each hologram was simulated recording the av-erage peak pressure in each voxel of the line, the variation inpeak pressure over the line, and the peak pressure at each tar-get point. These are each plotted in Fig. 7.From Fig. 7(c) it can be seen that it is possible to gener-ate an acoustic field focused over a line. The average maxi-mum pressure over this line increases with decreasing pointspacing until this spacing is less than 0.75k, at which pointit remains stable showing only small variations between dif-ferent point densities [Fig. 7(a)]. The maximum pressure ateach individual foci decreases with decreasing point spacinguntil approximately 0.75k, at this point it remains stable andmatches the value of the average line pressure. As this spac-ing also coincides with a large drop in the variation of maxi-mum pressure over the line, this demonstrates that 0.75k isthe maximum point spacing that can produce a continuouspattern without significant variations in pressure. For moresparse distributions the line is realized as a set of discretefoci [Fig. 7(b)].D. Multiple fociThe generation of multiple discrete foci was investi-gated next. In this case the target was a square array ofevenly spaced points. The points were distributed over aFIG. 6. Flow chart summarizing the optimization algorithm used in generat-ing multi-foci holograms.1642 J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al.1 cm 1 cm area centered on the hologram in a plane3.33 cm away. The number of target points in the array wasvaried from 2 2 to 11 11. The variation in the averagearea occupied by each foci, and the contrast between the tar-get focal points and the background are shown in Fig. 8. Toevaluate the average area occupied by each focus the maxi-mum pressure data was interpolated onto a denser grid toimprove differentiation, then thresholded at 50%. The areawas then given by the size of the cluster centered on eachtarget point in the 2-D target plane.Figures 8(b) and 8(c) show that arrays of points withevenly distributed pressures can be generated. However,there are several limitations. As the number of points in thearray increases, the ratio between the pressure at each targetpoint and the background pressure decreases [Fig. 8(a)].This is due to both the background pressure increasing andthe pressure at each focal point decreasing. For the 11 11array there is only a 16% difference between the two.As the number of points in the array increases, the aver-age area occupied by each focus increases gradually until the8 8 array [Fig. 8(a)]. A 46% increase is seen between the2 2 and 8 8 arrays. From the 9 9 array onward thepressure at background exceeds 50% of the pressure at thefoci. This results in the effective “area” occupied by eachfocus significantly increasing as different focal points cannotbe separately resolved by the metric. The lowest spacing ofdiscrete points that can be achieved is therefore limited to2.2k. Note this is distinct from the 0.75k found in Sec. III C,which represents the maximum discrete point spacing whichgenerates a continuous acoustic pressure.The MAP of the hologram field perpendicular to the tar-get and hologram planes for the 5 5 array is shown in Fig.8(d), where the target plane is indicated by the dotted line. Itcan be seen that high pressure foci are generated in planesother than the target plane. This is a potential drawback.However, these focal points occur in the near field for thehologram aperture, so are not dissimilar to those that occurfor conventional piezoelectric arrays.E. Effect of harmonics on multi-foci fieldThe simulations in Secs. III C and IIID were carried outat a single frequency, pulsed, but without including the contri-bution from harmonics. This can be a valid approximation, forexample, for high frequency holograms in highly attenuatingmedia. However, for most applications their effect needs to beconsidered. To investigate, the acoustic field generated by thehologram in Fig. 5(c) was simulated again including the con-tribution from the first two harmonics. The resulting field isplotted in Fig. 9(b).The introduction of harmonics causes the pressure tovary significantly from the intended distribution. This meansfor applications at lower frequencies where the number ofharmonics could be>10, the single frequency approximationused in the optimization model is invalid. To account forthis, a model-based approach using k-Wave was adopted.First, a forward simulation is run. The input to thisFIG. 7. (Color online) (a) Variation in mean line pressure, mean focal pres-sure, and standard deviation in pressure over the line with the spacing ofpoints used in discretizing the line measured in simulation. (b) Maximumpressure in target plane of line for a hologram generated using a point spac-ing of 5.55k. (c) Maximum pressure in target plane of line for a hologramgenerated with a point spacing of 0.1675k. Pressure normalized relative tomaximum in (b).FIG. 8. (Color online) (a) Simulated variation in the ratio of average of themaximum pressure at each focus to the average of the maximum pressureover background pixels as the size of the array increases. Also shown is vari-ation in average area occupied by each focus as the size of the arrayincreases. (b) Maximum pressure in target plane of hologram for a 5 5array of points (c) Maximum pressure in target plane for a 9 9 array ofpoints. (d) MAP of maximum pressure generated by hologram in (x, z)plane. The dash line indicates target plane for array of foci.J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al. 1643simulation is a single hologram pixel in the center (0, 0) ofthe intended hologram. The temporal input to this pixelmatches the source used in the final simulation and can haveany number of harmonics. The simulation records the pres-sure across the target plane of the hologram. This gives thepressure ppixel (x, y, t) generated by a single hologram pixelat each time point t at each coordinate in (x, y) in the targetplane. A time interval covering one period of the pulsing fre-quency is selected from the pressure data. The pressure ppoint(x, y, t) generated at a target point at (x, y) in the target planeby a pixel (i, j) in a NN hologram centered on (0,0) is thengiven byppoint x;y; tð Þ ¼ ppixel i xdxNþ 12; j ydyNþ 12; t ;(7)where dx and dy are the grid spacings in the x and y planes,respectively. For (x, y) coordinates between the simulationgrid points, the pressure is calculated by linear interpolation.The overall pressure generated by a given hologram at eachtarget point can then be evaluated usingppoint x;y; tð Þ¼XNj¼1XNi¼1H i; jð Þppixel i xdxNþ12; j ydyNþ12; t :(8)Here H(i, j) is the current value of the (i, j)th pixel in thehologram. The optimization then proceeds as before over themaximum pressure max(ppoint (x, y, t)) generated at eachtarget point. The algorithm can be extended to points in mul-tiple planes by recording over several planes in the forwardsimulation.This model was applied to the same test of generatingthe outline of a square described in Sec. III A. The resultinghologram and maximum pressure are plotted in Figs. 9(c)and 9(d). It can be seen that the outline of the square is suc-cessfully recovered, and that the signal to noise at the targetpoints relative to the background is comparable to that inFig. 5(d). So, the spectral difference introduced by utilizinga series of short pulses can be accounted for by adjustmentof the forward model. However, the hologram generated bythis algorithm [Fig. 9(c)] is significantly more speckly thanthe corresponding hologram in Fig. 9(a). This makes fabrica-tion of these holograms more challenging. However, theseregions can be removed from the hologram without a signifi-cant alteration to the resulting acoustic field.IV. PATTERNED ABSORBER FIELD MEASUREMENTSA. Absorber fabrication and optical sourceExperimental measurements were carried out to validatethe accuracy of the numerical model and demonstrate thatthe acoustic fields generated by binary amplitude hologramscan be realized experimentally. A set of holographically pat-terned absorbers were fabricated, and the acoustic field pho-toacoustically excited from these absorbers by a pulsed laserwas measured. Each absorber was fabricated on a50mm 30mm 5mm transparent PMMA substrate.These were spray painted with a thin layer of black spraypaint (Super Satin, Plasti Kote, Valspar). A laser cutter(VLS4.60, Universal Laser Systems) was used to etch thecalculated binary holograms from the painted slides.A Litron Nano L-200 laser (Litron, Rugby, England)was used to generate ultrasound from the fabricated absorb-ers. This consisted of two Q-switched lasers with spatiallycoincident beams that could be independently triggered.Both lasers had a wavelength of 1064 nm, a pulse length of6–9 ns, and a repetition rate of 15Hz.B. Two-pulse measurementsAn assumption made in the numerical experiments isthat there is no variation in the magnitude or shape of theacoustic signal generated by the absorber when two or moreoptical pulses are incident on it in with a very small timinggap (<ls). The validity of this assumption for the absorbersin this experiment was tested.The experiments were carried out in a 22 cm 40 cm 28 cm plastic tank. An unpatterned absorber fabricated asdescribed in Sec. IVA was attached to the side. The laserwas aligned with the absorber and expanded using a 40mmconcave lens to a width of 2.5 cm. The pulse energy ofboth Litron lasers was set to 7 mJ. The generated acousticsignals were recorded using a focused polyvinylidene fluo-ride (PVDF) transducer (Precision Acoustics, Dorchester,UK), which had a center frequency of 25MHz, and a focallength of approximately 24mm. The hydrophone was sus-pended within the tank approximately 2 cm behind theFIG. 9. (Color online) (a) Binary hologram to generate square outline, alsodisplayed in Fig. 5(c). (b) Maximum pressure generated by hologram in (a)in target plane of square, simulated including first two harmonics. (c)Hologram generated using the harmonic corrected forward model from Eq.(8). Target and parameters are identical to (a). (d) Maximum pressure gener-ated by hologram in (c) in target plane of square, simulated including firsttwo harmonics.1644 J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al.absorber. Both lasers were externally triggered, and thedelay between the two was varied between 0.02 and 2 ls.For each delay, three measurements were taken, one whereboth lasers were triggered together and two where the laserswere used by themselves. Signals were recorded using a dig-ital oscilloscope with a sampling rate of 400MHz and 256averages. The bias voltage was removed from each datasetand the single laser measurements were summed accountingfor the trigger delay.Figure 10 shows the recorded voltage from the two pulseand combined single pulse measurements where the triggerdelay was 0.5 ls. It can be seen that there is no significant var-iation in magnitude in the second pulse between the twomeasurements (the correlation coefficient between the twosignals was 0.989). This was found to be the case for separa-tions down to 20 ns, on the order of the pulse width, so theassumptions of the numerical model are valid up to frequen-cies of at least 50MHz using conventional Q-switched lasers.C. Patterned absorber field measurementsAcoustic field measurements were taken from two pat-terned absorbers. The samples used were a hologram with asingle focus and a hologram with a focus over a line. Bothholograms had aperture sizes of 30mm 30mm, and weredesigned for a PRF of 3MHz using a pixel spacing of0.25mm. For the hologram with the single focus, the focuswas 3 cm from the hologram aperture and placed on the cen-tral hologram axis. For the hologram with a line focus, thetarget was a 20mm line located 3 cm from the hologram, theline was centered on and parallel to the hologram plane. Tocalculate the hologram the line was discretized into 400points. The harmonic corrected algorithm was used account-ing for frequencies up to 15MHz. Clusters of pixels on thehologram smaller than 15 were removed prior to fabrication,as these were not well realized by the laser cutter.For each measurement the first of the two lasers withinthe Litron Nano L-200 was used to excite the absorbers. Theenergy was set to 300 mJ per pulse. Measurements of theacoustic field were performed in a 40 cm 40 cm 60 cmtank with a two axis computer controlled positioning system(Precision Acoustics, Dorchester, UK). A calibrated PVDFneedle hydrophone with a 0.2mm active element, differentfrom the transducer used in Sec. IVB, was used to record thepressure (Precision Acoustics, Dorchester, UK).The laser was positioned 50 cm from the tank edge. Aconcave lens with a 40mm focal length was placed 30 cmfrom the laser to expand the beam. The radius of the beam atthe edge of the tank was 30mm. The absorber was sus-pended 30mm inside the edge of the tank, and was alignedwith the laser beam. The needle hydrophone was suspended7mm away from the absorber and aligned with its center.Signals were recorded over a 30mm 30mm plane parallelto the absorber using a step size of 0.3mm. At each position,time domain signals were recorded using a digital oscillo-scope with a sampling rate of 400MHz, taking six averages.A photo of a similar set-up may be found in a previouswork.21The Q-switched laser was unable to produce a train ofpulses at the desired 3MHz repetition rate. So, 15 additionalpulses were created in the time domain signals. This wasdone by adding the data recorded at each point to itself trans-lated by multiples of 0.33 ls. This temporal spacing corre-sponds to a 3MHz pulsing frequency.To calculate the 3-D wavefield of the hologram fromeach set of planar measurements, k-Wave was used to for-ward and back propagate the data. Prior to this, each datasetwas spatially up-sampled to a grid spacing of 0.0375mm tosupport frequencies up to 20MHz in the simulation, lowpass filtered at 15MHz to give a minimum PPW of 2.666.The data were also temporally down-sampled to a step sizeof 7 ns. The single focus hologram measurements were addi-tionally high pass filtered at 100 kHz, and linear acousticpropagation was assumed.D. Single focus hologram resultsFor the single focus hologram, the planar measurementswere forward and back propagated by 100 and 20mm,respectively. The resulting field was compared to a numeri-cal simulation run using the same hologram and grid. TheMAP of the 3-D field from both the experimental data andthe simulation data is shown in Figs. 11(a) and 11(b). Thetwo show good agreement. Both acoustic fields are focusedat four distinct points along the central hologram axis, andeach foci occurs at approximately the same depth in bothsets of data.The first foci in the field is the design focus, the secondis the third order focus of the fourth harmonic, and the thirdand fourth are generated by the second and third harmonics,respectively. This is confirmed by the spectra measured ateach focus [Figs. 11(c)–11(f)]. The frequency with the maxi-mum amplitude in the spectra matches the predicted har-monic for the second, third, and fourth foci in both thesimulation and experimental data [Figs. 11(d)–11(f)]. At thedesign focus the third harmonic has a higher amplitude thanthe fundamental in both spectra [Fig. 11(c)]. This is because,as discussed in Sec. II C, the third order focus for the thirdharmonic also occurs at this point.The peak pressure measured at the design focus in theexperiment was 187.3 kPa. The maximum pressure in thedata that was propagated was 79.8 kPa giving a focal gain ofFIG. 10. (Color online) Voltage recorded on hydrophone from two pulseexperiment with delay between pulses set to 0.5ls. The red dotted line isthe data with both pulses incident on the absorber. The black solid line is thecombined data from both lasers used individually with the appropriate delayadded back in.J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al. 16452.347. However, this represents only the spectral content upto 15MHz. The peak pressure in the experimental data up tothe 30MHz to which the needle hydrophone was calibratedwas 326 kPa. Assuming equivalent focal gain this gives apressure of 764.17 kPa at the focus. This could be furtherimproved by the use of a optimized absorber over blackspray paint.3 The pressure achieved is over an order ofmagnitude higher than pressures reported in previous worksutilizing longer modulated pulses as the optical source.18E. Line focus hologram resultsFor the hologram with a line focus, the planar measure-ments were forward and back propagated by 30 and 20mm,respectively. The plane of the hologram was found in theback propagated data, and the target line was then identified30mm from this hologram plane. This was compared againsta simulation of the acoustic field generated by the samehologram. The spatial profile of the laser was accounted forin this simulation by registering the maximum pressure inthe hologram plane of the back propagated data to the calcu-lated hologram, then using this registered maximum pressureas the spatial profile in the forward simulation.It can be seen from Fig. 12(a) that a line focus is gener-ated by the fabricated hologram. The peak pressure over theline is 91.6 kPa. The experiment and the simulation showgood agreement [Fig. 12(b)] demonstrating that acoustic fieldsfocused over patterned distributions can be generated usingbinary amplitude holograms and that the field generated bythese holograms can be accurately modeled using the k-Wavetoolbox. In the future, the optimization approach adopted inthis work could be further adapted to include the spatial pro-file of the beam by introducing a weighting factor for the dif-ferent hologram pixels.V. SUMMARYAND CONCLUSIONThis study has demonstrated numerically and experi-mentally that acoustic fields focused over patterns, at multi-ple discrete points, or at single points in three dimensionscan be generated using the photoacoustic effect. This isachieved by the application of multiple high peak-powerFIG. 11. (Color online) Comparisonbetween the MAPs of the maximumpressure fields produced from the singlefocus hologram (a) simulation and (b)experiment. In both projections thehologram is located along the top imageaxis. Positions of the foci of differentharmonics are labeled. (c)–(f) Spectrameasured at each of the focal points la-beled in (a) and (b). Each spectra is nor-malized to its maximum. Simulationspectra is offset by 1 in each case rela-tive to experiment.FIG. 12. (Color online) (a) Maximum pressure in the target plane of line forthe line focus hologram recorded in experiment. (b) Maximum pressure intarget plane of the line for the line focus hologram simulated using k-Wavecorrecting for the spatial profile of laser using experimental data.1646 J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al.optical pulses to a binary amplitude hologram, at the holo-grams design frequency. The use of a high peak-poweroptical pulses facilitates the generation of patterned fieldswith greater acoustic pressures than alternative modulatedsources. The harmonics that this source introduces into theacoustic pulse spectrum can be accounted for in the calcula-tion of the binary holograms.There are currently a number of obstacles to the applica-tion of this approach to practical problems. The generationof multiple high peak power optical pulses with a high repe-tition rate requires either the use of several Q-switch laserstriggered in sequence or a mode-locked Q-switched laser,19and both these options are expensive. However, this could beovercome in the future by using high power high repetitionrate fiber and diode lasers currently being developed.28Creating the hologram by patterning an absorbing layeralso has two practical limitations. First, each hologram canonly generate a single design acoustic field, at a single fre-quency (for multi-focal patterns), making the hologramsinflexible. Second, each pattern possesses gaps resulting in aportion of the incident optical radiation being transmittedinto the medium, potentially generating unwanted photoa-coustic signals. In future work, the patterned absorber couldbe replaced by a SLM.18 This can modulate the light fieldincident on a uniform absorber, such that ultrasound isexcited from only part of the absorber. This would allow forrapid variation of the generated acoustic fields and preventthe transmission of light into the surrounding medium.ACKNOWLEDGMENTSThe authors would like to thank the EPSRC for fundingthe work and Litron for the use of the Litron Nano L-200.J.J. is financed from the SoMoPro II Programme, co-financed by the European Union and the South-MoravianRegion. This work reflects only the authors’ view and theEuropean Union is not liable for any use that may be madeof the information contained therein. Computationalresources were provided by the IT4Innovations excellence inscience project (IT4I XS - LQ1602).1P. Beard, “Biomedical photoacoustic imaging,” Interface Focus 1,602–631 (2011).2T. Buma, M. Spisar, and M. O’Donnell, “High-frequency ultrasound arrayelement using thermoelastic expansion in an elastomeric film,” Appl.Phys. Lett. 79, 548–550 (2001).3H. W. Baac, J. G. Ok, H. J. Park, T. Ling, S. Chen, A. J. Hart, and L. J.Guo, “Carbon nanotube composite optoacoustic transmitters for strongand high frequency ultrasound generation,” Appl. Phys. Letters. 97,234104 (2010).4B. E. Treeby, B. T. Cox, E. Z. Zhang, S. K. Patch, and P. C. Beard,“Measurement of broadband temperature dependent ultrasonic attenuationand dispersion using photoacoustics,” IEEE Trans. Ultrason. Ferroelectr.Freq. Control 56, 1666–1676 (2009).5Y. Hou, J. Kim, S. Ashkenazi, S. Huang, L. J. Guo, and M. O’Donnell,“Broadband all-optical ultrasound transducers,” Appl. Phys. Lett. 91,073507 (2007).6A. I. H. Chen, L. L. P. Wong, and J. T. W. Yeow, “Recent advances incapacitive micromachined ultrasonic transducer imaging systems,” inMedical Imaging: Technology and Applications, edited by T. Farncombeand K. Iniewski (CRC Press, Taylor and Francis Group, Boca Raton, FL,2014), Chap. 10, pp. 253–270.7C. Sheaff and S. Ashkenazi, “A polyimide-etalon thin film structure forall-optical high-frequency ultrasound transduction,” IEEE Trans. Ultrason.Ferroelectr. Freq. Control 59, 2254–2261 (2012).8S. Dixon, T. Harrison, Y. Fan, and P. A. Petcher, “Thermoelastic lasergenerated ultrasound using a ring source,” J. Phys. D: Appl. Phys. 45,175103 (2012).9P. Cielo, F. Nadeau, and M. Lamontagne, “Laser generation of convergentacoustic waves for materials inspection,” Ultrasonics 23, 55–62 (1985).10S. Zamiri, B. Reitinger, S. Bauer, and P. Burgholzer, “Converging lasergenerated ultrasonic waves using annular patterns irradiation,” J. Phys.Conf. Ser. 520, 012001 (2014).11G. Cachier, “Optical excitation of high-amplitude surface waves,” Appl.Phys. Lett. 17, 419–420 (1970).12H. Nishino, Y. Nagata, T. Koda, K. Yamanaka, and Y. Tsukahara,“Excitation of high frequency surface acoustic waves by phase velocityscanning of a laser interference fringe,” Appl. Phys. Lett. 62, 2036–2038(1993).13A. Arca, J. Aylott, L. Marques, M. Clark, M. Somekh, R. Smith, S.Sharples, T. Stratoudaki, and X. Chen, “CHOTs optical transducers,”Nondestruct. Testing Eval. 26, 353–366 (2011).14I. J. Collison, T. Stratoudaki, M. Clark, and M. G. Somekh, “Measurementof elastic nonlinearity using remote laser ultrasonics and cheap opticaltransducers and dual frequency surface acoustic waves,” Ultrasonics 48,471–477 (2008).15T. Stratoudaki, M. Clark, M. Somekh, and A. Arca, “Cheap optical trans-ducers (CHOTs) for generation and detection of longitudinal waves,” inIEEE International Ultrasonics Symposium (2012), pp. 961–964.16J. B. Deaton, Jr., A. D. W. McKie, J. B. Spicer, and J. W. Wagner,“Generation of narrow-band ultrasound with a long cavity mode-lockedNd:YAG laser,” Appl. Phys. Lett. 56, 2390–2392 (1990).17C. M. Grunsteidl, I. A. Veres, T. Berer, and P. Burgholzer, “Applicationof SLM generated patterns for laser-ultrasound,” in IEEE InternationalUltrasonics Symposium (2014), pp. 1360–1363.18A. Meyer, S. Gspan, S. Bernet, and M. Ritsch-Marte, “Tailoring ultrasonicbeams with optoacoustic holography,” Proc. SPIE Laser Resonators BeamControl VI 4969, 105–114 (2003).19S. D. Sharples, M. Clark, and M. G. Somekh, “All-optical adaptive scan-ning acoustic microscope,” Ultrasonics. 41, 295–299 (2003).20S. Gspan, A. Meyer, S. Bernet, and M. Ritsch-Marte, “Synthetic acousticholograms realised via optoacoustic methods,” Proc. SPIE PhotonsUltrasound 5697, 99–106 (2005).21M. D. Brown, T. J. Allen, B. T. Cox, and B. E. Treeby, “Control of opti-cally generated ultrasound fields using binary amplitude holograms,” inIEEE International Ultrasonics Symposium (2014), pp. 1037–1040.22B. E. Treeby and B. T. Cox, “k-Wave: MATLAB toolbox for the simula-tion and reconstruction of photoacoustic wave-fields,” J. Biomed. Opt. 15,021314 (2010).23J. Jaros, A. P. Rendell, and B. E. Treeby, “Full-wave nonlinear ultrasoundsimulation on distributed clusters with applications in high-intensityfocused ultrasound,” Int. J. High Performance Comput. Appl. 1–19(2015).24G. W. Webb, I. V. Minin, and O. V. Minin, “Variable reference phase indiffractive antennas: Review, applications, new results,” Antennas Propag.Mag. 53, 77–94 (2011).25P. Tsang, T. C. Poon, W. K. Cheung, and J. P. Liu, “Computer generationof binary Fresnel holography,” Appl. Opt. 50, 88–95 (2011).26M. Clark, “A direct search method for the computer design of holograms,”Ph.D. thesis, Imperial College, London, UK, 1997.27M. A. Seldowitz, J. P. Alleback, and D. W. Sweeney, “Synthesis of digitalholograms by direct binary search,” Appl. Opt. 26, 2788–2798 (1987).28D. J. Richardson, J. Nilsson, and W. A. Clarkson, “High power fibre lasers:Current status and future perspectives [Invited],” J. Opt. Soc. Am. B 27,B63–B92 (2010).J. Acoust. Soc. Am. 139 (4), April 2016 Brown et al. 1647