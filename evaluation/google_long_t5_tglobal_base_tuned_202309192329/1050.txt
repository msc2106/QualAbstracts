ABSTRACT: 
The acoustic fields and streaming in a confined fluid depend strongly on the acoustic boundary layer forming near the wall. The width of this layer is typically much smaller than the bulk length scale set by the geometry or the acoustic wavelength, which makes direct numerical simulations challenging. Based on this separation in length scales, we extend the classical theory of pressure acoustics by deriving a boundary condition for the acoustic pressure that takes boundary-layer effects fully into account. Using the same length-scale separation for the steady second-order streaming, and combining it with time-averaged short-range products of first-order fields, we replace the usual limiting-velocity theory with an analytical slip-velocity condition on the long-range streaming field at the wall. The derived boundary conditions are valid for oscillating cavities of arbitrary shape and wall motion as long as the wall curvature and displacement amplitude are both sufficiently small. Finally, we validate our theory by comparison with direct numerical simulation in two examples of two-dimensional water-filled cavities: The well-studied rectangular cavity with prescribed wall actuation, and the more generic elliptical cavity embedded in an externally actuated rectangular elastic glass block.Comment: 18 pages, 5 figures, pdfLatex, RevTe. 
 
PREDICTION: 
We develop a theory for pressure acoustics with boundary-layers and streaming that allows calculations of the pressure field and bulk streaming field which both varies on the much longer length scale d. First, we extend the classical pressure acoustics by formulating a boundary condition for the acoustic pressure that includes the presence of the boundary layer, which is otherwise neglected. Second, we formulate a generalized slip boundary condition for bulk acoustic streaming over curved oscillating surfaces. An important step in this direction was the development of the limiting-velocity theory by Nyborg in 1958 for perpendicularly oscillating curved walls. Later modifications of this theory comprise modifications to the analysis in curvilinear coordinates by Lee and Wang in 1989, and the treatment of oscillations in any direction for flat walls by Vanneste and Buhler in 2011. Here, we extend these theories to harmonic oscillations in any direction of an arbitrarily shaped, elastic wall provided that both the radius of curvature and the acoustic wavelength are much larger than the boundary layer length-scale d, and that also the amplitude of the perpendicular surface vibration is much smaller than d. Notably, the theoretical description developed here allows numerical simulations of the linear and nonlinear acoustics in arbitrarily shaped liquid-filled cavities embedded in oscillating elastic solids. Examples and validation of such simulations for two-dimensional (2D) systems are presented in the final sections of this paper, while a study of three-dimensional (3D) systems is work in progress to be presented later. 
 
FULL TEXT: 
  I. INTRODUCTION The study of ultrasound effects in fluids in sub- millimeter cavities and channels has intensified the past decade, as microscale acoustofluidic devices are used in- creasingly in biology, environmental and forensic sci- ences, and clinical diagnostics [1, 2]. Examples include cell synchronization [3], enrichment of prostate cancer cells in blood [4], size-independent sorting of cells [5], manipulation of C. elegans [6], and single-cell pattern- ing [7]. Acoustics can also be used for non-contact mi- crofluidic trapping and particle enrichment [8–10] as well as acoustic tweezing [11–14]. The two fundamental physical phenomena that enable these microscale acoustofluidic applications are rooted in nonlinear acoustics. One fundamental phenomenon is the acoustic radiation force, which tends to focus suspended particles in pressure nodes based on their acoustic con- trast to the surrounding fluid [15–21]. The second funda- mental phenomenon is the acoustic streaming appearing as steady flow rolls which tend to defocus suspended par- ticles due to Stokes drag [22–27]. Because the acoustic radiation force scales with the volume of the suspended particle, and the Stokes drag with its radius, the former dominates for large particles and the latter for small. For water at room temperature and 1 MHz ultrasound, the critical particle radius for the crossover between these two regimes has been determined to be around 2 µm [28, 29]. So far, the vast majority of successful microscale acoustofluidics applications has been for large (above 2 µm) particles, such as cells, whose dynamics is dom- ∗ jasoba@fysik.dtu.dk † bruus@fysik.dtu.dk inated by the well-characterized, robust acoustic radia- tion force, which depends on the bulk properties of the acoustic field and material parameters of the particles and the surrounding fluid. However, there is a strong motivation to handle also sub-micrometer particles such as bacteria, exosomes, and viruses, for use in contem- porary lab-on-a-chip-based diagnostics and biomedical research [9, 30–32]. In contrast to large particles, the dynamics of small (sub-micrometer) particles is domi- nated by the drag force from the ill-characterized acoustic streaming, and because this streaming is partly driven by the Reynolds stress in the sub-micrometer-thin acoustic boundary layers, it becomes highly sensitive to details of the geometry, motion, and temperature of the con- fining oscillating walls. To control the handling of such nanoparticle suspensions, a deeper understanding of the often complicated acoustic streaming is called for. One important aspect of ultrasound acoustics is the large velocity gradients in the acoustic boundary layer near rigid boundaries [22]. The Reynolds stress build- ing up in this region is responsible for both the viscous damping of the harmonic acoustic fields and for the gen- eration of time-averaged momentum flux giving rise to acoustic streaming. In water with kinematic viscosity ν0 ≈ 10−6 m2/s at the frequency f = 12piω ≈ 1 MHz, the thickness δ = √ 2ν0/ω of this boundary layer is of the order of 500 nm, while the acoustic wavelength is around 1.5 mm. This three-orders-of-magnitude separa- tion of physically relevant length scales poses a severe challenge for numerical simulations. To circumvent the problem of resolving the thin boundary layer, we develop a theory for pressure acoustics with boundary-layers and streaming that allows calculations of the pressure field and bulk streaming field which both varies on the much longer length scale d δ. First, we extend the classical pressure acoustics the- ar X iv :1 80 4. 05 80 2v 1 [p hy sic s.f lu- dy n] 1 6 A pr 20 18 2ory by formulating a boundary condition for the acous- tic pressure that includes the presence of the boundary layer, which is otherwise neglected. Thus, our extended boundary condition takes into account important effect of the boundary layer, such as increased viscous damp- ing, shifts in resonance frequencies, and shear stresses on the surrounding walls. Second, we formulate a generalized slip boundary con- dition for bulk acoustic streaming over curved oscillat- ing surfaces. An important step in this direction was the development of the limiting-velocity theory by Ny- borg in 1958 [33] for perpendicularly oscillating curved walls. Later modifications of this theory comprise modi- fications to the analysis in curvilinear coordinates by Lee and Wang in 1989 [34], and the treatment of oscillations in any direction for flat walls by Vanneste and Bu¨hler in 2011 [35]. Here, we extend these theories to harmonic os- cillations in any direction of an arbitrarily shaped, elastic wall provided that both the radius of curvature and the acoustic wavelength are much larger than the boundary layer length-scale δ, and that also the amplitude of the perpendicular surface vibration is much smaller than δ. Notably, the theoretical description developed here al- lows us to perform numerical simulations of the linear and nonlinear acoustics in arbitrarily shaped liquid-filled cavities embedded in oscillating elastic solids. Examples and validation of such simulations for two-dimensional (2D) systems are presented in the final sections of this paper, while a study of three-dimensional (3D) systems is work in progress to be presented later. II. WALL MOTION AND PERTURBATION THEORY We consider a fluid domain Ω bounded by an elastic, oscillating solid, see Fig. 1. All acoustic effects in the fluid are generated by the fluid-solid interface that oscillates harmonically around its equilibrium position, denoted s0 or ∂Ω, with an angular frequency ω. The instantaneous position s(s0, t) at time t of this interface (the wall), is described by the small complex displacement s1(s0)e −iωt, s(s0, t) = s0 + s1(s0) e −iωt. (1) In contrast to Muller and Bruus [36], we do not study the transient phase leading to this steady oscillatory motion. A. Fundamental conservation laws in acoustofluidics The theory of acoustofluidics in Ω is derived from the conservation of the fluid mass and momentum density, ∂tρ = −∇· (ρv), (2a) ∂t(ρv) = −∇· [(ρv)v] +∇· σ, (2b) FIG. 1. Sketch of the interface between a fluid (light blue, Ω) and a curved, oscillating solid (gray) with instantaneous position s (green line) and equilibrium position s0 (black line, ∂Ω). The local curvilinear coordinate system on the interface is given by the tangent vectors eξ and eη and the normal vec- tor eζ . By a Helmholtz decomposition, the first-order acoustic fluid velocity v1 = v d 1 + v δ 1 is written as the sum of a long- range compressible part v d 1 (blue) extending into the bulk and a short-range incompressible part v δ 1 (red) with a decay length equal to the boundary-layer width δ. V 0 1 = v d0 1 + v δ0 1 is the Lagrangian velocity of the interface (the wall). where ρ is the mass density, v is the Eulerian fluid veloc- ity, and σ is the viscous stress tensor, given by σ = −p I + τ , (2c) τ = ηb0 (∇· v)I + η0 [ ∇v + (∇v)T − 2 3 (∇· v)I ] . (2d) Here, p is the pressure, and τ is the viscous part of the stress tensor given in terms of the bulk viscosity ηb0 , the dynamic viscosity η0, the identity matrix I, and the su- perscript ”T” denoting matrix transpose. We introduce the isentropic compressibility κ0 and speed of sound c0, κ0 = 1 ρ0 ( ∂ρ ∂p ) S = 1 ρ0c 2 0 , (3) as well as the dimensionless damping coefficient Γ in terms of the viscosity ratio β, Γ = (β + 1)η0ωκ0, β = ηb0 η0 + 1 3 . (4) B. Perturbation expansion The linear acoustic response of the system is propor- tional to the displacement stimulus s1(s0)e −iωt, and the resulting complex-valued quantities Q1(r)e −iωt are called first-order fields with subscript ”1”. The physical time- dependent quantity Qphys1 (r, t) corresponding to Q1 is given by the real part Qphys1 (r, t) = Re [ Q1(r) e −iωt]. As the governing equations are nonlinear, we also en- counter higher-order terms. In the present work, we only include terms to second order in the stimulus. More- over, since we are only interested in the steady part 3of these second-order fields, we let in the following the subscript ”2” denote a time-averaged quantity, written as Q2(r) = 〈 Q2(r, t) 〉 = ω2pi ∫ 2pi/ω 0 Q2(r, t) dt. Time- averages of products of time-harmonic complex-valued first-order fields A1 and B1 are also of second order, and for those we have 〈 A1B1 〉 = 12Re [ A1(r)B ∗ 1(r) ] , where the asterisk denote complex conjugation. Using this notation for the fluid, we expand the mass density ρ, the pressure p, and the velocity v in perturba- tion series of the form, ρ = ρ0 + ρ1(r)e −iωt + ρ2(r), (5a) p = p0 + p1(r)e −iωt + p2(r), (5b) v = 0 + v1(r)e −iωt + v2(r), (5c) where ρ1  ρ0, p1 = c 20 ρ1  c 20 ρ0, and ∣∣v1∣∣  c0. The subscripts 1 and 2 denote the order in the small acoustic Mach number Ma = |v1| /c0, which itself is proportional to s1. C. No-slip boundary condition at the wall To characterize the wall motion, we compute the time derivative of s(s0, t) in Eq. (1), ∂ts(s0, t) = −iωs1(s0) e−iωt = V 01 (s0) e−iωt, (6) where V 01 (s0) = −iωs1(s0) is the Lagrangian velocity of the wall surface element with equilibrium position s0 and instantaneous position s. The no-slip boundary con- dition on the Eulerian fluid velocity v(r, t) is imposed at the instantaneous surface position s(t),[35, 37] v(s0 + s1e −iωt, t) = V 01 (s0) e −iωt, no-slip condition. (7) Combining Eqs. (7) and (5c) with the Taylor expansion v1(s0 + s1, t) ≈ v1(s0) e−iωt + 〈 (s1 ·∇)v1(s0) 〉 , and col- lecting the terms order by order, gives v1(s0) = V 0 1 (s0), 1st-order condition, (8a) v2(s0) = − 〈 (s1 ·∇)v1 〉∣∣ s0 , 2nd-order condition. (8b) Note that the expansion, or Stokes drift, in Eq. (8b) is valid if the length scale over which v1 varies is much larger than |s1|. So we require |s1‖|  d and |s1ζ |  δ. D. Local boundary-layer coordinates In the boundary layer, we introduce the local coordi- nates ξ, η, and ζ. The latter measures distance away from the surface equilibrium position along the surface unit normal vector eζ , while the tangential coordinates ξ and η increase in the respective directions of the unit tangent vectors eξ and eη, but not necessarily measuring arc length. We define differential-geometric symbols, hi = |∂ir| , Tkji = ( ∂˜kej )·ei, for i, j, k = ξ, η, ζ, (9a) ∂˜i = 1 hi ∂i, Hk = Tiki = ∂˜k [∑ i6=k log hi ] , (9b) and use them to write the following derivatives involving a scalar field g and two vector fields A and B in the local right-handed, orthogonal, curvilinear coordinate system, ∇ = ei∂˜i, (10a) ∇2g = (∂˜i∂˜i +Hi∂˜i)g, (10b) ∇·A = (∂˜i +Hi)Ai, (10c) (A ·∇)B = Ak ( ∂˜kBi + TkjiBj ) ei, (10d) where summation over repeated indices is implied. Note that since ζ measures arc length, we have hζ = 1 and consequently ∂˜ζ = ∂ζ . It is useful to introduce parallel and perpendicular differential operators ∇‖ and ∇ζ , ∇‖ = eξ∂˜ξ + eη∂˜η, ∇ζ = eζ ∂˜ζ , (11a) ∇‖ ·A = (∂˜α +Hα)Aα, sum over α = ξ, η, (11b) ∇ζ ·A = (∂˜ζ +Hζ)Aζ , (11c) (A·∇‖)B = Aα ( ∂˜αBi + TαjiBj ) ei. (11d) where repeated Greek index α only sums over ξ and η. E. Surface fields, boundary-layer fields, and bulk fields For fluid fields, we distinguish between boundary-layer fields and bulk fields with superscripts ”δ” and ”d”, re- spectively, denoting the length scale of the variations in the perpendicular direction eζ as shown in Fig. 1. Here, δ = √ 2ν0 ω = √ 2η0 ρ0ω ≈ 500 nm (water at 1 MHz), (12) is the short, shear length scale of the acoustic boundary layer, while d is the long compressional length scale being the minimum of the local surface curvature length scale R and the inverse wave number k−10 = c0/ω for sound speed c0. We introduce the ratio  of these length scales,  = δ d  1, (13) where the inequality holds if both k0δ  1 and δ/R 1, a condition usually satisfied in microfluidic devices. The central point in our theory is that we analyze the weakly curved, thin boundary-layer limit   1, where 4derivatives of boundary-layer fields are included only to lowest order in . In this limit, several simplifications can be made, which ultimately allows for analytical results. It is useful to decompose a vector A into parallel and perpendicular components A‖ and Aζ , respectively, A = A‖ +Aζ , with Aζ = (A · eζ) eζ = Aζ eζ . (14) The Laplacian of a boundary-layer scalar gδ, Eq. (10b), and the divergence of a boundary-layer vector Aδ, Eq. (10c), reduce to ∇2gδ ≈ ∂2ζgδ, (15a) ∇·Aδ ≈∇‖ ·Aδ‖ + ∂ζAδζ . (15b) Further reductions are obtained by separating in the per- pendicular coordinate ζ, A(ξ, η, ζ) = A0(ξ, η)a(ζ), ζ  d, (16a) for any field A in the fluid boundary layer. Here, su- perscript ”0” defines a surface field A0(ξ, η) = A(ξ, η, 0), such as the wall velocity V 01 and the fluid velocity v 0 at the wall. Note that a surface field does not have a per- pendicular derivative, although it does have a perpendic- ular component. For surface fields Eqs. (10c) and (10d) become, ∇·A0 =∇‖ ·A0‖ +HζA0ζ , (16b) (A0 ·∇)B0 = [(A0‖ ·∇‖)B0i ]ei +A0kB0jTkjiei. (16c) With this, we have established the necessary notation. In summary, the length-scale conditions for the following boundary-layer theory to be valid are, Compressional length scale d = min { R, k−10 } , δ  d, Parallel wall displacement |s1‖| , |s1‖|  d, Perpendicular wall displacement |s1ζ |, |s1ζ |  δ. (17) III. FIRST-ORDER TIME-HARMONIC FIELDS To first order in Ma = 1c0 |v1|, Eqs. (2) and (5) give, p1 = c 2 0 ρ1, (18a) −iωp1 = −ρ0c20∇· v1, (18b) −iωρ0v1 = −∇[p1 − (ηb0 + 1 3 η0)∇· v1] + η0∇2v1, (18c) We make a standard Helmholtz decomposition of the ve- locity field v1,[21, 33, 34, 37] v1 = v d 1 + v δ 1, where ∇× vd1 = 0 and ∇· vδ1 = 0, (19) and insert it in Eq. (18). We assume that the equations separate in solenoidal and irrotational parts and find iωκ0p1 =∇· vd1 , (20a) −iωρ0vd1 =∇· σd1 = −(1− iΓ)∇p1, (20b) −iωρ0vδ1 =∇· σδ1 = η0∇2vδ1. (20c) From this, we derive Helmholtz equations for the bulk fields p1 and v d 1 as well as for the boundary-layer field v δ 1, ∇2p1 + k2cp1 = 0, where kc = k0 ( 1 + i Γ 2 ) , (21a) ∇2vd1 + k2cvd1 = 0, (21b) ∇2vδ1 + k2svδ1 = 0, where ks = 1 + i δ . (21c) Here, we have introduced the compressional wavenumber kc in terms of k0 = ω/c0 and Γ defined in Eq. (4), and the shear wave number ks in terms of δ. Note that Γ is of second order in , Γ = 1 + β 2 ( k0δ )2 ∼ 2  1. (22) From Eq. (20b) follows that the long-range velocity vd1 is a potential flow proportional to ∇p1, and as such it is the fluid velocity of pressure acoustics. The short-range velocity vδ1 is confined to the thin boundary layer of width δ close to the surface, and therefore it is typically not ob- served in experiments and is ignored in classical pressure acoustics. In the following we derive an analytic solution for the boundary-layer field vδ1, which is used to deter- mine a boundary condition for p1. In this way, the viscous effects from the boundary layer are taken into account in computations of the long-range pressure-acoustic fields p1 and v d 1 . A. Analytical form of the first-order boundary-layer field Using Eq. (15a), we derive an analytical solution to Eq. (21c) and find that it describes a shear wave heavily damped over a single wave length, as it travels away from the surface with speed cs = ωδ  c0, vδ1 = v δ0 1 e iksζ +O(). (23) To satisfy the boundary condition (8a), we impose the following condition for vδ01 at the equilibrium position r = s0 of the wall, vδ01 = V 0 1 − vd01 , first-order no-slip condition. (24) B. Boundary condition for the first-order pressure field We now derive a boundary condition for the first- order pressure field p1, which takes the viscous boundary layer effects into account without explicit reference to v1. First, it is important to note that the incompressibility condition ∇ · vδ1 = 0 used on Eq. (23) leads to a small perpendicular short-range velocity, vδ01ζ = i ks ∇· vδ01 = i ks ∇· V 01 − i ks ∇· vd01 . (25) 5In the following, we repeatedly exploit the smallness of this velocity component, |vδ01ζ | ∼ |v1|  |v1|. Using the no-slip condition (24), the boundary condition on the long-range velocity becomes, vd01ζ = V 0 1ζ − vδ01ζ (26a) = ( V 01ζ − i ks ∇· V 01 ) + i ks ∇· vd01 (26b) ≈ ( V 01ζ − i ks ∇‖ ·V 01‖ ) + i ks ∇‖ ·vd01‖ , (26c) where the last step is written for later convenience using i ks ∇ · (vd01 − V 01 ) = iks∇‖ ·(vd01‖ − V 01‖) − iHζks vδ01ζ from Eqs. (16b) and (24). Note that this boundary condition involves the usual expression V 01ζ used in classical pres- sure acoustics plus an O()-correction term proportional to k−1s , due to the parallel divergence of fluid velocity inside the boundary layer that forces a fluid flow perpen- dicular to the surface to fulfil the incompressibility of the short-range velocity component vδ1. Note also that this correction term is generated partly by the external wall motion − iks∇‖ ·V 0 1‖ and partly by the fluid motion itself i ks ∇‖·vd01‖ . Hence, the wall can affect the long-range fields either by a perpendicular component V 01ζ or by a parallel divergence∇‖·V 01‖. The correction term iks∇‖·v d0 1‖ due to the fluid motion itself gives the boundary-layer damping of the acoustic energy, see Section IV. Finally, we write Eq. (26b) in terms of the pressure p1 using ∇· vd01 =∇· vd1 − ∂ζvd1ζ and Eq. (20), ∂ζp1 = iωρ0 1− iΓ ( V 01ζ − i ks ∇· V 01 ) − i ks ( k2cp1 + ∂ 2 ζp1 ) , boundary condition at r = s0 ∈ ∂Ω. (27) C. Boundary condition for the first-order normal stress The boundary condition for the first-order normal stress σ1 · eζ on the surrounding wall is found using Eqs. (2c) and (2d). Here, the divergence term can be ne- glected, because Eq. (20a) leads to |η0∇·vd1 | ≈ η0k 2 0 ωρ0 p1 ≈ Γp1  p1. Further, the viscous stress is dominated by the term with ∂ζv δ 1, and we obtain σ1 · eζ = −p1eζ + η0∂ζvδ1, at r = s0 ∈ ∂Ω. (28) Using solution (23) for the short-range velocity vδ1, we find ∂ζv δ 1 = iksv δ 1, which after using Eqs. (20b) and (24) can be expressed only with reference to the long-range pressure p1 and wall velocity V 0 1 , σ1 · eζ = −p1eζ + iksη0 ( V 01 + i ωρ0 ∇p1 ) , boundary condition at r = s0 ∈ ∂Ω. (29) This is the usual pressure condition plus a correction term of due to viscous stress from the boundary layer. Equations (21), (26), (27), and (29) constitute our main theoretical result for the first-order acoustic fields. IV. ACOUSTIC POWER LOSS From the pressure p1, we derive an expression for the acoustic power loss solely in terms of long-range fields. First, we introduce the energy density Edac and the energy-flux density Sdac of the long-range acoustic fields, Edac(r, t) = 1 2 [ Re(p1e −iωt) ]2 + 1 2 ρ0 ∣∣Re(vd1e−iωt)∣∣2, (30a) Sdac(r, t) = Re ( p1e −iωt) Re(vd1e−iωt), (30b) with the time averages〈 Edac 〉 = 1 4 κ0|p1|2 + 1 4 ρ0|vd1 |2, (31a)〈 Sdac 〉 = 〈 p1v d 1 〉 = c 2 0 〈 ρ1v d 1 〉 . (31b) In terms of real-valued physical quantities, Eqs. (18b) and (20b) become ∂tRe(p1e −iωt) = −ρ0c 20∇·Re(vd1e−iωt) and ρ0∂tRe ( vd1e −iωt) = −∇Re[(1− iΓ)p1e−iωt]. Taking the scalar product of Re(vd1e −iωt) with the latter leads to expressions for the time derivative ∂tE d ac and its time- averaged value 〈 ∂tE d ac 〉 , which is zero due to the har- monic time dependence, ∂tE d ac = −∇· Sdac − Γρ0ω ∣∣Re(vd1e−iωt)∣∣2, (32a) −∇· 〈Sdac〉 = 12Γωρ0∣∣vd1 ∣∣2. (32b) The latter expression describes the local balance between the convergence of energy flux due to pressure and the rate of change of acoustic energy due to the combined effect of viscous dissipation and viscous energy flux, see Appendix A for a more detailed discussion of this point. Integrating Eq. (32b) over the entire fluid domain Ω, and using Gauss’s theorem with the ζ-direction pointing into Ω, leads to the global balance of energy rates,∫ ∂Ω 〈 p1v d0 1ζ 〉 dA = ∫ Ω 1 2 Γρ0ω|vd1 |2 dV. (33) Note that this general result only reduces to that of classi- cal pressure acoustics in the special case where vd01ζ = V 0 1ζ . As seen from Eq. (26c), vd01ζ is generated partly externally by the wall motion, and partly internally by the fluid mo- tion. Inserting Eq. (26c) into Eq. (33), and separating wall-velocity terms from fluid-velocity terms gives,∮ ∂Ω 〈 p1 ( V 01ζ − i ks ∇‖ ·V 01‖ )〉 dA (34) = ∫ Ω 1 2 Γρ0ω|vd1 |2 dV − ∮ ∂Ω 〈 p1 ( i ks ∇‖ ·vd01‖ )〉 dA. 6Here, the left-hand side represents the acoustic power gain due to the wall motion, while the right-hand side represents the acoustic power loss 〈 P dloss 〉 due to the fluid motion. Integrating the last term by parts and using that∮ ∂Ω ∇‖ · 〈 p1 ( i ks vd01‖ )〉 dA = 0 for any closed surface, we can by Eq. (20b) rewrite 〈 P dloss 〉 to lowest order in Γ as, 〈 P dloss 〉 = ω ∫ Ω Γ 2 ρ0|vd1 |2 dV +ω ∮ ∂Ω δ 4 ρ0 ∣∣vd01‖∣∣2 dA, (35) which is always positive. The quality factor Q of an acoustic cavity resonator can be calculated from the long- range fields 〈 Edac 〉 in Eq. (31a) and 〈 P dloss 〉 in Eq. (35) as Q = ωres ∫ Ω 〈 Edac 〉 dV〈 P dloss 〉 . (36) We emphasize that in general, 〈 Ploss 〉 is not identical to the viscous heat generation 〈 P dissvisc 〉 = ∫ Ω 〈∇v1 : τ1〉 dV , although as discussed in Appendix A, these might be approximately equal in many common situations[38]. V. SECOND-ORDER STREAMING FIELDS The acoustic streaming is governed by the time- averaged part of Eq. (2) to second order in Ma = 1c0 |v1|, together with the boundary condition Eq. (8b), 0 =∇· (ρ0v2 + 〈ρ1v1〉), for r ∈ Ω, (37a) 0 =∇· σ2 − ρ0∇· 〈 v1v1 〉 , for r ∈ Ω, (37b) 0 = v2 + 〈 (s1 ·∇)v1 〉 , for r = s0 ∈ ∂Ω. (37c) Again, we make a decomposition into long-range bulk fields ”d” and short-range boundary-layer fields ”δ”, v2 = v d 2 + v δ 2, (38a) p2 = p d 2 + p δ 2, (38b) σ2 = σ d 2 + σ δ 2, (38c) vd02 = −vδ02 − 〈 (s1 ·∇)v1 〉 , at r = s0 ∈ ∂Ω, (38d) but in contrast to the first-order decomposition (19), the second-order length-scale decomposition (38) is not a Helmholtz decomposition. Nevertheless, the computa- tional strategy remains the same: we find an analytical solution to the short-range ”δ”-fields, and from this de- rive boundary conditions on the long-range ”d”-fields. Note that our method to calculate the steady second- order fields differs from the standard method of matching ”inner” boundary-layer solutions with ”outer” bulk solu- tions. Our short- and long-range fields co-exist in the boundary layer, but are related by imposing boundary conditions on the instantaneous fluid-solid interface. A. Short-range boundary-layer streaming The short-range part of Eq. (37) consists of all terms containing at least one short-range ”δ”-field, 0 =∇· (ρ0vδ2 + 〈 ρ1v δ 1 〉 ), (39a) 0 = −ρ0∇· 〈 vδ1v δ 1 + v δ 1v d 1 + v d 1v δ 1 〉 +∇· σδ2, (39b) ∇· σδ2 =∇ (− pδ2 + βη0∇· vδ2)+ η0∇2vδ2, (39c) where vδ2 → 0 as ζ →∞. (39d) Notably, condition (39d) leads to a nonzero short-range streaming velocity vδ02 at the wall, which, due to the full velocity boundary condition (37c), in turn implies a slip condition (38d) on the long-range streaming velocity vd02 . First, we investigate the scaling of pδ2 by taking the divergence of Eq. (39b) and using Eq. (39a) together with ∇· vδ1 = 0 and Eq. (20), ∇2pδ2 =− ν0(1 + β)∇2 〈 vδ1 ·∇ρ1 〉 − ρ0∇· (∇· 〈 vδ1v δ 1 + v δ 1v d 1 + v d 1v δ 1 〉 ) (40a) =− ρ0Γ∇2 〈 vδ1 ·(ivd1) 〉 + 2ρ0k 2 0 〈 vδ1 ·vd1 〉 − ρ0 〈∇(2vd1 + vδ1) : (∇vδ1)T〉. (40b) Recalling that |vδ01ζ | ∼ δd−1v1 from Eq. (25), we find |ρ0(∇vd1) : (∇vδ1)T| ∼ (δd)−1ρ0v21 which is the largest possible scaling of the right-hand side. Since by defini- tion pδ2 is a boundary-layer field, we have |∇2pδ2| ∼ δ−2pδ2, and the maximal scaling of |pδ2| becomes, |pδ2| . ρ0v21 . (41) Thus, ∇pδ2 can be neglected in the parallel component of Eq. (39b), but not necessarily in the perpendicular one. Similarly in Eq. (39c) we have ∇(βη0∇ · vδ2) = −βν0∇ 〈 vδ1·∇ρ1 〉 which scales as βη0d −2 v21 c0 which is much smaller than |η0∇2vδ01‖| ∼ η0δ−2 v 2 1 c0 . Henceforth, using the approximation (15a) for the boundary-layer field vδ2 in Eq. (39b), we get the paral- lel equation to lowest order in , ν0∂ 2 ζv δ 2‖ = [ ∇· 〈vδ1vd1 + vd1vδ1 + vδ1vδ1〉]‖. (42a) Combining this with Eq. (39a), and using Eqs. (15b) and (19), leads to an equation for the perpendicular com- ponent vδ2ζ of the short-range streaming velocity, ∂ζv δ 2ζ = −∇‖ ·vδ2‖ − 1 ρ0 〈 vδ1 ·∇ρ1 〉 . (42b) To determine the analytical solution for vδ2‖ in Eq. (42a), we need to evaluate divergence terms of the 7form∇·〈vα1 vβ1 〉, with α, β = d, δ. To this end, we Taylor- expand vd1 to first order in ζ in the boundary layer, and use the solution (23) for vδ1, vd1 = v d0 1 + ( ∂ζv d 1 )0 ζ, for ζ  d, (43a) vδ1 = v δ0 1 q(ζ), with q(ζ) = e iksζ . (43b) With these expressions, Eq. (42a) becomes, ν0∂ 2 ζv δ 2‖ = { ∇· 〈[ vδ01 q ][ vd01 1 ] + [ vδ01 q ][ (∂ζv d 1) 0ζ ] (44) + [ vd01 1 ][ vδ01 q ] + [ (∂ζv d 1) 0ζ ][ vδ01 q ] + [ vδ01 q ][ vδ01 q ]〉} ‖ . In general, the divergence ∇ · 〈A1B1〉 of the time- averaged outer product of two first-order fields of the form A1 = A 0 1(ξ, η) a(ζ) and B1 = B 0 1(ξ, η) b(ζ), is ∇· 〈[A01a][B01b]〉 = 12Re{∇· [(A01a)(B01b)∗]} (45a) = 1 2 Re { ∇· [ (ab∗) ( A01B 0∗ 1 )]} (45b) = 1 2 Re { ab∗∇· (A01B0∗1 )+A01(B0∗1 ·∇)(ab∗)} (45c) = 1 2 Re { ab∗∇· (A01B0∗1 )+A01B0∗1ζ∂ζ(ab∗)}. (45d) When solving for vδ02‖ in Eq. (42a), we must integrate such divergences twice and then evaluate the result at the surface ζ = 0. Straightforward integration yields∫ ζ dζ2 ∫ ζ2 dζ1∇· [( A01a(ζ1) )( B01b(ζ1) )∗]∣∣∣∣ ζ=0 = 1 2 Re { I (2) ab ∇· ( A01B 0∗ 1 ) + I (1) ab A 0 1B 0∗ 1ζ } , (46a) where we have defined the integrals I (n) ab as, I (1) ab = ∫ ζ dζ1 a(ζ1) b(ζ1) ∗ ∣∣∣∣ ζ=0 , (46b) I (2) ab = ∫ ζ dζ2 ∫ ζ2 dζ1 a(ζ1) b(ζ1) ∗ ∣∣∣∣ ζ=0 , (46c) I (3) ab = ∫ ζ dζ3 ∫ ζ3 dζ2 ∫ ζ2 dζ1 a(ζ1) b(ζ1) ∗ ∣∣∣∣ ζ=0 . (46d) We choose all integration constants to be zero to fulfil the condition (39d) at infinity. From Eq. (44) we see that the functions a(ζ) and b(ζ) in our case are q(ζ), ζ or unity. By straightforward integration, we find in increasing order of δ, I(1)qq = − 1 2 δ, I (1) q1 = − 1 + i 2 δ, (46e) I(2)qq = 1 4 δ2, I (2) q1 = i 2 δ2, I (1) qζ = − i 2 δ2, I(3)qq = − 1 8 δ3, I (3) q1 = 1− i 4 δ3, I (2) qζ = − 1− i 2 δ3. Using Eq. (46) and vδ01ζ ∼  ∣∣vδ01‖| from Eq. (25), we find vδ02‖ by integration of Eq. (44) to leading order in , vδ02‖ = 1 2ν0 Re { I(2)qq ∇· ( vδ01 v δ0∗ 1 ) + I (2) q1 ∇· ( vδ01 v d0∗ 1 ) + I (2) 1q ∇· ( vd01 v δ0∗ 1 ) + I(1)qq v δ0 1 v δ0∗ 1ζ + I (1) 1q v d0 1 v δ0∗ 1ζ + I (1) q1 v δ0 1 v d0∗ 1ζ + I (1) qζ v δ0 1 ∂ζv d∗ 1ζ } ‖ . (47) Remarkably, the term I (1) q1 v δ0 1 v d0∗ 1ζ scales with a factor  −1 compared to all other terms, and thus may dominate the boundary-layer velocity. However, in the computation of the long-range slip velocity vd02‖ in Section V B, its contri- bution is canceled by the Stokes drift 〈 s1 ·∇v1 〉 , as also noted in Ref. [35]. Using vd01 = V 0 1 − vδ01 , the property (I (n) ab ) ∗ = I(n)ba , and rearranging terms gives, vδ02‖ = 1 2ν0 Re {( I(2)qq − 2ReI(2)q1 ) ∇· (vδ01 vδ0∗1 ) + I (2) q1 ∇· ( vδ01 V 0∗ 1 ) + I (2) 1q ∇· ( V 01 v δ0∗ 1 ) + ( I(1)qq − 2ReI(1)q1 ) vδ01 v δ0∗ 1ζ + I (1) 1q V 0 1 v δ0∗ 1ζ + I (1) q1 v δ0 1 V 0∗ 1ζ + I (1) qζ v δ0 1 ∂ζv d∗ 1ζ } ‖ . (48) The perpendicular short-range velocity component vδ02ζ is found by integrating Eq. (42b) with respect to ζ. The integration of the ∇‖ ·vδ2‖-term is carried out by simply increasing the superscript of the I (n) ab -integrals in Eq. (48) from ”(n)” to ”(n + 1)”, while the integration of the ∇ρ1-term is carried out by using Eq. (20b) to substi- tute 1ρ0 ∇ρ1 by iωc−20 vd1 and introducing the suitable I (n) ab -integral for the factor q(ζ) i, namely I (1) qi = −iI(1)q1 , vδ02ζ = − 1 2ν0 ∇‖ ·Re {( I(3)qq − 2ReI(3)q1 ) ∇· (vδ01 vδ0∗1 ) + I (3) q1 ∇· ( vδ01 V 0∗ 1 ) + I (3) 1q ∇· ( V 01 v δ0∗ 1 ) + ( I(2)qq − 2ReI(2)q1 ) vδ01 v δ0∗ 1ζ + I (2) 1q V 0 1 v δ0∗ 1ζ + I (2) q1 v δ0 1 V 0∗ 1ζ + I (2) qζ v δ0 1 ∂ζv d∗ 1ζ } ‖ + k0 2c0 Re { iI (1) q1 v δ0 1 · vd0∗1 } . (49) Evaluation of the expressions (48) and (49) for vδ02‖ and vδ02ζ is straightforward. Using Eq. (46e), the analytical expressions for the short-range streaming at the surface ζ = 0 become, vδ02‖ = 1 2ω Re {1 2 ∇· (vδ01 vδ0∗1 )+ i∇· (vδ01 V 0∗1 ) − i∇· (V 01 vδ0∗1 )+ 1δvδ01 vδ0∗1ζ − ivδ01 ∂ζvd∗1ζ − 1− i δ V 01 v δ0∗ 1ζ − 1 + i δ vδ01 V 0∗ 1ζ } ‖ , (50a) 8and vδ02ζ =− δ 2ω Re [ ∇‖ · { − 5 4 ∇·(vδ01 vδ0∗1 ) (50b) + 1−i 2 ∇·(vδ01 V 0∗1 )+ 1+i2 ∇·(V 01 vδ0∗1 ) + 1 2δ vδ01 v δ0∗ 1ζ − i δ V 01 v δ0∗ 1ζ + i δ vδ01 V 0∗ 1ζ − (1−i)vδ01 ∂ζvd∗1ζ } ‖ − k20(1−i)vδ01 ·vd0∗1 ] = − 1 2ω Re [ ∇‖ · ( ivδ01‖V 0∗ 1ζ )] +O(). (50c) B. Long-range bulk streaming The long-range part of Eq. (37) is, 0 =∇· [ρ0vd2 + 〈 ρ1v d 1 〉 ], (51a) 0 = −ρ0∇· 〈 vd1v d 1 〉 +∇· σd2 , (51b) ∇· σd2 = −∇ ( pd2 − βη0∇· vd2 ) + η0∇2vd2 , (51c) vd02 = −vδ02 − 〈 (s1 ·∇)v1 〉 , at r = s0 ∈ ∂Ω. (51d) In contrast to the limiting-velocity matching at the edge of the boundary layer done by Nyborg [33], we define the boundary condition (51d) on the long-range streaming vd2 at the equilibrium position r = s0. We first investigate the products of first-order fields in Eq. (51). Using Eq. (32b) in Eq. (51a), we find ∇· vd2 = − ∇· 〈ρ1vd1〉 ρ0 = −∇· 〈 Sdac 〉 ρ0c 2 0 = Γ k0|vd1 |2 2c0 . (52) Since each term in∇·vd2 scales as k0c0 |v d 1 |2  Γ2 k0c0 |v d 1 |2, we conclude that ∇· vd2 ≈ 0 is a good approximation corre- sponding to ignoring the small viscous dissipation in the energy balance expressed by Eq. (32b). A similar scaling leads to βη0∇(∇·vδ2) η0∇2vd2 so βη0∇(∇·vδ2) can be ignored in Eq. (51c). Finally, the divergence of momen- tum flux in Eq. (51b) can be rewritten using Eq. (20b), ρ0∇· 〈 vd1v d 1 〉 = −∇〈Ldac〉− Γω c20 〈 Sdac 〉 , (53) where we introduced the long-range time-averaged acous- tic Lagrangian,〈Ldac〉 = 14κ0|p1|2 − 14ρ0|vd1 |2. (54) Note that |∇〈Ldac〉| ∼ ωp21ρ0c30 whereas |Γωc20 〈Sdac〉| ∼ Γ ωp21ρ0c30 , so the first term in Eq. (53) is much larger than the sec- ond term. However, as also noted by Riaud et al.[39], since the first term is a gradient, it is simply balanced hydrostatically by the second order long-range pressure pd2 and therefore it can not drive any streaming velocity. In practice, it is therefore advantageous to work with the excess pressure pd2 − 〈Ldac〉. With these considerations, Eqs. (51) become those of an incompressible Stokes flow driven by the body force Γω c 2 0 〈 Sdac 〉 and the velocity bound- ary condition, 0 =∇· vd2 , (55a) 0 = −∇ [ pd2 − 〈Ldac〉]+ η0∇2vd2 + Γω c20 〈 Sdac 〉 , (55b) vd02 = −vδ02 − 〈 (s1 ·∇)v1 〉∣∣ ζ=0 . (55c) These equations describe acoustic streaming in general. The classical Eckart streaming [40] originates from the body force Γω c 2 0 〈 Sdac 〉 , while the classical Rayleigh stream- ing [22] is due to the boundary condition (55c). The Stokes drift 〈 s1 ·∇v1 〉∣∣ ζ=0 , induced by the oscil- lating wall, is computed from Eqs. (6), (19), and (23), 〈 s1 ·∇v1 〉∣∣ ζ=0 = −1 2ω Re [ iV 0∗1 ·∇ ( vd1 + v δ0 1 q )] ζ=0 (56) = − 1 2ω Re [ iV 0∗1 ·∇ ( vd1 + v δ0 1 )− 1 + i δ V 0∗1ζ v δ0 1 ] . From this, combined with Eqs. (50) and (55c), follows the boundary condition vd02 for the long-range streaming velocity vd2 expressed in terms of the short-range velocity vδ02 and the wall velocity V 0 1 . The parallel component is vd02‖ = − 1 2ω Re { ∇· (1 2 vδ01 v δ0∗ 1 + iv δ0 1 V 0∗ 1 − iV 01 vδ0∗1 ) + 1 δ vδ01 v δ0∗ 1ζ − ivδ01 ∂ζvd∗1ζ − 1− i δ V 01 v δ0∗ 1ζ − iV 0∗1 ·∇ ( vd1 + v δ0 1 )} ‖ , (57a) where the large terms proportional to 1+iδ V 0∗ 1ζ v δ0 1‖ can- celed out, as also noted by Vanneste and Bu¨hler [35]. Similarly, the perpendicular component becomes vd02ζ = δ 2ω Re [ − k20(1−i)vδ01 · vd0∗1 +∇‖ · { ∇· [ − 5 4 vδ01 v δ0∗ 1 + 1+i 2 ( V 01 v δ0∗ 1 + v δ0∗ 1 V 0 1 )] + [ 1 2δ vδ0∗1ζ + i δ V 0∗1ζ − (1−i)∂ζvd∗1ζ ] vδ01 − i δ vδ0∗1ζ V 0 1 } ‖ ] + 1 2ω Re [ iV 0∗1 ·∇ ( vd1 + v δ0 1 )− 1+i δ V 0∗1ζ v δ0 1 ] ζ (57b) = 1 2ω Re [ ∇‖ · ( ivδ01‖V 0∗ 1ζ )− 1+i δ V 0∗1ζ v δ0 1ζ + { iV 0∗1 ·∇ ( vd1 + v δ0 1 )} ζ ] +O(). (57c) 9Taking the divergences in Eq. (57a) and using Eq. (25), as well as computing Eq. (57c) to lowest order in , leads to the final expression for the slip velocity, vd02 = ( A · eξ ) eξ + ( A · eη ) eη + ( B · eζ ) eζ , (58) A = − 1 2ω Re { vδ0∗1 ·∇ (1 2 vδ01 − iV 01 ) − iV 0∗1 ·∇vd1 + [ 2− i 2 ∇·vδ0∗1 + i ( ∇·V 0∗1 − ∂ζvd∗1ζ )] vδ01 } , B = 1 2ω Re { ieζ ( vδ01 ·∇ ) V 0∗1ζ + iV 0∗ 1 ·∇ ( vδ01 + v d 1 )} , where A and B are associated with the parallel and per- pendicular components vd02‖ and v d0 2ζ , respectively, and where we to simplify used ( vδ01‖ ·∇‖ ) V 0∗1ζ = ( vδ01 ·∇ ) V 0∗1ζ . Equations (55) and (58) constitute our main theoreti- cal result for the second-order acoustic streaming. VI. SPECIAL CASES In the following, we study some special cases of our main results (21a) and (27) for the acoustic pressure p1 and Eqs. (55) and (58) for the streaming velocity vd2 , and relate them to previous studies in the literature. A. Wall oscillations restricted to the perpendicular direction The case of a weakly curved wall oscillating only in the perpendicular direction was studied by Nyborg [33] and later refined by Lee and Wang [34]. Using our notation, the boundary conditions used in these studies were V 01 = v d0 1ζ eζ , (59a) vδ01 = −vd01‖ . (59b) For p1, using Eqs. (20b) and (59a), we obtain V 0 1 = − iωρ0 ∂ζp1eζ and∇·V 0 1 = Hζvd01ζ , whereby our boundary condition (27) to lowest order in Γ becomes, ∂ζp1 = iωρ0V 0 1ζ − 1 + i 2 δ ( k2cp1 +Hζ∂ζp1 + ∂2ζp1 ) . (60) Similarly for the steady streaming vd2 , we use Eq. (59b) to substitute all occurrences of vδ01 in the boundary con- dition Eq. (58) by −vd01‖ . Note that we then obtain ∇·vδ01 = −∇‖ ·vd01‖ = − (∇·vd1−∂ζvd1ζ−HζV 01ζ) evaluated at ζ = 0. Combining this expression with the derivative rule (16c) and the index notation ξ¯ = η and η¯ = ξ, as well as α, β = ξ, η, the boundary condition (58) for the tangential components becomes, vd02β = − 1 4ω Re { vd0∗1α ( ∂˜αv d0 1β ) + vd0∗1α v d0 1β¯Tαβ¯β (61a) − 2iV 0∗1ζ ∂ζvδ01β + (1− 2i)vδ0∗1α V 01ζTαζβ + [ (2−i)∇· vd∗1 − (2−3i)∂ζvd∗1ζ − (2+i)HζV 0∗1ζ ] vd1β } . and for the perpendicular component, vd02ζ = 1 2ω Re { ivd0∗1α ∂˜αV 0 1ζ + iV 0∗ 1ζ ∂ζv d 1ζ } . (61b) When comparing our expressions with the results of Lee and Wang [34], denoted by a superscript ”LW” be- low, we note the following. Neither the pressure p1 nor the steady perpendicular streaming velocity vd2ζ were studied by Lee and Wang, so our results Eqs. (60) and (61b) for these fields represent an extension of their work. The slip condition (61a) for the parallel streaming velocity vd2β with β = ξ, η is presented in Eqs. (19) LW and (20)LW as the limiting values uL and vL for the two parallel components of vd2 outside the boundary layer. A direct comparison is obtained by: (1) Identifying our vd1 with the acoustic velocity (ua0, va0, wa0) in LW, and our Tkji with Tijk in LW; (2) Taking the complex conjugate of the argument of the real value in Eq. (61a), and (3) noting that qx and qy defined in Eqs. (3) LW and (4)LW equal the first two terms of Eq. (61a). By inspection we find agreement, except that Lee and Wang are missing the terms −2iV 0∗1ζ ∂ζvδ01β + (1 − 2i)vδ0∗1α V 01ζTαζβ . The two terms with the prefactor ”2i” arise in our calculation from the Lagrangian velocity boundary condition (37c), where Lee and Wang have used the no slip condition v2 = 0, while the remaining term vδ0∗1α V 0 1ζTαζβ is left out by Lee and Wang without comment. B. A flat wall oscillating in any direction The case of a flat wall oscillating in any direction was studied by Vanneste and Bu¨hler [35]. In this case, we adapt Cartesian coordinates (ξ, η, ζ) → (x, y, z), for which all scale factors hi are unity, ∂˜i = ∂i, and all Christoffel symbols Tkji are zero. The resulting expres- sions for the boundary conditions (27) for the pressure and (27) for the long-range streaming vd2 then simplify 10 to ∂ζp1 = iωρ0V 0 1ζ − 1 + i 2 δ ( iωρ0∇· V 01 + k2cp1 + ∂2ζp1 ) , (62a) vd02β = − 1 4ω Re { (1− 2i)vδ0∗1α ∂αvδ01β − 4ivδ0∗1α ∂αvd01β + [ (2+i)∂αv δ0∗ 1α + 2i ( ∂αv d0∗ 1α −∂ζvd∗1ζ )] vδ01β − 2i vd∗1k∂kvd1β } , (62b) vd02ζ = − 1 4ω Re { − 2i vd∗1k∂kvd1ζ } . (62c) The pressure condition (62a) was not studied in Ref. 35, so it represents an extension of the existing theory. On the other hand, Eqs. (62b) and (62c) are in full agreement with Eq. (4.14) in Vanneste and Bu¨hler [35]. To see this, we identify our first-order symbols with those used in Ref. 35 as vd1 ↔ 2∇φˆ and vδ01‖ ↔ −2Uˆ1ex − 2Vˆ1ey, and we relate our steady Eulerian second-order long-range velocity vd2 with their Lagrangian mean flow u¯ L using the Stokes drift expression (37c) as vd2 + 1 ω 〈 ivd1 ·∇vd1 〉↔ u¯L at the interface z = 0. C. Small surface velocity compared to the bulk velocity At resonance in acoustic devices with a large resonator quality factor Q 1, the wall velocity V 01 is typically a factor Q smaller than the bulk fluid velocity vd1 ,[25, 36] V 01 ∼ Q−1vd1  vd1 . In this case, as well as for rigid walls, we use V 01 = 0 in Eq. (58), so that v δ0 1 ≈ −vd01 and〈 vδ01 ·∇vδ01 〉 ≈ 〈vd01 ·∇vd01 〉 = 〈vd01‖ ·∇‖vd01‖ + vd01‖ ·∇‖vd01ζ〉 ≈ 1 4 ∇‖|vd01‖ |2. (63) Here, we have neglected vd01ζ because |vd01ζ | ≈ |V 01ζ |  ∣∣vd01‖∣∣ and used that ∇ × vd1 = 0 from Eq. (19). Hence, the slip-velocity vd02 for devices with rigid walls V 0 1 = 0, or resonant devices with |vd01 |  |V 01 |, becomes vd02‖ = −1 8ω ∇‖ ∣∣vd01‖∣∣2− Re{(2− i4ω ∇‖ ·vd0∗1‖ + i2ω∂ζvd∗1ζ ) vd01‖ } , (64a) vd02ζ = 0. (64b) Two important limits are parallel acoustics, where |∂ζvd1ζ |  |∇‖ · vd01‖ |, and perpendicular acoustics, where |∂ζvd1ζ |  |∇‖ · vd01‖ |. In the first limit, the pressure is mainly related to the parallel velocity variations and from Eqs. (20a) and (20b) we have∇‖ ·vd1‖ = iωκ0p1 and vd01‖ = − iρ0ω∇‖p1. For parallel acoustics we can therefore write Eq. (64a) as, vd02‖ = 1 8ωρ0 ∇‖ ( 2κ0 ∣∣p1∣∣2 − ρ0∣∣vd01‖∣∣2)+ κ02 〈Sdac‖〉, (65a) for parallel acoustics, |∂ζvd1ζ |  |∇‖ · vd01‖ |. The classical period-doubled Rayleigh streaming[22], which arises from a one-dimensional parallel standing wave, results from the gradient-term in Eq. (65a). This is seen by considering a rigid wall in the x-y plane with a standing wave above it in the x direction of the form vd1 = v1a cos(k0x) ex, where v1a is a velocity amplitude. Inserting this into Eq. (65a) yields Rayleigh’s seminal boundary velocity vd02‖ = 38 v 2 1a c0 sin(2k0x) ex. Another equally simple example of parallel acoustics is the boundary condition generated by a planar travelling wave of the form vd1 = v1ae ik0xex. Here, only the energy- flux vector in Eq. (65a) contributes to the streaming velocity which becomes the constant value vd02‖ = 14 v 2 1a c0 ex. The opposite limit is perpendicular acoustics, where the pressure is mainly related to the perpendicular ve- locity variations ∂ζv d 1ζ = iωκ0p1. In this limit, Eq. (64a) is given by a single term, vd02‖ = −κ0 〈 Sdac‖ 〉 , (65b) for perpendicular acoustics, |∂ζvd1ζ |  |∇‖ · vd01‖ |. We emphasize that in these two limits, the only mech- anism that can induce a streaming slip velocity, which rotates parallel to the surface, is the energy-flux-density vector 〈 Sdac 〉 . As seen from Eq. (55b), this mechanism also governs the force density driving streaming in the bulk. In general, 〈 Sdac 〉 can drive rotating streaming if it has a nonzero curl, which we calculate to lowest order in Γ using Eq. (20b) and ∇ × vd1 = 0, and find to be proportional to the acoustic angular momentum density, ∇× 〈Sdac〉 = ω2〈rd1 × (ρ0vd1)〉, rd1 = iωvd1 . (66) VII. NUMERICAL MODELING IN COMSOL In the following we implement our extended acous- tic pressure theory, Eqs. (21a) and (27) for p1, and streaming theory, Eqs. (55) and (58) for vd2 and p2, in the finite-element method (FEM) software COMSOL Multiphysics[41]. We compare these simulations with a full boundary-layer-resolved model for the acoustics, Eqs. (18) and (8a) for v1 and p1, and for the streaming, Eqs. (37) and (8b) for v2 and p2, where the full model is based on our previous acoustofluidic modeling of fluids- only systems [28, 36, 42] and solid-fluid systems [43]. Remarkably, our extended (effective) acoustic pressure model makes it possible to simulate acoustofluidic sys- tems not accessible to the brute-force method of the full 11 model for three reasons: (1) In the full model, the thin boundary layers need to be resolved with a fine FEM mesh. This is not needed in our effective model. (2) For the first-order acoustics, the full model is based on the vector field v1 and the scalar field p1, whereas our effec- tive model is only based on the scalar field p1. (3) For the second-order streaming, the full equations (37) con- tain large canceling terms, which have been removed in the equations (55) used in the effective model. Therefore, also in the bulk, the effective model can be computed on a much coarser FEM mesh than the full model. In Section VIII, we model a fluid domain Ωfl driven by boundary conditions applied directly on ∂Ωfl, and in Section IX, we model a fluid domain Ωfl embedded in an elastic solid domain Ωsl driven by boundary conditions applied on the outer part of the solid boundary ∂Ωsl. In COMSOL, we specify user-defined equations and boundary conditions in weak form using the PDE math- ematics module, and we express all vector fields in Carte- sian coordinates (x, y, z). At the boundary ∂Ωfl, the lo- cal right-handed orthonormal basis { eξ, eη, eζ } is imple- mented using the built-in COMSOL tangent vectors t1 and t2 as well as the normal vector n, all given in Carte- sian coordinates. Boundary-layer fields (suberscript ”0”), such as V 01 , v d0 1 , and v δ0 1 , are defined on the bound- ary ∂Ωfl only, and their spatial derivatives are computed using the built-in tangent-plane derivative operator dtang. For example, in COMSOL we call the Cartesian components of vδ01 for vdX, vdY, and vdZ and compute ∇·vδ01 as dtang(vdX, x)+dtang(vdY, y) + dtang(vdZ, z). The models are implemented in COMSOL using the fol- lowing two-step procedure:[36] Step (1), first-order fields[42, 43]: For a given frequency ω, the driving first-order boundary conditions for the system are specified; the wall velocity V 01 on ∂Ωfl for the fluid-only model, and the outer wall displacement u1 on ∂Ωsl for the solid-fluid model. Then, the first-order fields are solved; the pressure p1 in Ωfl using Eqs. (21a) and (27), and, if included in the model, the solid dis- placement u1 in the solid domain Ωsl. In particular, in COMSOL we implement ∂2ζp1 = (eζ ·∇)2p1 in Eq. (27) as nx ∗ nx ∗ p1xx + 2 ∗ nx ∗ ny ∗ p1xy + . . .. Step (2), second-order fields[36, 42]: Time averages 1 2Re { f∗g } are implemented using the built-in COM- SOL operator realdot as 0.5 ∗ realdot(f, g). More- over, in the boundary condition (58), the normal deriva- tive of vd1ζ in A is rewritten as ∂ζv d 1ζ = ∇ · vd1 − ∇ · vd01 = iκ0ωp01 − ∇ · vd01 for computational ease, and the advective derivatives in A and B, such as the term Re { vδ0∗1 ·∇vδ01 } · ex in A · ex, are com- puted as realdot(vdX, dtang(vdX, x)) + realdot(vdY, dtang(vdX, y)) + realdot(vdZ, dtang(vdX, z)). All numerics were carried out on a workstation, Dell Inc Precision T3610 Intel Xeon CPU E5-1650 v2 at 3.50 GHz with 128 GB RAM and 6 CPU cores. VIII. EXAMPLE I: A RECTANGULAR SURFACE We apply our theory to a long, straight channel along the x axis with a rectangular cross section in the vertical y-z plane, a system intensively studied in the literature both theoretically [28, 36, 42] and experimentally[25, 45– 47]. We consider the 2D rectangular fluid domain Ωfl with − 12W < y < 12W and − 12H < z < 12H, where the top and bottom walls at z = ± 12H are stationary and the vertical side walls at y = ± 12W oscillate with a given velocity V 01yw(z)e −iωtey and frequency f = ω2pi close to c02W , thus exciting a half-wave resonance in the y- direction. In the simulations we choose the wall velocity to be V 01y = d0ω with a displacement amplitude d0 = 0.1 nm. The material parameters used in the model are shown in Table I. We compare the results from the effective theory with the full boundary-layer-resolved simulation developed by Muller et al. [28] Moreover, we derive analytical expres- sions for the acoustic fields, using pressure acoustics and our effective boundary condition Eq. (27), and for the streaming boundary condition using Eq. (58). A. Pressure acoustics: First-order pressure To leading order in  and assuming small variations in z, Eqs. (21a) and (27) in the fluid domain Ωfl becomes, ∇2p1 + k20 p1 = 0, r ∈ Ωfl, (67a) ∂yp1 = iωρ0V 0 1yw(z), y = ± 1 2 W, (67b) ∓∂zp1 = − i ks k20 p1 z = ± 1 2 H. (67c) This problem is solved analytically by separation of variables, introducing ky and kz with k 2 y + k 2 z = k 2 0 and choosing a symmetric velocity envelope function w(z) = cos(kzz). This leads to the pressure p1 = TABLE I. Material parameters at 25 C ◦ used in the numerical modeling presented in Sections VIII and IX. Water [42]: Mass density ρ0 997.05 kg m −3 Compressibility κ0 452 TPa −1 Speed of sound c0 1496.7 m s −1 Dynamic viscosity η0 0.890 mPa s Bulk viscosity η b 0 2.485 mPa s Pyrex glass [44]: Mass density ρs 2230 kg m −3 Speed of sound, longitudinal clo 5592 m s −1 Speed of sound, transverse ctr 3424 m s −1 Solid damping coefficient Γs 0.001 12 (a1) z [µ m ] Full p1 Eff p1 −50 0 50 δ 0 2 4 6(a2) ( p 1 p z = 0 1 − 1 ) × 1 0 4 Full Eff Ana −80 −40 0 40 80 0 2 4 6 (b1) z [µ m ] Full v1y Eff vd1y −50 0 50 0 0.2 0.4 0.6(b2) v 1 y [m / s] −80 −40 0 40 80 0 0.2 0.4 0.6 (c1) y [µm] y0 = W 4 z [µ m ] Full v1z Eff vd1z −150 0 150 −50 0 50 0 1 2 3 4 5 6 0 0.4 0.8(c2) ζ δ v 1 z [m m / s] −80 −40 0 40 80 −0.8 0 0.8 FIG. 2. First-order pressure and velocity fields in the vertical rectangular cross section of a long, straight channel of width W = 380 µm and height H = 160 µm at resonance fres = 1.967 MHz. Color plots show the fields of the full (upper half) and effective (lower half) model for (a1) the pressure p1 from −1 MPa (cyan) to 1 MPa (purple) and the finite element mesh (gray), (b1) the horizontal velocity v1y from 0 m/s (black) to 0.7 m/s (white), and (c1) the vertical velocity v1z from −1 mm/s (black) to 1 mm/s (white). Line plots at y0 = 1 4 W for − 1 2 H < z < − 1 2 H + 7δ (blue dashed line in the color plots) show (a2) the relative pressure deviation p1(y0, z)/p1(y0, 0) − 1, (b2) the horizontal velocity v1y, and (c2) the vertical velocity v1z. The insets show the respective line plots along the entire line − 1 2 H < z < 1 2 H. ”Ana” refers to the analytical results from Eq. (72). A sin(kyy) cos(kzz), where A is found from Eq. (67b), p1(y, z) = iωρ0V 0 1y ky cos(ky W 2 ) sin(kyy) cos(kzz). (68) According to Eq. (67c), kz must satisfy k20 = ikskz tan ( kz H 2 ) , (69) and using tan(kz H 2 ) ≈ 12kzH for kzH  1, we obtain k2z = −(1 + i) δ H k20, k 2 y = [ 1 + (1 + i) δ H ] k20. (70) Note that ky becomes slightly larger than k0 since the presence of the boundary layers introduces a small vari- ation in the z direction. The half-wave resonance that maximizes the amplitude of p1 in Eq. (68) is therefore found at a frequency fres slightly lower than f 0 res = c0 2W , fres = ( 1− 1 2 Γbl ) f0res, with Γbl = δ H . (71) Here, we introduced the boundary-layer damping coeffi- cient Γbl that shifts fres away from f 0 res. This resonance shift is a result of the extended boundary condition (27), and it cannot be calculated using classical pressure acous- tics. Using f = fres in Eq. (68) and expanding to leading order in Γbl, gives the resonance pressure and velocity, pres1 ρ0c0 = −4V 01y piΓbl { sin(y˜) + Γbl 2 [iy˜ cos(y˜)− sin(y˜)] } Zres(z˜), (72a) vd,res1y = 4iV 01y piΓbl { cos(y˜) + i Γbl 2 [ cos(y˜)− y˜ sin(y˜)]}Zres(z˜), (72b) vd,res1z = 4iV 01y pi (1 + i) sin(y˜)z˜, (72c) where y˜ = pi yW , z˜ = pi z W , and Zres = [ 1 + 12Γbl(1 + i)z˜ 2]. Note that at resonance, the horizontal velocity compo- nent is amplified by a factor Γ−1bl relative to the wall ve- locity, vd,res1y ∼ Γ−1bl vd,res1z ∼ Γ−1bl V 01y, while the horizontal 13 −4 −3 −2 −1 0 1 2 3 4 0 40 80 120 2(f−fres) Γblfres E a c [P a ] 1.3 MPa Γ = 1+β2 (k0δ) 2 Γ = Γbl Full Eff Ana CPA FIG. 3. Resonance curves for the rectangular channel. ”Ana” refers to the analytical result from Eq. (73b) and ”CPA” refers to simulations using classical pressure acous- tics with the boundary condition ∂ζp1 = iωV 0 1ζ at r ∈ ∂Ω with different choices of bulk damping coefficient Γ. component is not. In Fig. 2, we compare an effective (”Eff”) pressure- acoustics simulation of p1 solving Eqs. (21a) and (27), with a full pressure-velocity simulation of p1 and v1 from Eq. (18) as in Muller and Bruus[28]. The analytical re- sults (”Ana”) for pres1 , v d,res 1y , and v d,res 1z in Eq. (72) are also plotted along the line y = 14W in Fig. 2(a2), (b2), and (c2), respectively. The relative deviation between the full and effective fields outside the boundary are less than 0.1% even though the latter was obtained using only 5 × 103 degrees of freedom (DoF) on the coarse mesh compared to the 6× 105 DoF necessary in the former on the fine mesh. Note that from the effective model, the boundary-layer velocity field vδ1 can be computed using Eqs. (23) and (24). To study the resonance behaviour of the acoustic res- onator further, we compute the space- and time-averaged energy density 〈 E¯dac 〉 stored in the acoustic field for fre- quencies f close to the resonance frequency fres. Insert- ing ky = pi W (1+ i 2Γbl)+ 2pi c0 (f−fres) into Eq. (68), results in the Lorentzian line-shape for 〈 E¯dac 〉 ,〈 E¯dac 〉 = 〈 E¯d,kinac 〉 + 〈 E¯d,potac 〉 = 2 〈 E¯d,potac 〉 = 2 〈 E¯d,kinac 〉 = 2 HW ∫∫ Ωfl 1 2 κ0 〈 p1p1 〉 dydz (73a) ≈ 1 pi2 ρ0 ( V 01y )2 1( f fres − 1)2 + ( 12Γbl)2 , for f ≈ fres. (73b) From this follows the maximum energy density at reso- nance, 〈 E¯d,resac 〉 = 〈 E¯dac(fres) 〉 , and the quality factor Q, 〈 E¯d,resac 〉 = 1 4 ρ0 ( 4V 01y piΓbl )2 , Q = 1 Γbl = H δ . (74) As shown in Fig. 3, there is full agreement between the effective pressure-acoustics model, the full pressure- velocity model, and the analytical model. This is in z [µ m ] y [µm] y0 = W 4 (a) Full v2 Eff vd 2 −150 0 150 −50 0 50 0 1 2 3 4 5 6 0 0.4 0.8 1.2(b) S tr ea m in g [m m / s] ζ δ Full Eff v2y v2z/(k0δ) FIG. 4. Second-order velocity for the rectangular channel. (a) Comparison of full v2 (above) and effictive (below) stream- ing v d 2 . (b) Line plots at y0 = 1 4 W for − 1 2 H < z < − 1 2 H + 7δ near the center of the blue half circle in (a). agreement with the Q-factor obtained from Eq. (36), Q = 2 ∫∫ Ωfl 1 4 ρ0|vres1y |2 dydz 2 ∫ +W2 −W2 1 4 δρ0|vres1y |2 dy = H δ , (75) and also in agreement with the results obtained by Muller and Bruus[36] and by Hahn et al.[38] using the approxi- mation Ploss ≈ P dissvisc in Eq. (36). B. Second-order streaming solution For the full model at resonance fres, we solve Eq. (37), while for the effective model we solve Eq. (55) with the boundary condition on vd2 obtained by inserting the ve- locity fields from Eq. (72) into Eq. (57). At the surfaces z = ± 12H, we find to lowest order in , vd02y = 3 8c0 ( 4V 01y piΓbl )2 sin(2y˜), (76a) vd02z = ∓(k0δ) 1 8c0 ( 4V 01y piΓbl )2[ 1 + 10 cos(2y˜) ] . (76b) The resulting fields of the two models are shown in Fig. 4. Again, we have good quantitative agreement between the two numerical models, now better than 1% or 3k0δ, for 9× 103 DoF and 6× 105 DoF, respectively. Analytically, Eq. (76a) is the usual parallel-direction boundary condition for the classical Rayleigh stream- ing [22], while Eq. (76b) is beyond that, being 14 the perpendicular-direction boundary condition on the streaming, which is a factor k0δ ≈ 3× 10−3 smaller than the parallel one. This is confirmed in Fig. 4(b) showing the streaming velocity close to z = − 12H at y = 14W . IX. EXAMPLE II: A CURVED OSCILLATING SURFACE Next, we implement in COMSOL our the boundary conditions Eqs. (27) and (58) in a system with a curved solid-fluid interface that oscillates in any direction, as described in Section VII. We consider an ellipsoidal fluid domain (water) of horizontal major axis W = 380 µm and vertical minor axis H = 160 µm surrounded by a rectangular solid domain (Pyrex) of width Ws = 680 µm and height Hs = 460 µm. We actuate the solid at its bot- tom surface using a velocity amplitude V 01ζ = d0ω sin( piy Ws ) with d0 = 0.1 nm and at the resonance frequency fres = 2.222 MHz, which has been determined numerically as in Fig. 3. The governing equations for the displacement −300 0 300 −200 0 200 (a) z [µ m ] y [µm] Full Eff Water Pyrex ×105 ×104 −150 0 150 −50 0 50 (b) z [µ m ] y [µm] Full Eff FIG. 5. Full (left) and effective (right) solutions for a curved channel with fluid-solid coupling. (a) Elliptic fluid domain with the acoustic pressure p1 from −0.3 MPa (cyan) to +0.3 MPa (purple) and fluid velocity (green arrows, max 0.2 m/s) surrounded by solid pyrex with displacement field u1 (blue arrows) and displacement magnitude |u1| from 0 nm (black) to 2.7 nm (yellow). To be visible, the displacement (blue line and blue arrows, max 3 nm) is enhanced 10 4 times, except at the bottom (green line, max 0.1 nm) where it is enhanced 10 5 times. (b) Streaming velocity v2 (green arrows) and magni- tude from 0 µm/s (black) to 7.8 µm/s (yellow). field u1 of the solid are those used by Ley and Bruus[48], ∇· σs = −ρsω2(1 + iΓs)u1, in the solid domain (77a) −iωu = V 01 (y), actuation at z = − 1 2 Hs, (77b) ns ·σs = 0, at solid-air interfaces, (77c) ns ·σs = ns ·σ1, at solid-fluid interfaces, (77d) where σs = ρsc 2 tr[∇u + (∇u)T ] + ρs(c2lo − 2c2tr)(∇ · u)I is stress tensor of the solid with mass density ρs, trans- verse velocity ctr, longitudinal velocity clo, and damping coefficient Γs, while ns is the solid surface normal, and ns ·σ1 = eζ ·σ1 is the fluid stress on the solid, Eq. (29). The material parameter values are listed in Table I. We solve numerically Eqs. (21a) and (27) in first or- der and Eqs. (55) and (58) in second order. The results are shown in Fig. 5, where we compare the simulation results from the full boundary-layer resolved simulation of Eq. (37) with the effective model. Even for this more complex and realistic system consisting of an elastic solid with a curved oscillating interface coupled to a viscous fluid, we obtain good quantitative agreement between the two numerical models, better than 6× 105 DoF and 1% for 9× 103 DoF, respectively. X. CONCLUSION We have studied acoustic pressure and streaming in curved elastic cavities having time-harmonic wall oscilla- tions in any direction. Our analysis relies on the condi- tion that both the surface curvature and wall displace- ment are sufficiently small as quantified in Eq. (17). We have developed an extension of the conventional theory of first-order pressure acoustics that includes the viscous effects of the thin acoustic boundary layer. Based on this theory, we have also derived a slip-velocity boundary condition for the steady second-order acoustic streaming, which allows for efficient computations of the resulting incompressible Stokes flow. The core of our theory is the decomposition of the first- and second-order fields into long- and short-range fields varying on the large bulk length scale d and the small boundary-layer length scale δ, respectively, see Eqs. (20) and (38). In the physically relevant limits, this veloc- ity decomposition allows for analytical solutions of the boundary-layer fields. We emphasize that in contrast to the conventional second-order matching theory of inner solutions in the boundary layer and outer solutions in the bulk, our long- and short-range, second-order, time- averaged fields co-exist in the boundary layer; the latter die out exponentially beyond the boundary layer leaving only the former in the bulk. The main theoretical results of the extended pressure acoustics in Section III are the boundary conditions (27) and (29) for the pressure p1 and the stress σ1 · eζ ex- pressed in terms of the pressure p1 and the velocity V 0 1 15 of the wall. These boundary conditions are to be applied to the governing Helmholtz equation (21a) for p1, and the gradient form (20b) of the compressional acoustic veloc- ity field vd1 . Furthermore, in Section IV, we have used the extended pressure boundary condition to derive an ex- pression for the acoustic power loss Ploss, Eq. (35), and the quality factor Q, Eq. (36), for acoustic resonances in terms of boundary-layer and bulk loss mechanisms. The main result of the streaming theory in Section V is the governing incompressible Stokes equation (55) for the streaming velocity vd2 and the corresponding extended boundary condition (58) for the streaming slip velocity vd02 . In this context, we have developed a compact for- malism based on the I (n) ab -integrals of Eq. (46) to carry out with relative ease the integrations that lead to the analytical expression for vd02 . Lastly, in Section VI, we have applied our extended pressure-acoustics theory to several special cases. We have shown, how it leads to predictions that goes beyond previous theoretical results in the literature by Lord Rayleigh [22], Nyborg [33], Lee and Wang [34], and Vanneste and Bu¨hler [35], while it does agree in the appropriate limits with these results. The physical interpretation of our extended pressure acoustics theory may be summarized as follows: The fluid velocity v1 is the sum of a compressible velocity v d 1 and an incompressible velocity vδ1, where the latter dies out beyond the boundary layer. In general, the tangential component V 01‖ = v d0 1‖ + v δ0 1‖ of the no-slip condition at the wall induces a tangential compression of vδ1 due to the tangential compression of vd1 and V 0 1 . This in turn in- duces a perpendicular velocity component vδ01ζ due to the incompressibility of vδ1. To fulfil the perpendicular no- slip condition V 01ζ = v d0 1ζ + v δ0 1ζ , the perpendicular compo- nent vd01ζ of the acoustic velocity must therefore match not only the wall motion V 01ζ , as in classical pressure acous- tics, but the velocity difference V 01ζ − vδ01ζ . Including vδ01ζ takes into account the power delivered to the acoustic fields due to tangential wall motion and the power lost from the acoustic fields due to tangential fluid motion. Consequently, by incorporating into the boundary condi- tion an analytical solution of vδ1, our theory subsequently leads to the correct acoustic fields, resonance frequencies, resonance Q-factors, and acoustic streaming. In Sections VII–IX we have demonstrated the imple- mentation of our extended acoustic pressure theory in numerical finite-element COMSOL models, and we have presented the results of two specific models in 2D: a wa- ter domain with a rectangular cross section and a given velocity actuation on the domain boundary, and a wa- ter domain with an elliptic cross section embedded in a rectangular glass domain that is actuated on the outer boundary. By restricting our examples to 2D, we have been able to perform the direct numerical simulations of the full boundary-layer-resolved model, and to use these results for validation of our extended acoustic pressure and streaming theory. Remarkably, we have found that our approach makes it possible to simulate acoustofluidic systems with a drastic nearly 100-fold reduction in the necessary degrees of freedom, while achieving the same quantitative accuracy, typically of order kδ, compared to direct numerical simulations of the full boundary- layer resolved model. We have identified three reasons for this reduction: (1) Neither our first-order nor our second-order method involve the fine-mesh resolution of the boundary layer. (2) Our first-order equations (21a) and (27) requires only the scalar pressure p1 as an inde- pendent variable, while the vector velocity v1 is subse- quently computed from p1, Eq. (20b). (3) Our second- order equations (55) and (58) avoid the numerically de- manding evaluation in the entire fluid domain of large terms that nearly cancel, and therefore our method re- quires a coarser mesh compared to the full model, also in the bulk. The results from the numerical examples in Sec- tions VIII and IX show that the extended pressure acous- tics theory has the potential of becoming a versatile and very useful tool in the field of acoustofluidics. For the fluid-only rectangular domain in Section VIII, we showed how the theory not only leads to accurate numerical re- sults for the acoustic fields and streaming, but also al- lows for analytical solutions, which correctly predict cru- cial details related to viscosity of the first-order acoustic resonance, and which open up for a deeper analysis of the physical mechanisms that lead to acoustic streaming. For the coupled fluid-solid system in 2D of an elliptical fluid domain embedded in a rectangular glass block, we showed in Section IX an important example of a more complete and realistic model of an actuated acoustoflu- idic system. The extended pressure acoustics theory al- lowed for calculations of acoustic fields and streaming with a relative accuracy lower than 1%. Based on prelim- inary work in progress in our group, it appears that the extended pressure acoustic theory makes 3D simulations feasible within reasonable memory consumptions for a wide range of microscale acoustofluidic systems such as fluid-filled cavities and channels driven by attached piezo- electric crystals as well as droplets in two-phase systems and on vibrating substrates. Although we have developed the extended pressure- acoustics theory and corresponding streaming theory within the narrow scope of microscale acoustofluidics, our theories are of general nature and may likely find a much wider use in other branches of acoustics. Appendix A: Acoustic power balance The time averages 〈 Ekinac 〉 , 〈 Epotac 〉 , and 〈 Eac 〉 of the kinetic, the potential, and the total acoustic energy den- 16 sity, respectively, are given by 〈 Ekinac 〉 = 1 2 ρ0 〈 v1 ·v1 〉 , (A1a)〈 Epotac 〉 = 1 2 κ0 〈 p1p1 〉 , (A1b)〈 Eac 〉 = 〈 Ekinac 〉 + 〈 Epotac 〉 . (A1c) Using Gauss’s theorem and ρ0∂tv1 = ∇ · σ1, the time- averaged total power delivered by the surrounding wall is written as the sum of the time-averaged rate of change of the acoustic energy and total power dissipated into heat, ∮ ∂Ω 〈 V 01 ·σ1 〉·ndA = ∫ Ω ∇· 〈v1 ·σ1〉 dV (A2a) = ∫ Ω [〈 v1 ·(∇· σ1) 〉 + 〈 (∇v1) :σ1 〉] dV, (A2b) = ∫ Ω [〈 ∂tEac 〉 + 〈 (∇v1) :τ1 〉] dV. (A2c) Solving for the time-averaged change in acoustic energy∫ Ω 〈 ∂tEac 〉 dV in Eq. (A2c) gives ∫ Ω 〈 ∂tEac 〉 dV = ∮ ∂Ω 〈 V 01 ·σ1 〉·ndA− ∫ Ω 〈 (∇v1) :τ1 〉 dV (A3a) = ∮ ∂Ω 〈 V 01 (−p1) 〉·n dA+ ∫ Ω 〈 v1 ·(∇·τ1) 〉 dV, (A3b) where Gauss’s theorem transforms ∫ ∂Ω 〈 V 01 ·τ1 〉·ndA into a volume integral, and n = −eζ is the normal vector of the fluid domain Ω. We may interpret Eq. (A3b) as the rate of change of stored energy in terms of a power 〈 Pvisc 〉 due to viscous effects, 〈 ∂tEac 〉 = 〈 Pvisc 〉 = 〈 P dissvisc 〉 + 〈 Pwallvisc 〉 , (A4) where 〈 P dissvisc 〉 is the viscous power dissipation into heat, and 〈 Pwallvisc 〉 is the power from the viscous part of the work performed by the wall on the fluid,〈 Pvisc 〉 = ∫ Ω 〈 v1 ·(∇·τ1) 〉 dV, (A5a)〈 P dissvisc 〉 = − ∫ Ω 〈 (∇v1) :τ1 〉 dV, (A5b)〈 Pwallvisc 〉 = ∮ ∂Ω 〈 v1 ·τ1 〉·n dA. (A5c) Using Eqs. (19) and (20) we can evaluate 〈 Pvisc 〉 , 〈 Pvisc 〉 = ∫ Ω 〈 v1 ·(∇·τ1) 〉 dV (A6a) = ∫ Ω 〈 v1 · ( iΓ∇p1 − iωρ0vδ1 )〉 dV (A6b) = ∫ Ω [ − Γωρ0 2 |vd1 |2 + 〈 ∂tE kin,δ ac 〉] dV − ∮ ∂Ω 〈 p1v δ0 1 〉·n dA, (A6c) where we used Eq. (20) and Gauss’ theorem. Inserting Eq. (A6c) into Eq. (A3b) leads to Eq. (33). Comparing with Eq. (35), we can relate 〈 Ploss 〉 = 〈 P dloss 〉 and 〈 Pvisc 〉 , 〈 Ploss 〉 = 〈 Pvisc 〉− ∮ ∂Ω 〈 p1 [ i ks ∇‖ ·V 01‖ ]〉·n dA (A7a) = 〈 P dissvisc 〉 + 〈 Pwallvisc 〉− ∮ ∂Ω 〈 p1 [ i ks ∇‖ ·V 01‖ ]〉·ndA. (A7b) Note that 〈 Ploss 〉 is not in general the same as the power〈 P dissvisc 〉 dissipated into heat. These might however be approximately equal if the power ∮ ∂Ω −〈p1V 01 〉·ndA de- livered by the pressure is approximately balanced by dis- sipation 〈 P dissvisc 〉 . This happens, if ∮ ∂Ω −〈p1V 01 〉·n dA is much larger than 〈 Pwallvisc 〉 and ∮ 〈 p1 [ i ks ∇‖ ·V 01‖ ]〉 ·ndA, which is usually satisfied. [1] H. Bruus, J. Dual, J. Hawkes, M. Hill, T. Laurell, J. Nilsson, S. Radel, S. Sadhal, and M. Wiklund, Forthcoming lab on a chip tutorial series on acoustoflu- idics: Acoustofluidics-exploiting ultrasonic standing wave forces and acoustic streaming in microfluidic sys- tems for cell and particle manipulation, Lab Chip 11, 3579 (2011). [2] T. Laurell and A. Lenshof, eds., Microscale Acoustoflu- idics (Royal Society of Chemistry, Cambridge, 2015). [3] P. Thevoz, J. D. Adams, H. Shea, H. Bruus, and H. T. Soh, Acoustophoretic synchronization of mam- malian cells in microchannels, Anal. Chem. 82, 3094 (2010). [4] P. Augustsson, C. Magnusson, M. Nordin, H. Lilja, and T. Laurell, Microfluidic, label-free enrichment of prostate cancer cells in blood based on acoustophoresis, Anal. Chem. 84, 7954 (2012). [5] P. Augustsson, J. T. Karlsen, H.-W. Su, H. Bruus, and J. Voldman, Iso-acoustic focusing of cells for size- insensitive acousto-mechanical phenotyping, Nat. Com- mun. 7, 11556 (2016). [6] X. Ding, S.-C. S. Lin, B. Kiraly, H. Yue, S. Li, I.-K. Chiang, J. Shi, S. J. Benkovic, and T. J. Huang, On- chip manipulation of single microparticles, cells, and or- ganisms using surface acoustic waves, PNAS 109, 11105 (2012). 17 [7] D. J. Collins, B. Morahan, J. Garcia-Bustos, C. Doerig, M. Plebanski, and A. Neild, Two-dimensional single- cell patterning with one cell per well driven by surface acoustic waves, Nat. Commun. 6, 8686 (2015). [8] B. Hammarstro¨m, M. Evander, H. Barbeau, M. Bruzelius, J. Larsson, T. Laurell, and J. Nills- son, Non-contact acoustic cell trapping in disposable glass capillaries, Lab Chip 10, 2251 (2010). [9] B. Hammarstro¨m, T. Laurell, and J. Nilsson, Seed par- ticle enabled acoustic trapping of bacteria and nanopar- ticles in continuous flow systems, Lab Chip 12, 4296 (2012). [10] B. Hammarstro¨m, M. Evander, J. Wahlstro¨m, and J. Nilsson, Frequency tracking in acoustic trapping for improved performance stability and system surveillance, Lab Chip 14, 1005 (2014). [11] B. W. Drinkwater, Dynamic-field devices for the ultra- sonic manipulation of microparticles, Lab Chip 16, 2360 (2016). [12] D. J. Collins, C. Devendran, Z. Ma, J. W. Ng, A. Neild, and Y. Ai, Acoustic tweezers via sub-time-of-flight regime surface acoustic waves, Science Advances 2, e1600089 (2016). [13] H. G. Lim, Y. Li, M.-Y. Lin, C. Yoon, C. Lee, H. Jung, R. H. Chow, and K. K. Shung, Calibration of trapping force on cell-size objects from ultrahigh-frequency single- beam acoustic tweezer, IEEE Transactions on Ultrasonics Ferroelectrics and Frequency Control 63, 1988 (2016). [14] D. Baresch, J.-L. Thomas, and R. Marchiano, Observa- tion of a single-beam gradient force acoustical trap for elastic particles: Acoustical tweezers, Phys. Rev. Lett. 116, 024301 (2016). [15] L. V. King, On the acoustic radiation pressure on spheres, Proc. R. Soc. London, Ser. A 147, 212 (1934). [16] K. Yosioka and Y. Kawasima, Acoustic radiation pressure on a compressible sphere, Acustica 5, 167 (1955). [17] A. A. Doinikov, Acoustic radiation force on a spherical particle in a viscous heat-conducting fluid .1. general for- mula, J. Acoust. Soc. Am. 101, 713 (1997). [18] A. A. Doinikov, Acoustic radiation force on a spherical particle in a viscous heat-conducting fluid .2. force on a rigid sphere, J. Acoust. Soc. Am. 101, 722 (1997). [19] A. A. Doinikov, Acoustic radiation force on a spherical particle in a viscous heat-conducting fluid. 3. Force on a liquid drop, J. Acoust. Soc. Am. 101, 731 (1997). [20] M. Settnes and H. Bruus, Forces acting on a small par- ticle in an acoustical field in a viscous fluid, Phys. Rev. E 85, 016327 (2012). [21] J. T. Karlsen and H. Bruus, Forces acting on a small particle in an acoustical field in a thermoviscous fluid, Phys. Rev. E 92, 043010 (2015). [22] Lord Rayleigh, On the circulation of air observed in Kundt’s tubes, and on some allied acoustical problems, Philos. Trans. R. Soc. London 175, 1 (1884). [23] H. Schlichting, Berechnung ebener periodischer gren- zeschichtstro¨mungen, Phys. Z. 33, 327 (1932). [24] M. Wiklund, R. Green, and M. Ohlin, Acoustofluidics 14: Applications of acoustic streaming in microfluidic de- vices, Lab Chip 12, 2438 (2012). [25] P. B. Muller, M. Rossi, A. G. Marin, R. Barnkob, P. Au- gustsson, T. Laurell, C. J. Ka¨hler, and H. Bruus, Ultrasound-induced acoustophoretic motion of micropar- ticles in three dimensions, Phys. Rev. E 88, 023006 (2013). [26] J. Lei, P. Glynne-Jones, and M. Hill, Modal Rayleigh-like streaming in layered acoustofluidic devices, Phys. Fluids 28, 012004 (2016). [27] A. Riaud, M. Baudoin, O. Bou Matar, L. Becerra, and J.-L. Thomas, Selective manipulation of microscopic par- ticles with precursor swirling rayleigh waves, Phys. Rev. Applied 7, 024007 (2017). [28] P. B. Muller, R. Barnkob, M. J. H. Jensen, and H. Bruus, A numerical study of microparticle acoustophoresis driven by acoustic radiation forces and streaming- induced drag forces, Lab Chip 12, 4617 (2012). [29] R. Barnkob, P. Augustsson, T. Laurell, and H. Bruus, Acoustic radiation- and streaming-induced microparticle velocities determined by microparticle image velocime- try in an ultrasound symmetry plane, Phys. Rev. E 86, 056307 (2012). [30] M. Antfolk, P. B. Muller, P. Augustsson, H. Bruus, and T. Laurell, Focusing of sub-micrometer particles and bac- teria enabled by two-dimensional acoustophoresis, Lab Chip 14, 2791 (2014). [31] Z. Mao, P. Li, M. Wu, H. Bachman, N. Mesyngier, X. Guo, S. Liu, F. Costanzo, and T. J. Huang, Enrich- ing nanoparticles via acoustofluidics, ACS Nano 11, 603 (2017). [32] M. Wu, Z. Mao, K. Chen, H. Bachman, Y. Chen, J. Rufo, L. Ren, P. Li, L. Wang, and T. J. Huang, Acoustic separation of nanoparticles in continuous flow, Advanced Functional Materials 27, 1606039 (2017). [33] W. L. Nyborg, Acoustic streaming near a boundary, J. Acoust. Soc. Am. 30, 329 (1958). [34] C. Lee and T. Wang, Near-boundary streaming around a small sphere due to 2 orthogonal standing waves, J. Acoust. Soc. Am. 85, 1081 (1989). [35] J. Vanneste and O. Bu¨hler, Streaming by leaky surface acoustic waves, Proceedings of the Royal Society of Lon- don A: Mathematical, Physical and Engineering Sciences 467, 1779 (2011). [36] P. B. Muller and H. Bruus, Theoretical study of time- dependent, ultrasound-induced acoustic streaming in mi- crochannels, Phys. Rev. E 92, 063018 (2015). [37] C. E. Bradley, Acoustic streaming field structure: The influence of the radiator, The Journal of the Acoustical Society of America 100, 1399 (1996). [38] P. Hahn and J. Dual, A numerically efficient damping model for acoustic resonances in microfluidic cavities, Physics of Fluids 27, 062005 (2015). [39] A. Riaud, M. Baudoin, O. Bou Matar, J.-L. Thomas, and P. Brunet, On the influence of viscosity and caustics on acoustic streaming in sessile droplets: an experimental and a numerical study with a cost-effective method, J. Fluid Mech. 821, 384 (2017). [40] C. Eckart, Vortices and streams caused by sound waves, Phys. Rev. 73, 68 (1948). [41] COMSOL Multiphysics 5.3a, www.comsol.com, (2017). [42] P. B. Muller and H. Bruus, Numerical study of thermo- viscous effects in ultrasound-induced acoustic streaming in microchannels, Phys. Rev. E 90, 043016 (2014). [43] M. W. H. Ley and H. Bruus, Continuum modeling of hy- drodynamic particle-particle interactions in microfluidic high-concentration suspensions, Lab on a Chip 16, 1178 (2016). [44] Glass Silicon Constraint Substrates, CORNING, Houghton Park C-8, Corning, NY 14831, USA, http://www.valleydesign.com/Datasheets/Corning% 18 20Pyrex%207740.pdf, accessed 11 November 2016. [45] R. Barnkob, P. Augustsson, T. Laurell, and H. Bruus, Measuring the local pressure amplitude in microchannel acoustophoresis, Lab Chip 10, 563 (2010). [46] P. Augustsson, R. Barnkob, S. T. Wereley, H. Bruus, and T. Laurell, Automated and temperature-controlled micro-piv measurements enabling long-term-stable mi- crochannel acoustophoresis characterization, Lab Chip 11, 4152 (2011). [47] R. Barnkob, I. Iranmanesh, M. Wiklund, and H. Bruus, Measuring acoustic energy density in microchannel acoustophoresis using a simple and rapid light-intensity method, Lab Chip 12, 2337 (2012). [48] M. W. H. Ley and H. Bruus, Three-dimensional numer- ical modeling of acoustic trapping in glass capillaries, Phys. Rev. Applied 8, 024020 (2017). 