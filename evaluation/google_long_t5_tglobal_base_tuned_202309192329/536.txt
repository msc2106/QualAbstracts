ABSTRACT: 
Calling animals may be located from measurements of the differences in acoustic travel time at pairs of receivers. For inhomogeneous fields of speed, locations can be made with better accuracy when the location algorithm allows the speed to vary from path to path. A new geometrical shape, called an isodiachron, is described. It is the locus of points corresponding to a constant difference in travel time along straight paths between the animal and two receivers. Its properties allow an interpretation for locations when the speed differs from path to path. An algorithm has been developed for finding the location of calling animals by intersecting isodiachrons from data collected at pairs of receivers. When the sound speed field is spatially homogeneous, isodiachrons become hyperboloids. Unlike a hyperboloid that extends to infinity, an isodiachron is confined to a finite region of space when the speeds differ between the animal and each of two receivers. Its shape is significantly different than a hyperboloid for cases of practical interest. Isodiachrons can be used to better understand locations of calling animals and other sounds in the sea, Earth, and air. 
 
PREDICTION: 
Calling animals may be located from measurements of the differences in acoustic travel time at pairs of receivers. For inhomogeneous fields of speed, locations can be made with better accuracy when the location algorithm allows the speed to vary from path to path. A new geometrical shape, called an isodiachron, is described. It is the locus of points corresponding to a constant difference in travel time along straight paths between the animal and two receivers. Its properties allow an interpretation for locations when the speed differs from path to path. An algorithm has been developed for finding the location of calling animals by intersecting isodiachrons from data collected at pairs of receivers. When the sound speed field is spatially homogeneous, isodiachrons become hyperboloids. Unlike a hyperboloid that extends to infinity, an isodiachron is confined to a finite region of space when the speeds differ between the animal and each of two receivers. Its shape is significantly different than a hyperboloid for cases of practical interest. Isodiachrons can be used to better understand locations of calling animals and other sounds in the sea, Earth, and air. 
 
FULL TEXT: 
 CommentsCopyright ASA. Reprinted from Journal of the Acoustical Society of America, Volume 116, Issue 5, November2004, pages 3168-3177 .Publisher URL: http://dx.doi.org/10.1121/1.1804625This journal article is available at ScholarlyCommons: http://repository.upenn.edu/ees_papers/10Geometry of locating sounds from differences in traveltime: IsodiachronsJohn L. SpiesbergerDepartment of Earth and Environmental Science, 240 S. 33rd St., University of Pennsylvania, Philadelphia,Pennsylvania 19104-6316~Received 2 June 2004; revised 15 August 2004; accepted 16 August 2004!Calling animals may be located from measurements of the differences in acoustic travel time at pairsof receivers. For inhomogeneous fields of speed, locations can be made with better accuracy whenthe location algorithm allows the speed to vary from path to path. A new geometrical shape, calledan isodiachron, is described. It is the locus of points corresponding to a constant difference in traveltime along straight paths between the animal and two receivers. Its properties allow an interpretationfor locations when the speed differs from path to path. An algorithm has been developed for findingthe location of calling animals by intersecting isodiachrons from data collected at pairs of receivers.When the sound speed field is spatially homogeneous, isodiachrons become hyperboloids. Unlike ahyperboloid that extends to infinity, an isodiachron is confined to a finite region of space when thespeeds differ between the animal and each of two receivers. Its shape is significantly different thana hyperboloid for cases of practical interest. Isodiachrons can be used to better understand locationsof calling animals and other sounds in the sea, Earth, and air. © 2004 Acoustical Society ofAmerica. @DOI: 10.1121/1.1804625#PACS numbers: 43.80.Ev @WWA# Pages: 3168–3177I. INTRODUCTIONDifferences in the travel time of acoustic and electro-magnetic waves are commonly used to locate objects. Appli-cations include the global positioning system1 ~GPS! and thepassive location of calling animals.2–9 When the speed of thesignal is constant, the difference in travel times can be con-verted to the difference in distances by multiplying the dif-ference in travel times by the speed. Then the method oflocation is usually interpreted using hyperboloids10,11 be-cause the hyperboloid is the locus of points whose differencein distance from two points is constant. The hyperbola mayhave been discovered by the ancient Greek mathematicianMenaechmus ~circa 350 B.C.! ~p. 280-281, Vol II, Ref. 12!,but this is not certain as most original writings have beenlost. Other geometrical interpretations of location have alsobeen found.11,13,14The single-speed approximation is good enough forsome but not all applications. For greater accuracy, methodsare used that allow the speed to differ from path to path,while still maintaining the picture of signals traversingstraight line segments. Scientists have developed these ap-proaches for application to acoustic navigation in thesea,15–17 and to the passive location of calling animals in thesea and air.9,18 Then the question arises as to whether there isa geometrical shape, which cannot be a hyperbola, that canbe used to interpret such locations when a constant speed isnot used.The purpose of this paper is to show that such a shapeexists and to use it to interpret these methods of location. Theshape appears to have not been shown previously in the sci-entific or mathematical literature, except for a paper thatgives its definition without showing its shape or describingits properties.18 It is therefore necessary to use simple calcu-lations to describe the properties of this shape, called an‘‘isodiachron,’’ from the Greek words ‘‘iso’’ for same, ‘‘dia’’for difference, and ‘‘chron’’ for time. It is the locus of pointsalong which the difference in travel time is constant. It re-duces to a hyperboloid when the average speed of the signalis the same on both paths. The isodiachron is the naturalshape to intersect to find the location of an animal when thespeed differs from path to path. In fact, the algorithm in Ref.18 yields a probability density function for location usingisodiachrons.Unless noted otherwise, the phrase ‘‘effective speed’’ isdefined to be the time for the acoustic or electromagneticsignal to propagate from the animal to the receiver dividedby the Euclidean distance. Thus the effective speed includesall spatially and temporally varying effects including thosedue to refraction, diffraction, and, for acoustic signals, ad-vection such as that due to winds or currents. Because ofadvection, the effective speed from the animal to the receivercan be different than from the receiver to the animal. Theword ‘‘speed’’ will not include effects from advection.Section II reviews some of the reasons and methods thathave been used to infer location when the effective speed isspatially inhomogeneous. There must be other methods thathave been used as well, and the list of examples here is notintended to be complete. What is important about this sectionis that it highlights some of the pitfalls in hyperbolic locationmethods in situations where the effective speed is not con-stant from path to path. Section III provides the calculationsthat define the isodiachron and its behavior. The paper endswith a short summary, and provides a speculation as to whythe ancient Greek mathematicians did not apparently con-template an isodiachron.3168 J. Acoust. Soc. Am. 116 (5), November 2004 0001-4966/2004/116(5)/3168/10/$20.00 © 2004 Acoustical Society of AmericaII. HYPERBOLIC LOCATION IS LESS ACCURATE ANDSOMETIMES INCORRECTA. Underwater navigationHydrophones are sometimes lowered from a ship to theseafloor to locate acoustic emissions from a variety of ob-jects. There is considerable interest in determining the posi-tion of each hydrophone on the bottom so that locations ofacoustic emissions can be made accurately.Quite often, the positions of the hydrophones are esti-mated by towing an accurately located source from the shipwhile the hydrophones on the bottom pick up these calibra-tion signals. Suppose the clock for the hydrophone time se-ries has an unknown offset with respect to the clock govern-ing the towed source. The unknown clock offset is removedfrom the problem by working with differences of signaltravel time at the hydrophone. The travel times change pri-marily because the source transmits from different locations.Until recently, this was usually treated as a standard hyper-bolic location problem.In the sea, the effective speed of sound between thesource and hydrophone varies with source location.15–17 Toexplain why, assume for simplicity that the speed of soundvaries with depth only. The actual time for sound to reach ahydrophone on the bottom from the surface depends on thespeed of sound along a ray path, which is not straight be-cause it bends due to refraction. If the ray path were straight,the effective speed of sound would be the same for all sourcelocations at the surface. But the bending changes the effec-tive speed of sound. For cases of interest, this effective speedcan be pre-computed in a table of speed versus slant angle toand depth of the receiver.15,17 This table can be accessed by alocation algorithm.15,16The equations relating location to differences in traveltime are nonlinear.15,16 When these equations are linearizedabout a good initial guess for hydrophone location, a least-squares problem for hydrophone location and clock offsetbetween the source and hydrophone can be solved by iterat-ing the linearized equations to minimize the residuals in adetermined or overdetermined problem.15,16 The method,called the ‘‘inhomogeneous algorithm’’ here, allows one toassume that different paths have the same or different effec-tive speeds. The inhomogeneous algorithm looks up the ef-fective speed along each path as it iterates for the location ofthe hydrophone on the bottom.15,16 An estimate of the errorobtained from hyperbolic location has been investigated asfollows.Using a realistic profile of sound speed in the Atlantic, asimulated hydrophone at 1600 m depth is estimated to have adepth error of about 3 m when located using hyperbolicmethods ~Table I, case 5, Ref. 16!. When the effective speedof sound is allowed to vary from path to path from a pre-computed database, the inhomogeneous algorithm yields thecorrect depth for the hydrophone ~Table I, Case 6, Ref. 16!.For real data with a similar geometry, the hyperbolic locationalgorithm yields a 3 m error compared with the inhomoge-neous location algorithm ~Cases 2 and 4 in Table 2.3 of Ref.15!. There are situations where 3 m errors in hydrophonelocations are significant. Errors in the locations of receiversoften translate to much larger errors in source location.11,19B. Solutions for animal location in airNaturalists, biologists, acousticians, and others estimatelocations of sounds from differences of travel time on widelyseparated microphones in air.20–25 Problems with hyperboliclocation are highlighted by considering a geometry where ananimal is located at Cartesian coordinate ~20,100,7! m and itssignals are monitored at five microphones at ~0,0,0!, ~25,0,3!,~50,3,5!, ~30,40,9!, and ~1,30,4! m respectively. For definite-ness, assume the animal’s call has a rms. bandwidth of 1000Hz and, following the cross correlation of the signal betweeneach pair of microphones, the peak signal-to-noise ratio is 20dB. The lag of this peak has a standard deviation of 16 ms~Ref. 26!, where the lag is the difference in the travel time ofsound between the animal and two receivers. Such accuracycan be achieved in practice.A sequential nonlinear Monte Carlo technique is used toestimate the probability density function for location fromsimulated lags.18 The technique can accommodate spatiallyhomogeneous or inhomogeneous effective speeds, and al-lows one to account for errors in the locations of the micro-phones. Realistic prior distributions of errors are permittedfor all variables. Distributions of location can be comparedwith the same statistical assumptions except for the fact thatin one case the effective speed is spatially homogeneous, andin the other, spatially inhomogeneous. Other algorithms mayalso be suitable for generating realistic location distributions,but it does not seem prudent to summarize or compare suchtechniques because the main point of this paper is not cen-tered on a review of techniques.Simulated lags are computed without noise for a speedof sound of 330 m/s and for a horizontal wind blowing at 10m/s toward the positive y Cartesian axis. A priori distribu-tions of the remaining variables are taken to be Gaussian buttruncated at two standard deviations ~Table I!. The accuratelocations of the receivers are typical for those surveyed op-tically. It is necessary to accommodate the effects of wind forhyperbolic location without allowing the effective speed tovary from path to path. This can be done in two ways, neitherof which is satisfying.The first accommodation is to let the necessarily spa-tially homogeneous effective speed vary by an amount equalto the variations from path to path, i.e., a standard deviationof 10 m/s ~Table I, Hyperbolic Location 1!. The second ac-commodation is to artificially increase the measured error inthe difference in travel times from 16 ms to that which wouldbe due to the change in lag due to path speed variations ofdc5610 m/s over distances of the acoustic paths. An order-of-magnitude estimate of this effect can be obtained by usingequal path lengths, L , given by the length scale of the array.The effect isst’A~Ldc/c2!21~Ldc/c2!2, ~1!where to first order, the variation in travel time for one pathis Ldc/c2 and st denotes the standard deviation of the dif-ference in acoustic travel time between the animal and two3169J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronsreceivers. For L550 m, dc510 m/s, and c5330 m/s, weget st50.00649 s. This artificial increase is about two or-ders of magnitude greater than the 16 ms accuracy that canbe obtained for the signal limited by noise ~Table I, Hyper-bolic Location 2!.There is no difficulty accommodating inhomogeneouseffective speeds with isodiachronic location. In this case, thespeed of sound has zero variation about the mean of 330 m/s,and the y component of the wind is given a standard devia-tion of 10 m/s about a mean of 0 m/s ~Table I, IsodiachronicLocation!.Following application of the sequential nonlinear MonteCarlo algorithm, incorrect animal locations are obtainedwhen the effective speed is assumed to be spatially homoge-neous ~Table I, Hyperbolic Location 1!. Indeed, the animal’s100% confidence limits for y are 102.0 to 108.1 m, but itsactual y coordinate is 100 m. The 100% limits do not extendto infinity because the a priori distributions of error are trun-cated at two standard deviations. So given a priori distribu-tions of receiver locations, travel time differences, and envi-ronmental variations, this hyperbolic location method alwaysyields incorrect answers for the location of the animal.If the second hyperbolic location model is used withlarge errors in the lags ~Table I, Hyperbolic Location 2!, the100% confidence limits are: x between 2312 and 1207 m,y between 55 and 12 000 m, and z between 21200 and1410 m. These bounds contain the correct location of theanimal, but they are so large as to be useless. The 95% con-fidence limits are: x between 13 and 33 m, y between 57 and540 m, and z between 266 and 115 m. These bounds areabout the same scale as the array itself, and still quite largeand probably not useful.With isodiachronic location, 95% confidence limits forthe animal are x:16.6– 20.5 m, y :98.8– 101.7 m, z:3.5–40.5 m. These are statistically consistent with the correct lo-cation at ~20,100,7! m. The large variation in z stems fromthe fact that the animal and receivers are nearly coplanar.Other confidence limits could be given but they are notshown because the point is that isodiachronic location yieldsa correct answer at a stringent confidence of 95%, and there-fore at 100% confidence as well. This demonstrates that hy-perbolic methods yield incorrect or useless locations whereasthe isodiachronic method yields useful and statistically cor-rect locations.C. Global positioning systemThe GPS is used to locate receivers from differences oftravel time from synchronized emissions of electromagneticwaves from satellites. One of the largest sources of locationerror is the variation of the group speed of electromagneticwaves for different paths through the ionosphere.1 If one usesa GPS receiver that monitors only the single L1 frequency,the typical residual after correcting for the GPS-broadcastedionospheric correction is 4 m, but could be many times thatamount.27 These errors translate to location errors of about30 m both horizontally and vertically. If one assumes loca-tions are obtained using a hyperbolic technique, no accom-modation can be made for the differences in effective speedfrom path to path, and these errors would be difficult tosuppress without further information. In this situation, onecould use an algorithm for location that accommodates varia-tions in the effective speed on a path-by-path basis. Suchalgorithms would yield more accurate estimates of locationthan hyperbolic algorithms.III. GEOMETRY OF ISODIACHRONSSince there is a need for locating signals with high ac-curacy in spatially inhomogeneous fields of effective speed,it would be desirable to develop a geometrical interpretationof the problem as has been done when the effective speed isspatially homogeneous.10,11,13,14A hyperboloid is the locus of points s whose differencein distance, di j , from two points is constant. These pointssatisfyiri2si2irj2si5di j , ~2!where the coordinates of the points ~receivers here! are riand rj . Let t i and t j denote the time for sound to travelbetween the source and each receiver, respectively, and de-TABLE I. A priori distributions of independent variables involved in determining the location of a calling animal in air via hyperbolic and isodiachronicmethods. Both methods yield distributions for animal location from the differences in simulated arrival times at five microphones. Hyperbolic location requiresthe effective speed to be the same for each acoustic path whereas isodiachronic location does not. Distributions ~probability density functions! are Gaussianwith indicated means and standard deviations except all are truncated at two standard deviations. ‘‘True’’ indicates a variable’s mean is error-less. The ycomponent of the wind is modeled for isodiachronic location but cannot be modeled in hyperbolic location. Instead, this wind is accounted for by includinga variation of 10 m/s for the standard deviation of effective sound speed in hyperbolic location ~method 1! or by artificially increasing the measured error inthe lag from 16 ms to 0.006 49 s ~method 2! via Eq. ~1!. A priori errors are zero for receiver one, the y and z coordinates of receiver two, and the z coordinatefor receiver three. These coordinates merely define the origin and orientation of the coordinate system.A Priori distributionsVariable SymbolHyperbolic location 1 Hyperbolic location 2 Isodiachronic locationMean Std. Dev. Mean Std. Dev. Mean Std. Dev.Cartesian ri(x) True 0.02 m True 0.02 m True 0.02 mReceiver ri(y) ’’ ’’ ’’ ’’ ’’ ’’Coordinate ri(z) ’’ ’’ ’’ ’’ ’’ ’’Cartesian u(x) 0 0 0 0 0 0Wind u(y) 0 0 0 0 0 10Component u(z) 0 0 0 0 0 0Sound speed c 330 10 330 0 330 0Lag t i j True 16 ms True 0.006 49 s True 16 ms3170 J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronsfine the lag as t i j[t i2t j . When the effective speed is c , Eq.~2! is the same asiri2si2irj2si5ct i j , ~3!which is described in Cartesian coordinates with a polyno-mial of degree two.An isodiachron is defined to be the locus of points sat-isfyingt i2t j5t i j , ~4!where the effective speed depends on the spatial coordinatesof the paths. Then Eq. ~4! isiri2sici~s!2irj2sic j~s!5t i j , ~5!where ci(s) and c j(s) denote the effective speeds to receiversi and j , respectively, as a function of s.In some of what follows, it is useful to consider isodi-achrons where ci(s) and c j(s) do not depend on location s.This is called a ‘‘class one isodiachron.’’ Isodiachrons ofother classes are those given by Eq. ~5! for which ci(s) andc j(s) depend on s. Paradoxically, class one isodiachrons areuseful for estimating probability density functions for thelocation of an animal in all realistic situations where ci(s)and c j(s) do depend on s because of another algorithm thatuses class one isodiachrons in a particular way.18 This para-dox is resolved in Sec. III A.The two-dimensional isodiachron approximates a hyper-bola in a limited region ~Fig. 1!. Unlike a hyperbola, isodi-achrons contain no points at infinity when ci(s) is unequal toc j(s) and when the receivers are separated by a finite dis-tance. Instead, the assumption that the difference in propaga-tion time be constant and that the effective speeds differ,constrains such isodiachrons to finite regions of space ~Fig.1!. The proof which follows is true for isodiachrons of allclasses and for all realistic effective speeds as long as ci(s)and c j(s) differ.We write the definition of an isodiachront i j[t i2t j5dici~s!2d jc j~s!, ~6!where di and d j are the distances between the animal andreceivers i and j , respectively. By assumption, ci(s) is un-equal to c j(s). For all points in space we havedi5d j1D , ~7!where D must be less than or equal to the distance betweenthe receivers, soD<uri2rju,‘ , ~8!since the receiver separation, uri2rju, is finite. Substitute Eq.~7! into Eq. ~6! and simplify to gett i j5d jS 1ci~s! 2 1c j~s! D1 Dci~s! . ~9!All measured lags, t i j , are finite and the only way to obtainthese finite values for ci(s)Þc j(s) is to demand that d j beFIG. 1. A, B: Two-dimensional hyperbola ~dashed! compared with two-dimensional isodiachron ~solid!. Locations of the two receivers ~asterisks! are atCartesian coordinates (21,0) and ~1,0!. The effective speeds of sound between the calling animal and receivers one and two are 330 and 340 m s21,respectively. The lag, t12 , is 10.0015 s. The hyperbola is computed for an effective speed of 330 m s21. C, D: Same except the lag is 20.0015 s.3171J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronsfinite because D is finite @Eq. ~8!#. Therefore, all points on anisodiachron are a finite distance from the receivers whenci(s)Þc j(s).Several facts concerning class one isodiachrons are use-ful. We derive an expression for y(x), the locations of their xintercepts, and the bounds for their lags. Some of the morecomplicated algebraic expressions were obtained from asymbolic mathematical software program.When the effective speeds, ci and c j , do not depend ons, the isodiachron can be expressed in Cartesian coordinateswith a polynomial of degree four.18 The polynomial coeffi-cients of degree three and four go to zero when ci and c japproach the same value c , leaving a second degree polyno-mial describing a hyperbola. For class one isodiachrons intwo spatial dimensions, Eq. ~5! reduces toa1y41a2y21a350, ~10!wherea1[c j422ci2c j21ci4ci4c j4 , ~11!a2[2~ci4c j4!21~c j4x21c j4x021ci4x21ci4x0222c j2x2ci212c j4xx022c j2ci2x022c j4t i j2 ci22t i j2 ci4c j222ci4xx0!,~12!a3[x4~c j422ci2c j21ci4!/~ci4c j4!1~ci4c j4!21~c j4x0414c j4x3x016c j4x2x0214c j4xx0322c j2x04ci21t i j4 ci4c j424ci4x3x016ci4x2x0224ci4xx0322c j4x2t i j2 ci214c j2x2ci2x0224c j4xx0t i j2 ci222c j4x02t i j2 ci21ci4x0422t i j2 ci4c j2x214t i j2 ci4c j2xx022t i j2 ci4c j2x02!, ~13!where the receivers are at Cartesian coordinates (2x0,0) and(x0,0) and x0.0. The solution for y in terms of x can besimplified by substituting z5y2 in Eq. ~10! which yields aquadratic equation in z . If z is real valued and non-negative,solutions for y are given by 6Az for a given value of x .Equation ~10! describes a hyperbola when ci5c j .The intersection of a class one isodiachron with the xaxis occurs when y is zero in Eq. ~5! which yieldsc jux1x0u2ciux2x0u5cic jt i j , ~14!where x is the x coordinate of s. The solutions arex5cic jt i j1~ci1c j!x0ci2c j; x,2x0 , ~15!x5cic jt i j1~ci2c j!x0ci1c j; 2x0<x<x0 , ~16!x5cic jt i j2~ci1c j!x0c j2ci; x0,x . ~17!We now investigate the possible values for t i j given x0 ,ci and c j . These are derived from Eqs. ~15!–~17!t i j52c j~x1x0!1ci~x2x0!cic j; x,2x0 , ~18!t i j5c j~x1x0!1ci~x2x0!cic j; 2x0<x<x0 , ~19!t i j5c j~x1x0!2ci~x2x0!cic j; x0,x . ~20!For the first case (x,2x0), t i j equals 22x0 /c j as x→2x0 . For x,2x0]t i j]x5ci2c jcic j; x,2x0 , ~21!so when ci,c j22x0 /c j<t i j,‘; x,2x0 ; ci,c j . ~22!Similarly when ci.c j2‘,t i j<22x0 /c j ; x,2x0 ; ci.c j . ~23!For the second case (2x0<x<x0), t i j equals 22x0 /c jand 12x0 /ci at x equal to 2x0 and x0 , respectively. Inbetween, we have]t i j]x51/ci11/c j ; 2x0<x<x0 , ~24!which is positive. Thus the values of t i j increase linearly inthis line segment and22x0 /c j<t i j<2x0 /ci ; 2x0<x<x0 . ~25!For the third case (x0,x), t i j equals 2x0 /ci at x5x0 .For x0,x]t i j]x5c j2cicic j; x0,x . ~26!So when ci,c j ,2x0 /ci,t i j,‘; x0,x; ci,c j ~27!and when ci.c j2‘,t i j,2x0 /ci ; x0,x; ci.c j . ~28!We see that t i j has a minimum value of 22x0 /c j when ci,c j and that the x axis is crossed twice except when t i j isthe minimum value in which case the class one isodiachrontouches the x axis once at 2x0 ~Fig. 2!. Similarly, t i j has amaximum value of 2x0 /ci when ci.c j , and the isodiachroncrosses the x axis twice except when t i j is maximum inwhich case the isodiachron touches the x axis once at x0~Fig. 3!.We now prove that the lag bounds on the x axis (t i j>22x0 /c j for ci,c j and t i j<2x0 /ci for ci.c j) are thebounds for all points on a class one isodiachron. This can beproved by showing that all such isodiachrons intersect the xaxis because then the lag is constant everywhere on an iso-diachron. We know that all class one isodiachrons are sym-metric about the x axis because all class one isodiachronshave values of y given by 6Az @see sentences following Eq.~13!#. The isodiachron is a continuous function in y(x) be-cause it is a polynomial. For two points on an isodiachrongiven by 6y(x), there must then either be a curve joiningthem through infinity ~which is impossible as shown above!,or the curve must join them through finite values and thus3172 J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronscross the x axis at a value given by Eqs. ~15–17!. Thus thelag bounds given for class one isodiachrons on the x axis arevalid for all class one isodiachrons because all class oneisodiachrons touch the x axis.A three-dimensional isodiachron can be formed by rotat-ing the two-dimensional isodiachron around the x axis ~Fig.1!. The closed form solution for isodiachronic location canyield four solutions from four receivers. This can be under-stood geometrically as follows. The first pair of receiversconstrains the source to a class one isodiachron. A third re-ceiver introduces a second isodiachron which can intersectthe first one along two different closed curves ~e.g., in theregion between x between 0.5 and 1 in panel B of Fig. 1!. Afourth receiver introduces a third isodiachron which can in-tersect the two closed curves at at most four points. In thiscase, a fifth receiver is needed to determine which of the fourpoints is correct.Because class one isodiachronic and hyperbolic surfacescan deviate significantly from one another in the vicinity ofthe receivers, hyperbolic locations can yield incorrect an-swers while isodiachronic locations are correct, even whenaccounting for errors.A. Class one isodiachrons are useful when theeffective speed is spatially inhomogeneousThe paradox is that class one isodiachrons are useful forestimating the probability density function for an animal’slocation when the effective speed varies in any realistic man-ner, including effects from advection. Understanding theparadox comes from the way this isodiachron is used by aMonte Carlo algorithm.18A constellation is the minimum number of receiversneeded to yield unambiguous solutions for location. Forthree-dimensional locations without prior knowledge of theanimal’s location, the constellation consists of four or fivereceivers, depending on the location of the animal.18An analytical solution for the animal’s location is avail-able for any constellation.18 The solution requires ~1! theeffective speeds between the animal and each receiver, ~2!locations of the receivers, and ~3! the values of the lags.When the effective speed includes advective effects, the al-gorithm needs to do an extra step because the effective speeddepends on the location of the animal, but one does not ini-tially know the location of the animal without using the ana-lytical solution. A solution to this problem is given later, butfor now it is important to state that no first guess for theanimal’s location is made by any hyperbolic location tech-nique. The relevant part of the Monte Carlo algorithm isexplained next.18When the effective speeds are unaffected by advection,the Monte Carlo algorithm adopts any realistic prior prob-ability density functions for ~1! the effective speed betweenthe animal and each receiver, ~2! the errors in the Cartesiancoordinate of each receiver in the constellation, and ~3! themeasured lags. A sample is drawn from each of the distribu-tions yielding a set called a ‘‘configuration.’’ A configurationthat does not yield at least one real-valued solution for loca-tion is discarded because the samples could not have jointlyoccurred. A ‘‘valid configuration’’ is one where there is atleast one real-valued analytical solution for location. Eachreal-valued analytical solution for location is a point at whichclass one isodiachrons from all possible receiver pairs inter-sect. The Monte Carlo algorithm has established one set ofeffective speeds between the animal and each receiver in theconstellation from the valid configuration. The Monte Carloalgorithm continues to find a sufficient number of valid con-figurations such that convergence is obtained for the prob-ability distribution of the animal’s location. The collection ofeffective speeds from all Monte Carlo runs provides an esti-mate for all the effective speeds that are consistent with thedata, the cloud of possible animal locations, and the cloudsof possible receiver locations.Class one isodiachrons are a mathematically and com-putationally convenient and efficient means for obtaining theFIG. 2. The lags, t i j , for isodiachrons as a function of their x intercepts.Receivers i and j are at Cartesian (x ,y) coordinates (2x0,0) and (x0,0),respectively. The effective speeds of the signal between receivers i and j andthe isodiachron are ci and c j , respectively, and ci,c j . t i j5t i2t j where thetimes for the signal to travel between the isodiachron and receivers i and jare t i and t j respectively. Note that the lags must occur in the interval22x0 /c j<t i j,‘ @Eqs. ~22!, ~25!, and ~27!#.FIG. 3. Same as Fig. 2 except ci.c j . In this case all isodiachrons have lagst i j<2x0 /ci @Eqs. ~23!, ~25!, and ~28!#.3173J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronsdistribution of the animal’s location because they accommo-date an analytical solution for location when the effectivespeed differs from path to path and they accommodate mod-els for sound speed and advection that are realistic whenused with the Monte Carlo algorithm.18 More specifically,the analytical solution for location is derived18 by using thefact that iri2si25ci2t i2, and then subtracting the equationfor i51 from the equations for i.1 where ci is a specifiedeffective speed that is independent of the animal’s location.When the equation for i51 is subtracted from any otherequation for i.1, the resulting equation specifies that theanimal resides somewhere on the locus of points for whichthe difference in travel time to receivers i.1 and i51 is aconstant. This is a class one isodiachron. With a constella-tion, one has enough difference equations to yield an analyti-cal solution for location.18Consider an effective speed that is affected by advec-tion, such as wind. A configuration is drawn from prior dis-tributions of the ~1! wind, ~2! speeds, ~3! receiver coordi-nates, ~4! lags, and ~5! the location of the animal, s. Thisconfiguration contains draws from the prior wind and sourcedistributions. These were not drawn when advection was un-important. One can always form a prior distribution for thelocation of the animal because one can use a uniform distri-bution in space with boundaries that are so large as to en-compass every possible location. For example, one couldknow that sounds from a cricket would originate within 200m of a receiver. Next, the effective speed between the animaland each receiver is obtained fromci5Ci1U+~s2ri!/di , ~29!where Ci is the draw from the speed distribution ~the scalarfield!, U is the draw from the vector wind distribution andthe open circle denotes dot product. Note that this draw forthe effective speed depends on a random guess for the loca-tion of the animal. The analytical solution for location is nowobtained as before, yielding location s1 . The closest real-valued solution, s1 , to the randomly chosen location for theanimal, s, is accepted ifus12su,e , ~30!where e is some small value such as 0.1 m. If all analyticalsolutions, s1 , are complex, they are discarded and a freshdraw is made for a configuration. Otherwise, the effectivespeed is updated from Eq. ~29! using s1 in place of s. Thisprocedure iterates a maximum number of times. On eachiteration the analytical solution for location is accepted if thedifference between the analytical solution for s and the mostrecent guess for s is less than e. We then have a valid con-figuration. The configuration is discarded if the maximumallowed number of iterations is exceeded, and one starts withfresh draws for the five categories of variables until one hassufficient numbers of valid configurations to yield accurateestimates of the distribution of the animal’s location. Be-cause effects from advection are incorporated into the effec-tive speed, the geometrical interpretation for the analyticalsolution for location is based on class one isodiachrons asbefore. We see that realistic variations of advection andsound speed are accounted for in the probability distributionof the animal’s location.B. Example in airConsider a two-dimensional geometry where five receiv-ers are located at Cartesian coordinates ~0,0!, ~25,0!, ~50,3!,~30,40!, and ~5,30! m ~Fig. 4!. An animal is located at ~22,2!m. The speed of sound is assumed to be a typical 330 m/s,and a wind is blowing in the positive y direction at 10 m/s.With R receivers there areNt5R~R21 !/2, ~31!possible lags (t i j ,i51,.. . ,R21; j5i11,.. . ,R) so for R55,we get Nt510. All ten lags are computed without error and,for each, the isodiachron and hyperbola are drawn. The hy-perbolas are drawn for an effective speed of 330 m/s. Someof the hyperbolas look like the isodiachrons and others donot ~Fig. 5!. Isodiachrons all intersect the animal locationexactly, but the hyperbolas do not, as it is impossible forthem to accommodate variations in effective speed from pathto path with the hyperbolic assumption. No attempt has beenmade to find a single effective speed that minimizes the re-siduals from a central intersection point, but this is not im-portant to do in this context because the hyperbolas wouldnot intersect at a point anyway, and some of their shapes arequite different than the isodiachrons ~Fig. 5!.The location of the animal in Fig. 4 coincides with thepoint of intersection of the isodiachrons because this ex-ample uses error-less values for the variables that determinelocation ~lags, receiver locations, and effective speeds!. Thepresence of errors dictates that there are an infinite number ofpossible animal locations consistent with measurements.With truncated prior distributions of error for the pertinentvariables ~lags, receiver locations, and effective speeds!, theinfinite number of possible locations can be confined to afinite region. The nonlinear Monte Carlo algorithm18 drawsfrom the prior distributions of these variables to find animallocations for which all ten isodiachrons intersect at onepoint. These locations form clouds of feasible locations ofthe animal. The feasible locations near the animal have setsof 10 isodiachrons that look like those in Fig. 4.C. Example in oceanConsider a two-dimensional geometry where five receiv-ers are located at Cartesian coordinates ~0,0!, ~4000,0!,~1500,3000!, (250,22000), and (2000,23000) m ~Fig. 6!.Suppose these receivers are located near a zonal front wherethe speed of sound is 1500 m/s to the south and 1525 m/s tothe north of the x axis ~Fig. 6!. Suppose a whale calls at(3960,220) m. Then the effective speed of sound is 1500m/s for all receivers except the one at ~1500,3000! m whereit is 1524.8 m/s because the signal crosses the front to thenorth. Hyperbolic locations assume the effective speed is1512.5 m/s. This is the average of the speeds on either sideof the front. Isodiachrons and hyperbolas are drawn withoutdata error.Some of the hyperbolas look like isodiachrons, and oth-ers do not ~Fig. 6!. When isodiachronic location18 is used to3174 J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronslocate the whale, the Nt510 isodiachrons always intersect atthe same point. The hyperbolas can never intersect at thesame point, and their mismatches indicate the inability ofhyperbolic geometry to find a correct location when the ef-fective speed differs from path to path. Even when one ac-counts for errors in the effective speeds, the lags, and thelocations of the hydrophones, isodiachrons always intersectat the same point and hyperbolas do not.18D. Other examplesIsodiachrons could be used to locate animals when theeffective speeds are greatly different from path to path. Forexample, a modeling study28 indicates that low-frequencysounds from a fin whale could travel to hydrophones throughdifferent paths. Some receivers close to the whale could pickup only the first acoustic path through the sea, while otherdistant receivers could pick up only the acoustic path thatpropagates below the sea floor because the paths through thewater could be blocked by seamounts. The effective speedthrough the water and solid Earth can differ by more than afactor of 2.28There are other possibilities. Sounds created by someanimals can reach receivers through both the air and the solidEarth.29,30 Seals flap their flippers on the surface and thesound propagates in air and water to distant receivers.31 Allthese animals could be located with isodiachrons.IV. CONCLUSIONWhen one seeks accurate locations for a calling animalfrom measurements of the time differences of signals, con-sideration must be paid to the differences in effective speedalong different paths if such differences exist. Differences ineffective speed are significant enough in air and water tohave led researchers to adopt models for location that allowthe effective speeds to differ from path to path.15–18 Path-to-path variations in effective speed are inconsistent with a geo-metrical interpretation based on a hyperbola. Instead, onecan visualize a new geometrical shape, called an isodiachron,to interpret location in this situation. The isodiachron is theFIG. 4. Left column: The ten isodiach-rons corresponding to the ten lags de-rived from an animal at Cartesian co-ordinate ~22,2! m ~circle! in air andrecorded at five receivers ~X’s!. One ofthe receivers at ~25,0! m is close to theanimal so its X is not resolved but isvisible in Fig. 5. The bottom shows theisodiachrons within a few meters ofthe animal. Right column: Same ex-cept these are the ten hyperbolas. Thespeed of sound is 330 m/s and a spa-tially homogeneous wind is blowing inthe positive y direction at 10 m/s. Thehyperbolas are derived by assumingthe effective speed of sound is 330m/s. Note the hyperbolas do not inter-sect at the same point nor do they in-tersect the animal ~bottom right!.Some of the isodiachrons are similarto the hyperbolas, and some are quitedifferent ~Fig. 5!.FIG. 5. Same as Fig. 4 except only the isodiachron ~solid! and hyperbola~dashed! corresponding to one particular lag are shown.3175J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronslocus of points corresponding to a constant difference intravel time along straight paths between the animal and tworeceivers. Isodiachrons differ significantly in shape from hy-perboloids for many problems of practical interest ~Figs.4–6!.It seems interesting to speculate why ancient Greekmathematicians did not think about isodiachrons. The hyper-bola was discovered by them ~pp. 280, 281, Vol II, Ref. 12!.Why did they conceive of hyperbolas? Perhaps the answer tothis question is not currently known due to the loss of ancientdocuments. But something is known about the motivation forgeometry and in the use of a hyperbola during these times.The word ‘‘geometry’’ comes from the Greek words geo forEarth and metron which means to measure. The emphasis onmeasuring the Earth was a principal motivation for theGreek’s development of this branch of mathematics.12The earliest known written reference to a hyperbolamentions Menaechmus who used it to solve the problem ofhow long to make the side of a cube so as to double itsvolume, a problem that today is solved by knowing how tocompute a cube root of a number ~pp. 280, 281, Vol. II, Ref.12!. There are two ancient documents describing the originof this problem. The first explains that God asked the Deliansvia an oracle to double the size of an altar to rid themselvesof a plague ~p. 257, Vol. I, Ref. 12!. The workman did notknow how to double a volume, and asked Plato for help, whohimself did not know the method of solution. The seconddocument explains that an ancient tragic poet portrayed Mi-nos preparing a tomb for Glaucus in the shape of a cubewhose sides were a hundred feet in length. There was a de-sire to double the volume as to be more suitable for royalburial ~pp. 257–259, Vol. I, Ref. 12!. Thus the hyperbola’sfirst known reference occurs in the context of solving a prac-tical problem.The idea of measuring location from the propagationtime of signals is conveniently done using electronic equip-ment developed in the modern age. It is plausible that ancientGreeks would not consider the isodiachron because it wouldperhaps have been too distant from the problems of their day,though they may have had the mathematical tools needed toderive the geometrical shape.Besides allowing a general physical interpretation forlocation in spatially inhomogeneous media of effectivespeed, isodiachrons are the geometrical shapes that are inter-sected for an analytical solution for location18 ~Figs. 4, 6!.Isodiachrons revert to hyperboloids when the effective speedis spatially homogeneous.ACKNOWLEDGMENTSI thank my family, Mary, Ari, and Maia, for their loveand in giving me time to pursue this paper. I thank AndrewJacobson, Eugene Terray, and the reviewers, Magnus Wahl-berg and the anonymous reviewer, for their comments whichgreatly improved its content.1 Global Positioning System: Theory and Applications, Volume I, edited byB. W. Parkinson and J. J. Spilker, Jr. ~American Institute of Aeronauticsand Astronautics, Washington, DC, 1996!, Vol. 163, p. 781.2 R. A. Walker, ‘‘Some intense, low frequency, underwater sounds of widegeographic distribution, apparently of biological origin,’’ J. Acoust. Soc.Am. 35, 1816–1824 ~1963!.3 W. A. Tyrrell, ‘‘Design of acoustic systems,’’ in Marine Bioacoustics,edited by W. N. Tavolga ~Pergamon, Oxford, 1964!, pp. 65–86.4 W. A. Watkins and W. E. Schevill, ‘‘Four hydrophone array for acousticthree-dimensional location,’’ Woods Hole Oceanographic Technical Re-port No. 71-60, 1971.5 W. A. Watkins and W. E. Schevill, ‘‘Listening to Hawaiian Spinner Por-poises, STENELLA CV. LONGIROSTRIS. with a three-dimensional hydro-phone array,’’ J. Mammal. 55, 319–328 ~1974!.6 W. C. Cummings and D. V. Holliday, ‘‘Passive acoustic location of bow-FIG. 6. Left column: The ten isodiach-rons corresponding to the ten lags de-rived from a simulated call at Carte-sian coordinate (3960,220) m ~circle!in water and recorded at five hydro-phones ~X’s!. One of the hydrophonesat ~4000,0! m is close to the animaland can barely be made out on the bot-tom row where the isodiachrons areshown within a few hundreds ofmeters of the animal. Right column:Same except these are the ten hyper-bolas. The speed of sound is 1500 and1525 m/s on the lower and upper re-gions of the figures, respectively. Thefrontal region separating these speedsoccurs at y50 ~dashed!. The hyperbo-las are derived by assuming the effec-tive speed of sound is 1512.5 m/s, theaverage of the speeds on either side ofthe front. Note the hyperbolas do notintersect at the same point nor do theyintersect the animal ~bottom right!.Some of the isodiachrons are similarto the hyperbolas, and some are quitedifferent.3176 J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachronshead whales in a population census off Point Barrow, Alaska,’’ J. Acoust.Soc. Am. 78, 1163–1169 ~1985!.7 C. Clark, W. T. Ellison, K. Beeman, ‘‘Acoustic tracking of migratingbowhead whales,’’ Oceans 86 ~IEEE Oceanic Eng. Soc., New York, 1986!,pp. 341–346.8 B. Mohl, M. Wahlberg, P. T. Madsen, L. A. Miller, and A. Surlykke,‘‘Sperm whale clicks: Directionality and source level revisited,’’ J. Acoust.Soc. Am. 107, 638–648 ~2000!.9 C. O. Tiemann and M. B. Porter, ‘‘A comparison of model-based andhyperbolic localization techniques as applied to marine mammal calls,’’ J.Acoust. Soc. Am. 114, 2406 ~2003!.10 N. Marchand, ‘‘Error distributions of best estimate of position from mul-tiple time difference hyperbolic networks,’’ IEEE Trans. Aerosp. Naviga-tional Electron. 11, 96–100 ~1964!.11 R. O. Schmidt, ‘‘A new approach to geometry of range difference loca-tion,’’ IEEE Trans. Aerosp. Electron. Syst. AES-8, 821–835 ~1972!.12 I. Thomas, Greek Mathematical Works, Vols. I and II, Aristarchus to Tap-pus of Alexendria ~Harvard University Press, Cambridge, 1939!.13 H. C. Schau and A. Z. Robinson, ‘‘Passive source localization employingintersecting spherical surfaces from time-of-arrival differences,’’ IEEETrans. Acoust., Speech, Signal Process. ASSP-35, 1223–1225 ~1987!.14 J. Hoshen, ‘‘The GPS equations and the problem of Apollonius,’’ IEEETrans. Aerosp. Electron. Syst. 32, 1116–1124 ~1996!.15 H. T. Vincent ‘‘Models, algorithms, and measurements for underwateracoustic positioning,’’ Ph.D. dissertation, University of Rhode Island,Kingston, RI, 2001.16 H. T. Vincent and Sau-Lon J. Hu, ‘‘Geodetic position estimation for un-derwater acoustic sensors,’’ US Patent No. 6,028,823 ~22 Feb., 2000!.17 H. T. Vincent and Sau-Lon J. Hu, ‘‘Method and system for determiningunderwater effective sound velocity,’’ US Patent No. 6,388,948 ~14 May,2002!.18 J. L. Spiesberger and M. Wahlberg, ‘‘Probability density functions forhyperbolic and isodiachronic location,’’ J. Acoust. Soc. Am. 112, 3046–3052 ~2002!.19 M. Wahlberg, B. Mohl, and P. Madsen, ‘‘Estimating source position accu-racy of a large-aperture hydrophone array for bioacoustics,’’ J. Acoust.Soc. Am. 109, 397–406 ~2001!.20 I. Magyar, W. M. Schleidt, and D. Miller, ‘‘Localization of sound produc-ing animals using the arrival time differences of their signals at an array ofmicrophones,’’ Experientia 34, 676–677 ~1978!.21 S. Mitchell and J. Bower, ‘‘Localization of animal calls via hyperbolicmethods,’’ J. Acoust. Soc. Am. 97, 3352–3353 ~1995!.22 J. M. Burt, ‘‘Use of a radio microphone array to study banded-wren songinteractions at the neighborhood level,’’ J. Acoust. Soc. Am. 108, 2583~2000!.23 M. Wahlberg, J. Tougaard, and B. Mohl, ‘‘Localizing bitterns Botaurusstellaris with an array of non-linked microphones,’’ Bioacoustics 13, 233–245 ~2003!.24 M. Wahlberg, G. Ramos-Fernandez, F. Ugarte, B. Mohl, and M. Rasch,‘‘Recording spider monkeys ~Ateles geoffroyi! with a microphone array,’’PhD. dissertation, Chapter IX, Centre for Sound Communication, Instituteof Biology, U. Southern Denmark, 2002.25 M. S. Dantzker, G. B. Deane, and J. W. Bradbury, ‘‘Directional acousticradiation in the strut display of male Sage Grouse Centrocercus Uropha-sianus,’’ J. Exp. Biol. 202, 2893–2909 ~1999!.26 C. W. Helstrom, Statistical Theory of Signal Detection ~Pergamon, NewYork, 1975!, pp. 276, 470.27 Global Positioning System standard positioning service performance stan-dard, OASD~C31!/ ODASD ~C3ISR!/Space Systems, Attn: Assistant forGPS, Positioning and Navigation, 6000 Defense Pentagon, Washington,DC 20301-6000, p. 54. Oct. 2001.28 V. Premus and J. L. Spiesberger, ‘‘Can acoustic multipath explain finbackB. physalus 20-Hz doublets in shallow water?,’’ J. Acoust. Soc. Am. 101,1127–1138 ~1997!.29 P. M. Narins, ‘‘Frog communication,’’ Sci. Am. 263, 78–83 ~1995!.30 T. Reuter, S. Nummela, and S. Hemila¨, ‘‘Elephant hearing,’’ J. Acoust.Soc. Am. 104, 1122–1123 ~1998!.31 M. Wahlberg, S. G. Lunneryd, and H. Westerberg, ‘‘The source level ofharbour seal flipper slaps,’’ Aquatic Mammals 28.1, 90–92 ~2002!.3177J. Acoust. Soc. Am., Vol. 116, No. 5, November 2004 John L. Spiesberger: Location geometry, travel time differences, isodiachrons