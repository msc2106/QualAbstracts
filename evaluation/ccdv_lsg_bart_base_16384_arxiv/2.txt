ABSTRACT: 
We present a method of estimating density-related functionals, without prior knowledge of the density’s functional form. The approach revolves around the specification of an explicit formula for a new class of distributions that encompasses many of the known cases in statistics, including the normal, gamma, inverse gamma, and mixtures thereof. The functionals are based on a couple of hypergeometric functions. Their parameters can be estimated, and the estimates then reveal both the functional form of the density and the parameters that determine centering, scaling, etc. The function to be estimated always leads to a valid density, by design, namely, one that is nonnegative everywhere and integrates to 1. Unlike fully nonparametric methods, our approach can be applied to small datasets. To illustrate our methodology, we apply it to finding risk-neutral densities associated with different types of financial options. We show how our approach fits the data uniformly very well. We also find that our estimated densities’ functional forms vary over the dataset, so that existing parametric methods will not do uniformly well. 
 
PREDICTION: 
 we present a new method of estimating density-related functionals , without prior knowledge of the density,the function to be estimated always leads to a valid den- sity , by design , namely , one that is nonnegative everywhere and integrates to 1+ Unlike fully nonparametric methods , our approach can be applied to small data- sets . to illustrate our methodology 
 , we apply it to finding risk-neutral densities associated with different types of financial options+ We show how our approach fits the data uniformly very well+ We also find that our estimated densities vary over the dataset , so that existing parametric methods 
 
FULL TEXT: 
 This is a repository copy of Density functionals, with an option-pricing application. White Rose Research Online URL for this paper: http://eprints.whiterose.ac.uk/588/ Article: Abadir, K.M. and Rockinger, M. (2003) Density functionals, with an option-pricing application. Econometric Theory. pp. 778-811. ISSN 0266-4666 https://doi.org/10.1017/S0266466603195047 eprints@whiterose.ac.uk https://eprints.whiterose.ac.uk/ Reuse Items deposited in White Rose Research Online are protected by copyright, with all rights reserved unless indicated otherwise. They may be downloaded and/or printed for private study, or other acts as permitted by national copyright laws. The publisher or other rights holders may allow further reproduction and re-use of the full text version. This is indicated by the licence information on the White Rose Research Online record for the item. Takedown If you consider content in White Rose Research Online to be in breach of UK law, please notify us by emailing eprints@whiterose.ac.uk including the URL of the record and the reason for the withdrawal request. DENSITY FUNCTIONALS, WITH AN OPTION-PRICING APPLICATION KARIM M. ABADIR University of York MICHAEL ROCKINGER HEC Lausanne, CEPR, and FAME We present a method of estimating density-related functionals, without prior knowl- edge of the density’s functional form+ The approach revolves around the specifi- cation of an explicit formula for a new class of distributions that encompasses many of the known cases in statistics, including the normal, gamma, inverse gamma, and mixtures thereof+ The functionals are based on a couple of hypergeo- metric functions+ Their parameters can be estimated, and the estimates then re- veal both the functional form of the density and the parameters that determine centering, scaling, etc+ The function to be estimated always leads to a valid den- sity, by design, namely, one that is nonnegative everywhere and integrates to 1+ Unlike fully nonparametric methods, our approach can be applied to small data- sets+ To illustrate our methodology, we apply it to finding risk-neutral densities associated with different types of financial options+ We show how our approach fits the data uniformly very well+ We also find that our estimated densities’ func- tional forms vary over the dataset, so that existing parametric methods will not do uniformly well+ 1. INTRODUCTION It is often the case that one wishes to estimate a probability density function ~p+d+f+! of a variate, without prior knowledge of its functional form+ If the var- iate is directly observable, a number of parametric and nonparametric methods We thank Hans-Jürg Büttler, Aleš Černý, Tony Culyer, Les Godfrey, David Hendry, Sam Kotz, Steve Lawford, Peter Phillips, Bas Werker, and three anonymous referees for their comments+ We also thank for their feedback the participants at the seminars and conferences where this paper has been invited, in particular the 1998 CEPR Finance Network Workshop, the 1998 METU conference, the 1998 FORC ~Warwick! conference “Options: Re- cent Advances,” Money Macro & Finance Group, the Swiss National Bank, Imperial College, Tilburg University, Université Libre de Bruxelles, the University of Oxford, Southampton University, and UMIST+ The first author acknowledges support from the ESRC ~UK! grant R000239538+ The second author acknowledges help from the HEC Foundation and the European Community TMR grant “Financial Market Efficiency and Economic Effi- ciency+” This paper was written when the second author was affiliated with HEC-Paris+ Address correspondence to: Karim M+ Abadir, Department of Mathematics and Department of Economics, University of York, Hesling- ton, York YO10 5DD, England; e-mail: kma4@york+ac+uk+ Econometric Theory, 19, 2003, 778–811+ Printed in the United States of America+ DOI: 10+10170S0266466603195047 778 © 2003 Cambridge University Press 0266-4666003 $12+00 are already available for estimating the density+ If, however, the variate is not observable, and its density can only be extracted indirectly, the problem is more complicated+ In this paper, we propose a method that can be used in the case of either type of variate+ Its advantages are illustrated with the following application+ 1.1. A Motivating Problem Let St be the price of an asset at time t+ To illustrate, we assume for the mo- ment that the asset does not pay dividends and that it is domestic, i+e+, no con- siderations need to be paid to foreign interest rates+ Later on, we will consider an extension to foreign currency options+ Suppose that this asset is underlying a European call option with expiration date T and strike price K+ Then, the intrinsic value of this option at expiration is VT 5 max~ST 2 K,0!+ In an arbitrage-free economy, it is known ~see Harri- son and Pliska, 1981! that there exists a risk-neutral density ~RND! g~{! such that the price of a call option can be written as Ct ~K ! 5 e 2r~T2t !Et ~VT !5 e 2r~T2t !E K ` ~ST 2 K !g~ST ! dST , (1) where Et~{! is the expectations operator conditional on all information avail- able at time t, Ct~{! is the price at time t of the call option, and r is the contin- uously compounded risk-free interest rate+ The function Ct~{! depends on the parameters r,T, t and also on others characterizing the process followed by St + In an arbitrage-free economy we also have the martingale condition St 5 e 2r~T2t !Et ~ST !, (2) where the expectation is taken with respect to the RND g~{!+ As noticed by Breeden and Litzenberger ~1978!, differentiating the integral gives d dK Ct ~K ! 5 2e 2r~T2t !E K ` g~ST ! dST [2e 2r~T2t ! @1 2 G~K !# , (3) where G~{! is the cumulative distribution function ~c+d+f+! corresponding to the p+d+f+ g~{!+ The second derivative is given by d2 dK 2 Ct ~K !* K5ST 5 e2r~T2t !g~ST !, which reveals the required density g~{!+ It is convenient to work with the future value C~K ! [ er~T2t !Ct ~K ! (4) whose second derivative is the required density function+ DENSITY FUNCTIONALS 779 If the asset were to return a yield of r * , or if we were to consider a currency call option with foreign interest rate r *, the martingale condition of the arbitrage- free economy ~2! would be St 5 e 2~r2r * !~T2t !Et ~ST ! (29) instead of ~2!+ Of course, no alterations are necessary in formulas ~1!, ~3!, and ~4!, where r is the unchanged discount factor used to calculate present values+ One way to estimate the density is to postulate a parametric form for g~{!, work out analytically the corresponding integrals leading to an explicit C~{!, and then fit the observed option prices C~K ! to the strike prices K to determine the parameters of g~{!+ Mixtures of lognormal distributions have been used by Bahra ~1996!, Melick and Thomas ~1997!, and Söderlind and Svensson ~1997!+ It is possible to assume that the underlying process is more general than a log- normal diffusion ~for jump-diffusion versions, see Bates, 1996a, 1996b; Malz, 1996!+ Alternatively, a nonparametric approach may be adopted+ Jarrow and Rudd ~1982! have developed a method based on an Edgeworth expansion involving a lognormal density+ This approach has been implemented by Corrado and Su ~1996! to price options+ Using a system of Hermite polynomials, Madan and Milne ~1994! suggest a method of approximating the underlying RND, and Abken,Madan, and Ramamurtie ~1996! provide an application+ See also Knight and Satchell ~1997! and Jondeau and Rockinger ~2001!, where Gram–Charlier expansions are used+ Stutzer ~1996! uses a Bayesian method based on the maximum-entropy principle of Shannon+ Finally, in a time series context where large datasets are available, Aït-Sahalia and Lo ~1998! fit kernel-based esti- mates to the RND+ See also Bondarenko ~2000!+ For a survey assessing exist- ing methods, see Jondeau and Rockinger ~2000!+ Also, numerical methods can be used to estimate functionals of densities and0or to simulate option prices, but these have not been used to generate RNDs ~e+g+, see Wilmott, Dewynne, and Howison, 1993!+ Improvements over these approaches are possible, because they are either restrictive ~lognormals or jump-diffusions!, do not always yield positive prob- abilities ~Edgeworth expansions or Hermite polynomials!, or require a large number of observations ~kernel estimates!+ Furthermore, the methodology we are about to suggest is general, and it may be applied to other problems not necessarily related to finance or economics+ 1.2. The Plan The initial problem is to design a general function whose second derivative is a class of density functions+ We derive such a function, and find that it is based on the confluent hypergeometric 1F1 function+ 1 Examples of recent uses of this function in economics include the option-pricing approach to investment 780 KARIM M. ABADIR AND MICHAEL ROCKINGER ~Dixit and Pindyck, 1994! and pricing of callable bonds ~Büttler and Waldvo- gel, 1996!+ Also, Abadir and Lucas ~2000! show that this function is necessary to represent densities associated with the minimal sufficient functionals of Ornstein–Uhlenbeck processes, and all the related processes satisfying an in- variance principle such as the functional central limit theorems in Phillips ~1987!+ In these applications, a reason for the success of 1F1 is that it includes as spe- cial cases the incomplete-gamma and the normal distribution functions, in ad- dition to mixtures of the two+ Also, iterated integrals and0or derivatives of 1F1 give mixtures of 1F1, which makes certain classes of these functions closed under such operations+ These features suggest them as a natural tool to model option prices and, more generally, functionals of densities+ For practical purposes, parsimony of the model is important+ For example, considering the data in our motivating problem, there are not many strike prices available+ Our approach is of a parsimonious semi-nonparametric nature, clos- est in spirit to fitting a system of orthogonal Hermite polynomials+ However, we do not estimate a system but rather the parameters of a couple of functions+ The functions we use include Laguerre and Hermite polynomials as special cases, with the added advantage that Abadir’s ~1993a, 1999! “fractional” polynomials allow for monotonic behavior at the tails of the density and thus do not suffer from the forced oscillatory nature that standard polynomials have for extreme values+ Within our model, parameter estimates determine the functional form, in addition to the usual distributional properties ~e+g+, centering and scaling!+ This is more efficient than fully nonparametric estimation, which runs into dif- ficulties in small samples+ It is also more flexible than parametric methods that restrict functional forms+ We do not restrict the functional form of the density to a single type+ The only restriction we impose is that it must belong to some family of densities to be specified in Section 2, which includes exponential and degenerate nonexpo- nential cases+ This new class of closed-form densities that we are proposing can have applications in other areas of statistics too and can be used to charac- terize a broad selection of continuous random variables+ For example, this class can be used to provide an alternative approach to fully nonparametric density estimation+ Another application would be to model nonnormal densities in gen- eralized autoregressive conditional heteroskedasticity ~GARCH! models, etc+ Our class of densities does not assume the existence of moments, thus avoiding the problem of basing an estimation procedure on calculated “moments” that may be spurious+ In the next section we introduce our density functional, based on 1F1, for the case of double integrals of densities+ In Section 3 we illustrate this methodol- ogy with two applications in option pricing+We also discuss how the empirical findings can be used for practical purposes+ In Section 4, we generalize the methodology to the case of observing any functional ~not necessarily double integrals! of densities+ We conclude in Section 5+ Proofs and lengthy deriva- tions are collected in the Appendix+ DENSITY FUNCTIONALS 781 We denote the set of natural numbers ~which excludes zero! by N and real numbers by R+ The indicator function is written as 1K, returning 1 if condition K is satisfied and 0 otherwise+ The ~complete! gamma function is denoted by G~n! for n [ R, and defining ~a!j [ ~a!~a 1 1! + + + ~a 1 j 2 1!5 G~a 1 j ! G~a! leads to the generalized hypergeometric function p FqSa1, + + + ,ap ;b1, + + + ,bq ;zD [ (j50 ` ) k51 p ~ak !j ) k51 q ~bk !j z j j! , (5) where 2b{ Ó N ø $0% + Special cases that we will be discussing frequently are g~n, z! [ E 0 z e2xx n21 dx[ z n n 1F1~n;n1 1;2 z!, 2n Ó N ø $0%, (6) F~z! [ E 2` z e2x 202 dx M2p [ 1 2 1 z M2p 1 F1S 1 2 ; 3 2 ;2 z 2 2 D [ 1 2 1 sgn~z! 2Mp gS 1 2 , z 2 2 D, (7) where g~{,{! is the incomplete-gamma function, F~z! is the standard nor- mal c+d+f+, and sgn~z! is the sign function+ 2. THE DESIGN OF DENSITY FUNCTIONALS The 1F1 function can represent a variety of density-related functions, and we will use it in Section 2+1 to propose a generalization of the normal, gamma, and other variates+ We will briefly outline how our functional is constructed and how it reduces to some well-known continuous random variables in statis- tics+ Sections 2+2 and 2+3 derive, respectively, the restrictions necessary for the density functional to have a proper underlying density and the moments im- plied by this function+ Section 2+4 discusses strategies for the estimation of our function+ 2.1. Specification and Main Special Cases We need to model integrals of c+d+f+s and possibly mixtures ~integrals! thereof+ Integrating n times the functions g~n, z! of ~6! E + + +Eg~n, z!~dz!n 5 ( j50 ` ~21! jz j1n1n j!~ j 1 n!n11 5 z n1n ~n!n11 1F1~n;n1 n 1 1;2z! (8) 782 KARIM M. ABADIR AND MICHAEL ROCKINGER and F~z! of ~7! E + + +EF~z!~dz!n 5 22~n02!21F zM2GS n 1 1 2 D 1 F1S 1 2 n 2 ; 3 2 ;2 z 2 2 D 1 1 GS n 2 1 1D 1 F1S2 n 2 ; 1 2 ;2 z 2 2 DG + (9) The latter is obtained by means of the parabolic cylinder function ~see Abadir, 1993b, 1999!, and integrals of negative orders ~i+e+, derivatives! yield the well- known Hermite polynomials+ Generally, parabolic cylinder functions are linear combinations of 1F1 functions that would allow for fractional n in ~9! and are closed under differentiation and integration: these operations keep the result within the same class of functions+ A weaker version of this property applies to other linear combinations of 1F1 too, and this makes them appealing in model- ing an arbitrary number of functionals of a class of densities that encompasses the normal, gamma, and others+ We defer introducing the case of an arbitrary number of functionals until later in Section 4, because of the added level of difficulty that it poses+ For double integrals of densities, a mixture that extends the cases seen ear- lier is given by C~z! [ c1 1 c2 z 1 1z.m1 a1~z 2 m1! b1 1F1~a2 ;a3 ;b2~z 2 m1! b3 ! 1 ~a4 !1F1~a5 ;a6 ;b4~z 2 m2 ! 2 !, (10) where 2a3,2a6 Ó N ø $0%, b2,b4 [ R2+ The indicator function is required to represent a component of the density with bounded support+ It is also sufficient for keeping the function real-valued for general b1 and b3+ Not all the parameters in C~{! are free to vary unrelatedly, because some restrictions ~at least three in general and at least seven in our motivating exam- ple! are needed for the function to be the integral of a c+d+f+, and we shall ana- lyze these restrictions in detail in our next section+ Now, we analyze the relation of C~{! to familiar distributions+ The first two parameters, c1 and c2, drop out when differentiating twice to get the density, but they are needed in general either to represent the constants of indefinite integration or when one of the limits of definite integration is in- finite+An example of the need for such constants is in ~3!, where the integral of the density is over ~K,`! rather than, say, ~2`,K !+ If the limits of integration of the functional are an interval that is a strict subset of the support of the density, then one would end up with the difference of two C~{! functions+ We shall not consider this case explicitly, because it boils down to using C~{! twice+ DENSITY FUNCTIONALS 783 The first 1F1 function in C ~{! covers the gamma and other asymmetric generalizations, whereas the second covers the case of symmetric quadratic- exponentials such as the normal+ We do not go further to quartic-exponentials ~or higher powers of even order! because they are unlikely to occur in practice unless the variate is almost degenerate+ They are nevertheless covered approx- imately by b3 in the first 1F1 function+ Examples of special cases giving inte- grals of known density functions include gamma: a1 5 ~2b2 ! b121 G~b1 1 1! , a2 5 b1 2 1, a3 5 b1 1 1, a4 5 0, b3 5 1; inverse gamma: a1 5 2~2b2 ! 12b1 b1G~2 2 b1! , a2 5 2b1, a3 5 2 2 b1, a4 5 0, b3 5 21; Weibull: a1 5 21, a2 5 1 b3 , a3 5 1 b3 1 1, a4 5 0, b1 5 1; normal: a1 5 0, a4 5 1 2M2b4p , a5 5 2 1 2 , a6 5 1 2 ; Pareto: a1 5 m1 a2 , a3 5 2m1 b2 with b2r `, a4 5 0, b1 5 0, b3 5 1, where standardization ~e+g+, centering around zero! is not imposed and the con- stants of integration c1 and c2 are to be determined by the problem at hand+ For the listing of the normal, recall that the first term in ~9! reduces to z02 when n 5 1+ Extreme-value distributions are useful in the field of value-at-risk in finance, and they are a special case of our approach+ For further degenerate special cases, see the discussion of confluences in Abadir ~1999!+2 We have provided one illustration, the Pareto, which relies on the confluence lim b2r` 1F1~a2 ;2 m1 b2 ;b2~z 2 m1!! 5 1F0Sa2 ;1 2 zm1D[ S zm1D 2a2 (11) obtained from the expansion in ~5!+ This is a case where the existence of higher order moments will hinge on the magnitude of a2+ By the definition of the Pa- reto density, we require in addition that a2 [ ~21,`! and m1 [ R1+ When estimating the function C~{!, it is worth testing for its reduction to known sim- pler cases such as those outlined previously and others in Johnson, Kotz, and Balakrishnan ~1994, 1995!+ Given the fact that our method encompasses a large class of traditional den- sities and is flexible, we believe that the potential for misspecification is small+ Of course, misspecification is always a possibility, even with the most flexible of methods that assume the least ~e+g+, fully nonparametric methods!+ For ex- ample, let z and j be two independent standard normal variates+ Then, the prod- uct h[ zj has a density that is infinite at the origin and that could be represented by hypergeometric functions of the sort we use ~see Abadir, 1999, p+ 302!+ If one were to fit a nonparametric density to data generated for h, then the ker- 784 KARIM M. ABADIR AND MICHAEL ROCKINGER nels would smooth ~build a “bridge”! over the origin in spite of the true density being discontinuous there+ Our method avoids such assumptions and encom- passes a broad class of statistical densities, including ones with discontinuities+ 2.2. Necessary Restrictions on the Parameter Space The second derivative of the C~{! function is a mixture of the densities men- tioned earlier+ By differentiating termwise the 1F1 series, g~z! [ d2 dz 2 C~z! 5 1z.m1 a1~z 2 m1! b122Fb1~b1 2 1!1F1~a2 ;a3 ;b2~z 2 m1!b3 ! 1 a2 a3 b2 b3~2b1 1 b3 2 1!~z 2 m1! b3 3 1F1~a2 1 1;a3 1 1;b2~z 2 m1! b3 ! 1 a2~a2 1 1! a3~a3 1 1! b2 2 b3 2~z 2 m1! 2b3 3 1F1~a2 1 2;a3 1 2;b2~z 2 m1! b3 !G 1 2a4 a5 a6 b4F1F1~a5 1 1;a6 1 1;b4~z 2 m2 !2 ! 1 2 a5 11 a6 11 b4~z 2 m2 ! 2 1F1~a5 1 2;a6 1 2;b4~z 2 m2 ! 2 !G+ (12) The estimate of g~z! that is implied from the estimate of C~z! should be a density+ It should be nonnegative over its support, say, ~z,, zu! # R, and inte- grate to 1+ The nonnegativity restriction is hardly ever binding near the optimum param- eter estimates, given the design of our function C~{!+ Nevertheless, it can be imposed on the estimation routine by a Lagrangian penalty function involving min~0, g~z!!, if the optimum g~{! is found to be negative+ We did not need to do so in our applications+ DENSITY FUNCTIONALS 785 For the restriction on the integral of the density, we derive d dz C~z! 5 c2 1 1z.m1 a1~z 2 m1! b121F~b1!1F1~a2 ;a3 ;b2~z 2 m1!b3 ! 1 a2 a3 b2 b3~z 2 m1! b3 3 1F1~a2 1 1;a3 1 1;b2~z 2 m1! b3 !G 1 2a4 a5 a6 b4~z 2 m2 !1F1~a5 1 1;a6 1 1;b4~z 2 m2 ! 2 !+ (13) This expression is linear in, at least, c2 and a4 so that the two restrictions that ensure the proper choice of constants of integration, namely, E z, z, g~z! dz 5 0, E z, zu g~z! dz 5 1, give rise to an explicit constraint on each of c2 and a4+ These can be directly substituted into our C~z! and there are two fewer parameters to estimate+ The two restrictions will be illustrated in the Appendix+ We have mentioned restrictions on the p+d+f+ ~positivity! and then two more on the c+d+f+ It is also natural that the integral of the c+d+f+ will necessitate one more restriction, namely, one to do with the constant of integration, which is application-specific+ It takes the form of a boundary condition on C~{!, e+g+, C~`! equals some fixed value+ Such conditions are often known in economics ~especially in growth theory! as transversality conditions and will be illustrated in the Appendix+ Because C~{! is linear in c1, this condition implies an explicit restriction on c1 that can be substituted directly into our function C~z!+ 2.3. Explicit Characterization of the Moments Finally, it is useful to characterize the moments of the density+ One of the rea- sons for doing so could be the desire to investigate and0or impose restrictions on the moments of the density if some theory ~e+g+, arbitrage pricing theory! requires them+ Another reason may be the desire to estimate our function C~{! 786 KARIM M. ABADIR AND MICHAEL ROCKINGER by fitting the data to its analytical moments, which is discussed later in Sec- tion 2+4+ Subject to these functions being nondegenerate ~i+e+, the existence condition for the moments!, E~z n ! 5E z, zu z n dG~z! 5E z, zu z n d dC~z! dz 5 Sz n dC~z! dz 2 nz n21C~z!D* z, zu 1 n~n 2 1!E z, zu z n22C~z! dz (14) by integrating by parts two times+ For n 5 1 and assuming m1 [ ~z,, zu!, this gives E~z! 5 Sz dC~z! dz 2 C~z!D* z, zu 5 a1~zu 2 m1! b121F~~b1 2 1!zu 1 m1!1F1~a2 ;a3 ;b2~zu 2 m1!b3 ! 1 a2 a3 b2 b3 zu~zu 2 m1! b3 3 1F1~a2 1 1;a3 1 1;b2~zu 2 m1! b3 !G 2 a4F1F1~a5 ;a6 ;b4~z 2 m2 !2 ! 2 2 a5 a6 b4 z~z 2 m2 !1F1~a5 1 1;a6 1 1;b4~z 2 m2 ! 2 !G* z, zu , (15) by substituting from ~13! and ~10!, respectively+ This expression is linear in a1 and can be used to reduce further the number of parameters to estimate, if there are reasons to believe that E~z! needs to be restricted, e+g+, as a result of the no-arbitrage condition ~2! in our example+ This, along with a simplification of the expression, will be done in the Appendix+ For n . 1, ~14! requires us to work out an explicit formula for the integral+ Substituting for C~z! from ~10! and integrating termwise, DENSITY FUNCTIONALS 787 E z, zu z n22C~z! dz 5 c1 n 2 1 ~zu n21 2 z, n21!1 c2 n ~zu n 2 z, n! 1 a1E m1 zu z n22~z 2 m1! b1 1F1~a2 ;a3 ;b2~z 2 m1! b3 ! dz 1 a4E z, zu z n221F1~a5 ;a6 ;b4~z 2 m2 ! 2 ! dz 5 c1 n 2 1 ~zu n21 2 z, n21!1 c2 n ~zu n 2 z, n! 1 a1 ( j50 n22Sn 2 2j Dm1n222j (k50 ` ~a2 !k b2 k ~a3 !k k! E m1 zu ~z 2 m1! b11j1b3 k dz 1 a4 ( j50 n22Sn 2 2j Dm2n222j (k50 ` ~a5 !k b4 k ~a6 !k k! E z, zu ~z 2 m2 ! j12k dz 5 c1 n 2 1 ~zu n21 2 z, n21!1 c2 n ~zu n 2 z, n! 1 a1 ( j50 n22Sn 2 2j D m1n222j~zu 2 m1!b11j11j 1 b1 1 1 3 2 F2 1 a2 , j 1 b1 1 1 b3 ; a3 , j 1 b1 1 1 b3 1 1; b2~zu 2 m1! b3 2 1 a4 ( j50 n22Sn 2 2j D m2n222j~z 2 m2 ! j11j 11 2 F2 1a5 , j 11 2 ; a6 , j 1 3 2 ; b4~z 2 m2 ! 22* z, zu + Asymptotic expansions of p Fq can be used to simplify the expression further, for extreme values of z, or zu, as is illustrated in the Appendix+ 2.4. Strategies for Estimation and Inference There is more than one possible method for estimating our function C~{!+ These include maximum likelihood ~ML!, generalized least squares ~GLS!, general- ized method of moments ~GMM!, and other approaches+We only discuss these 788 KARIM M. ABADIR AND MICHAEL ROCKINGER three+ Other attractive estimation methods, such as M-estimators, can be ana- lyzed in the same way if desired+ The pseudo-likelihood approach is one of the most appealing+ In the sim- plest case where the errors of estimating our functional C~{! are spherical nor- mals, we can fit the functional to the observed data by nonlinear least squares ~LS!+ In general, however, the errors may be nonspherically distributed+ If there was evidence of nonspherical errors, one could specify a covariance structure for the residuals+ Keeping the assumption of a pseudo-Gaussian likelihood, one could then estimate the variance-covariance matrix, say, V, by an iterative ~e+g+, two-step! procedure+ An analogous idea would apply to GLS estimation, albeit with a difference of a factor of 12 _ log~det~V!! for the objective function to be optimized+ Another potentially appealing approach would rely on the explicit formulas for the moments, which we have derived in the previous section+ GMM estima- tion would be based on these expressions+ However, we have an important con- cern with applying this method here+ We would only recommend it if the user were willing to restrict estimation to a class of our underlying densities where the moments do exist+ We have given an example of our class of densities, the Pareto, where some moments do not necessarily exist+ Subject to this proviso, the appeal of GMM would be in the ease of obtaining an estimate of the co- variance matrix for the moment restrictions+ Two theorems will now be derived for the case of a random sampling of N observed values of C~z! and the nonlinear LS estimation of the model C~z! 5 ZC~z!1 [«, where estimates are denoted by a hat, « has zero mean and variance v2 , `+ The conditions on « are sufficient but not necessary for the theorems to hold+ Moreover, when the sampling scheme is not independent and identically dis- tributed ~i+i+d+! then, for the theorems to be valid, we assume that the other methods of estimation discussed earlier are used with the correct covariance structure+ Let u denote the vector of parameters of the function C~z!, which are defined in ~10! subject to the ~exclusion! restrictions outlined there and which we denote by u [ Q+ Then, we have the following result+ THEOREM 1+ The nonlinear LS estimators of u [ Q are consistent for any of the parameters that have a nonzero impact on the function C~z! . The last part of the theorem’s statement refers to the situation when some component of C~z! drops out, in which case some ~irrelevant! parameters will not be estimated consistently+ For example, if a1 5 0, the parameters m1,a2,a3,b1,b2,b3 in ~10! are neither identified nor estimated consistently+ In such cases, however, these parameters have no effect at all on C~z! and are of no interest+ DENSITY FUNCTIONALS 789 We now turn to inference regarding the estimated parameters+ For this, we restrict u [ Q further to u [ EQ , Q by excluding the cases where either of a1,a2,b2,a5 is zero, 3 to keep standard asymptotic Gaussian inference+ Other- wise, when a hypothesis on some parameters causes other parameters to disap- pear from the model, then nonstandard asymptotics arise ~e+g+, see Andrews and Ploberger, 1994; Hansen, 1996; and references therein!+ The case of non- standard asymptotics is dealt with by Lawford ~2001! in the context of general hypergeometric functions and is not treated here+ THEOREM 2+ The nonlinear LS estimators of u [ EQ are asymptotically normal with mean u and covariance matrix v2SNES ]C ]u ]C ]u ' DD21, where N is the sample size. We need to qualify inferences in our applications of the next section with a warning, because small datasets are involved and asymptotic inference may be of limited relevance there+ The issue of finite-sample inference within a gen- eral context is, as ever, an unresolved problem+ Various possibilities for attempt- ing to improve such inference exist, but we do not pursue them in this paper, and we rely instead on the well-documented robustness of F-tests ~but not of t-ratios! ~e+g+, see Ali and Sharma, 1996; Godfrey and Orme, 2001; and their reference lists!+ Examples that can help improve finite-sample performance in- clude resampling methods such as the bootstrap+ The difficulties with bootstrap- ping in the current setup are that it would be computationally very expensive and that establishing analytically its validity for 1F1 functions is beyond the scope of this paper+ For examples on the inconsistency of the bootstrap, see Basawa, Mallik, McCormick, Reeves, and Taylor ~1991!, Young ~1994!, and Andrews ~2000!+ Of particular relevance is the discussion in Young ~1994, es- pecially p+ 385! about its failure in environments where moments need not ex- ist ~e+g+, stable laws!, which can be the case when our function collapses to the Pareto density ~11!+ 3. APPLICATIONS TO OPTION PRICING AND RISK-NEUTRAL DENSITIES 3.1. The Empirical Setup We illustrate our methodology with foreign exchange options and with S&P500 index options+ Both types of options are known to exhibit deviations from log- normality and are likely to reveal an interesting pattern in terms of densities ~for foreign exchange options, see Bates, 1996a, 1996b; for S&P500 options, see Rubinstein, 1994!+ Because our only goal in this part is to illustrate the 790 KARIM M. ABADIR AND MICHAEL ROCKINGER usefulness of our method, rather than to describe of all available options, we represent the results for a few dates and maturities+ First, for foreign exchange data, we use over the counter ~OTC! options+ Even though there exist options listed on currency exchanges, the vast majority of currency options are traded in the OTC market+ According to the Bank of In- ternational Settlement, in June 1999, the notional value of outstanding OTC currency derivatives was about 200 times larger than that of currency ex- changes+ This implies that foreign currency OTC markets have greater liquid- ity+ The drawback is that OTC option prices are usually unavailable to the public+ We were able to collect OTC data of European French franc0Deutsche mark ~FF0DM! rate options, in addition to the current exchange rate, from a large French bank for one randomly selected date ~17 May 1996! during which no particular event happened and also for another date occurring a few days after President Chirac announced a snap election ~28 April 1997! that eventually led to a landslide victory of the then opposition party+ For a given time of the day, the bank that provided us with the data re- quested quotes from the other dealers in the market+ Dealers are compelled to give a bid-ask quote+ The bank then retained the best bid and ask quote for various strike prices+ The fact that the bank retained dealer’s quotations guar- antees that the option prices are determined simultaneously+ The situation would have been quite different if only prices for traded options were available+ In such a situation reported prices might have been obtained at very different times of the day, possibly, for very different values of the underlying asset, in which case prices would have been stale+ Also, for many strike prices there may not have been transactions+ Similarly, we were given the exchange rate from the same source+ For exchange-rate quotes, the mechanism is similar to OTC op- tions in that dealers must quote a bid and ask price+ This means that for the foreign currency options, the magnitude of the nonsynchronicity bias is small+ The drawbacks of this market are that prices are not publicly available and that we were able to obtain data only for a few days+ For the first and second dates, we were able to obtain the bid and ask prices for options corresponding to ~N 5! 13 and 11 different strike prices, respec- tively+ Even though one could, for the purpose of option pricing, compute RNDs for the bid or the ask side, we decided to follow initially the convention of using the average of the bid and ask price for each strike price+ Taking the mid-spread is compatible with the use made by central bankers, who are mainly interested in the evolution of the density and its shape ~e+g+, see Campa, Chang, and Reider, 1997!+ Nevertheless, we check in Section 3+3 the importance of using the mid-spread rather than the bid or the ask prices+We report results on options with two different maturities, 1 and 3 months+ Second, for the S&P500 options, we downloaded the prefiltered data used and described in Aït-Sahalia and Lo ~1998!+ The options are European, cover 1993, and for each date there are various maturities available+ Unlike our for- eign exchange options, these index options are characterized by many strikes DENSITY FUNCTIONALS 791 and a high liquidity+ We selected three dates randomly and chose a maturity with a large number of strikes+ The benchmark option pricing model assumes that the underlying asset’s price process follows a lognormal diffusion with constant volatility s+ In this case, European-type call options are traditionally priced with Ct ~K ! 5 e 2r *~T2t !StF~d1!2 e 2r~T2t !KF~d2 !, where d1 [ log~St 0K !1 Sr 2 r * 1 1 2 s 2D~T 2 t ! sMT 2 t , d2 [ log~St 0K !1 Sr 2 r * 2 1 2 s 2D~T 2 t ! sMT 2 t + Similar formulas apply to put options+ If r * is a foreign risk-free interest rate, then we obtain the Garman and Kohlhagen ~1983! formula for foreign ex- change options+ If, instead, r * is the continuous dividend yield, then we obtain the formula for index options of Black and Scholes ~1973! and Merton ~1973!+ In the numerical applications for FF0DM options, we take for r and r * the do- mestic ~French! and foreign ~German! euro-interest rates chosen to match the expiration of the options+ We obtain data on these rates and transform them into their continuously compounded equivalents+ If one is willing to assume that volatility is constant across all strike prices, then it is possible to estimate the single volatility parameter s 2 +We follow the literature in doing this by minimizing the quadratic distance between actual and fitted prices, i+e+, by nonlinear LS+ Table 1 presents the estimates of such volatilities and also the associated goodness of fit measures+ For both dates of Table 1. Parameter estimates for lognormal distributions FF0DM options S&P500 options 17+05+1996 28+04+1997 T 2 t 30 days 90 days 30 days 90 days 3+05+1993 46 days 11+06+1993 98 days 20+10+1993 58 days s 0+0208 0+0234 0+0265 0+0256 1+5347 1+5426 1+3891 sA ~0+33%! ~0+37%! ~0+42%! ~0+41%! ~24+28%! ~24+48%! ~22+05%! N 13 13 11 11 15 17 20 R2 0+996841 0+994207 0+975545 0+966069 0+951508 0+928570 0+980671 792 KARIM M. ABADIR AND MICHAEL ROCKINGER the FF0DM options, we notice a slightly better fit for the first maturity than for the second maturity+ For the S&P500 options, we notice a better fit than for FF0DM options, with the fit being similar across the three dates+ The annualized volatility is denoted by sA 2+ For FF0DM, sA ranges between 0+33% for the 30 days-to-maturity options on 17 May 1996 up to 0+42% for similar options on 28 April 1997+ These figures are slightly smaller than those reported by Malz ~1996!, who considers the DM0£ in 1992, a series that is known to behave more erratically than the FF0DM+ The annualized volatility of the S&P 500 ranges between 22+05% for the option on 20 October 1993 to 24+48% for the option on 11 June 1993+ The difference in magnitude between the volatilities of exchange rates and stock returns is large+ However, the data are of very different nature, and the market structures also differ+ For instance, the FF0DM market was subject to tight trading bands within the European Mone- tary System+ To get an overall feel for the inaccuracy of these benchmark fits, we present in Figure 1 a typical plot of actual and fitted prices taken from the 3-months to maturity options of 28 April 1997+We notice that, for options with a high strike price, the fit is bad+ This implies that a model with constant volatility across different strike prices is incomplete+ In other words, volatility is dependent on K ~a phenomenon known as the volatility “smile” because of the U-shaped re- lation!, and further information that is not extracted by the lognormal is con- Figure 1. Original and fitted Garman–Kohlhagen call option prices, 28 April 1997, 3-months to maturity+ DENSITY FUNCTIONALS 793 tained in the available option prices+ This further information can be captured with a hypergeometric-based RND, as we will show+ 3.2. Numerical Aspects of Estimating Our Nonlinear Function C ({) We performed all optimizations with the GAUSS program and the OPTMUM module+ We used nonlinear LS as our fitting criterion for C~{!, as we did with the lognormal+ In general, though, one should consider other methods based on GLS or a likelihood criterion, as we have discussed in Section 2+4+ We do not elaborate on this point in this section, given how uniformly good the fit turned out to be and given that the sample we have for the observed C~{! is random+ This is because the data are given over a grid of options’ “deltas,” the term for ]C0]S+ This derivative is a constant plus the distribution function G~{! ~e+g+, see ~A+2! in the Appendix!+ Because the distribution function of a continuous variate is uniformly distributed when the function’s argument is random, taking a grid over the option’s deltas is equivalent to stratified sampling+ In nonlinear estimation, it is crucial for numerical stability to obtain esti- mates of comparable magnitudes+ To help the program find such estimates, we rescale the strike prices K by defining the linear transform z [ a 1 bK+ Be- cause C~{! is tied to the density of z, it is also necessary to rescale the option prices by the Jacobian of the transform, according to bC~K ! 5 C~z!+ Because the bulk of standardized density masses tends to lie in the interval @23,3# , the mapping of strike prices achieving approximately z [ @23,3# will yield a nu- merically stable estimation procedure+ Another important element in numerical optimization is the choice of initial values+ The lognormal benchmark has a shape that is not too different from a normal+ We therefore chose for the optimization to start with parameter values that arise from a normal RND+ From the discussion following ~10!, a5 5 2 1 2 , a6 5 1 2 , b4 5 2 1 2 3 variance of z , m2 5 mean of z, and the component starting with a1 is set to zero+ Setting a1 5 0 initially does not guarantee a well-behaved function at the next iteration+ For example, care should be taken not to let 2a3 [ N ø $0% , as a division by zero may occur in computing the 1F1 function ~see the expansion in ~5! and the subsequent exclu- sion restrictions!+ To make the program run smoothly, the starting values of the initially omitted component ~the one beginning with a1! may be those of a re- stricted gamma, e+g+, b1 5 1 1 a2 b3 , b3 5 1, a3 5 a2 1 2, a2 5 4, m1 5 m2 , because of the shape of RNDs known to arise in the literature ~see the refer- ences cited earlier!+ 794 KARIM M. ABADIR AND MICHAEL ROCKINGER We saw in Section 2+2 that explicit restrictions on c2, a4, and c1 exist and must be implemented in the estimation routine, and in the Appendix we sim- plify them for the setup of our problem+ Additionally, we found in our numer- ical applications that the reductions implied by the joint hypothesis b1 5 1 1 a2 b3, a5 5 2 1 2 _ , a6 5 1 2 _ cannot be rejected by an F-test+ This simplifies the former restrictions further to c1 5 2c2 m2 , c2 5 21 1 a4M2b4p, a4 5 1 2M2b4p F1 2 a1~2b2 !2a2 G~a3 ! G~a3 2 a2 ! G , (16) as shown in the Appendix+ Finally, for the no-arbitrage condition to be checked, ~2! or ~15! simplifies to E~z! 5 a1 G~a3 ! G~a3 2 a2 ! ~2b2 ! 2a2~m1 2 m2 !1 m2 , (17) which is naturally a weighted average of m1 and m2+ In both our applications, we found that the condition was satisfied by the data+ We now summarize the empirical results+ 3.3. Summary of the Results Following the estimation strategy outlined previously, we obtain the estimates displayed in Table 2 for the various dates and maturities+ Because R2 is invari- Table 2. Estimation of our C~{! function FF0DM options S&P500 options 17+05+1996 28+04+1997 T 2 t 30 days 90 days 30 days 90 days 3+05+1993 46 days 11+06+1993 98 days 20+10+1993 58 days a2 3+2375 5+2241 3+4870 2+1929 3+7889 2+8683 2+0763 a3 5+2462 7+0280 5+6126 6+5079 6+3536 6+2076 4+7731 b2 20+9250 21+3249 20+8918 20+7344 21+6314 20+9381 23+9701 b3 1+4641 1+1114 1+5385 2+0968 1+7809 1+7482 0+5589 b4 20+5907 20+1979 20+3806 20+1131 20+2023 20+1837 20+6288 m1 21+5888 22+2587 22+3913 20+8451 20+6736 21+8040 21+4815 m2 0+0128 0+2263 20+9261 20+8509 0+2864 20+1961 1+8474 N 13 13 11 11 15 17 20 R2 0+999955 0+999957 0+999945 0+999899 0+999922 0+999911 0+999661 OR2 0.999909 0.999913 0.999863 0.999749 0.999864 0.999857 0.999504 DENSITY FUNCTIONALS 795 ant to affine transformations of the data, a comparison of this statistic with the one in Table 1 is feasible+ We notice that across all estimations, the R2 and the R2 adjusted for degrees of freedom ~i+e+, OR2! for our fit are larger by a sizable magnitude than the ones obtained for the lognormal distribution+ For DM0FF options we display in Figure 2 the plot of actual and fitted prices taken from 28 April 1997 ~3-months maturity!, which is representative of the fit at all the dates we tried+ We notice an excellent fit for all options+ Also, a direct compu- tation of option prices involving formula ~1! with a numerical routine corrobo- rated that our method gives a very good fit+ We obtain a discretization of the RND by evaluating g~{! over a grid consist- ing of 1,000 points, and the plot for two dates and two maturities is in Fig- ures 3– 6+ The link between the RND and actual ~or objective! probabilities involves the degree of risk aversion of investors, and an interpretation of the RND as if it concerned the probability of the financial asset belonging to a certain range is a rough approximation+ Aït-Sahalia and Lo ~2000! and also Jackwerth ~2000! show how a measure of risk aversion may be inferred from RNDs and the actual probabilities+ Conversely, if one had a model describing risk aversion one could make a statement about actual probabilities+ These in- vestigations are beyond the scope of our paper, and central bankers are typi- cally more interested in how RNDs change from day to day than in measuring risk aversion+ Figure 2. Original data and hypergeometric-based fit, 28 April 1997, 3-months to maturity+ 796 KARIM M. ABADIR AND MICHAEL ROCKINGER Figure 3. Lognormal and hypergeometric-based risk-neutral densities, 17 May 1996, 1 month maturity+ Figure 4. Lognormal and hypergeometric-based risk-neutral densities, 17 May 1996, 3-months to maturity+ DENSITY FUNCTIONALS 797 Figure 5. Lognormal and hypergeometric-based risk-neutral densities, 28 April 1997, 1 month maturity+ Figure 6. Lognormal and hypergeometric-based risk-neutral densities, 28 April 1997, 3-months to maturity+ 798 KARIM M. ABADIR AND MICHAEL ROCKINGER Interesting comparative statics can be drawn from analyzing RNDs for dif- ferent dates and0or maturities+ The influence of major events is reflected in their changing shapes+ In our first application, graphical inspection of the RNDs confirms that the first date was a rather quiet one, whereas the second date was amid a period of great agitation+ Figures 3 and 4 display the RND for FF0DM options at 17 May 1996, for the two maturities+ We notice that for the higher maturity the spread is much larger, translating the fact that market participants associate more uncertainty with the longer run+ Also, in comparison with the lognormal case, we notice that our method reveals a heavier right tail+ This translates the fact that investors, even on a rather normal day, are paying a pre- mium in the anticipation of a latent devaluation of the FF ~the so-called peso problem!+ When we turn to the second date, there is an overall shift to the left for all distributions coming from the fact that, at that date, the FF had appreciated with respect to the DM+ When we compare the distributions with those of the first date, there is a larger spread for the p+d+f+ at all maturities+ In other words, for the second date the global uncertainty is much larger+ In addition, the right tail is more slowly decaying for the second date, reflecting the fact that market participants were contemplating the possibility of a large subsequent deprecia- tion of the FF, with a nonnegligible probability+ It should be mentioned that the bimodality of the RND, which has arisen in the literature cited earlier, is also found to varying extents in Figures 3– 6+ In our function, we have not forced this bimodality ~or any other oscillatory-tail features!, as is clear from looking at our graphs+ Our earlier talk of “two” com- ponents in our C~{! should not give the erroneous impression that our C~{! is based on just a mixture of two densities with at most two modes ~see ~12! for analytical details!+ Our graphs illustrate that this is not the case, some display- ing multimodality but others not+ See also the discussion after ~A+8! in the Ap- pendix, where we could not reduce our estimated functions to just mixtures of normal and gamma+ The multimodality, when it appears, could be due to a number of reasons+ For exchange rates, the most plausible explanation of the right hump is the expectation of a widening of the target band+ The center of the target zone was set at 3+35 FF0DM and the width was set at 62+5%, implying a band ranging from 3+2746 up to 3+4254+ The right hump, being outside this band, suggests that market participants put a nonnegligible probability on a devaluation of the FF with respect to the DM+ To check the robustness of our estimated RNDs, say, [g~{!, and the correspond- ing distributions ZG~{!, we perform a sensitivity analysis+ We estimate the pa- rameters of the hypergeometric-based C~{! when omitting one different strike price at a time, obtaining N estimates of RNDs, each based on N 2 1 strikes+ Denote each of these estimated densities by [gj~{! and their corresponding dis- tributions by ZGj~{!, where j 5 1,2, + + +N+ To illustrate, we choose our “worst”- fitting C~{!, namely, the FF0DM options at 28 April 1997, for the second DENSITY FUNCTIONALS 799 maturity+We find that the maximal absolute deviation between ZG~ST ! and each of the 11 c+d+f+s ZGj~ST !, for any j or ST , is max j,ST $6 ZG~ST !2 ZGj ~ST !6% 5 0+0056, (18) which is about half a percentage point, thus indicating a very stable estimate of the c+d+f+ This observation is corroborated by Figure 7+ There, the dotted line represents our density estimate [g~ST !, whereas the narrow band around it is obtained pointwise ~i+e+, for each ST ! as the minimal and maximal value over the N estimates [gj~ST !+ This indicates that our estimated RNDs are robust to a number of possible concerns raised in the finance literature, in addition to the traditional econometric ones+ For example, our RNDs are robust to dropping the observation with the largest bid-ask spread, or the observation with the larg- est ~or smallest! strike price K, etc+ We check further the robustness of the estimated shapes to bid-ask spreads, because this is a particularly important issue+ To do so, we reestimate the den- sities by first assuming that all option prices were at the ask side and then by assuming that they were all on the bid side+ We perform these estimations for 28 April 1997, a day when markets were rather agitated, and for the relatively illiquid 3 months to maturity option+ For these options, the spreads tend to be Figure 7. Sensitivity bounds for the hypergeometric-based density with one strike deleted at a time+ 800 KARIM M. ABADIR AND MICHAEL ROCKINGER the largest of all the options considered in this study+ The results of the estima- tion are displayed in Figure 8+As can be seen, the overall shape of the densities is the same+ In particular, the bimodality of the RNDs for this date appears to be numerically stable and not simply due to an error in the data+ Considering the implied c+d+f+s, we find that the maximal discrepancy between the mid- spread and the bid-only ~respectively, ask-only! prices is 0+058 ~respectively, 0+047!+ Though the shapes are analogous, the discrepancy of roughly 5% is larger than the one found in ~18! because here we take the sensitivity analysis to the extreme of changing all prices simultaneously+ Even so, the maximal discrep- ancy between the distributions occurs very close to the peak ~first mode! of the density, namely, at 3+37 and 3+35, respectively, but not in its tails, which are of most interest as explained earlier in connection with Central Bank policy-making+ We now turn to the estimation results pertaining to fitting our C~{! function to the S&P500 options+ Inspection of the second part of Table 2 confirms our earlier results: the hypergeometric-based C~{! function allows for a very close fit, of comparable quality to the one obtained for the FF0DM options+ For 3 May 1993, Figure 9 represents the RND obtained with the lognormal model and the hypergeometric one+ We notice now, in line with the figures repre- sented in Aït-Sahalia and Lo ~1998!, that the RND is negatively skewed for Index options+ This pattern translates the idea that investors fear a crash+ A lognormal cannot represent a negatively skewed density, and thus seems to be Figure 8. Hypergeometric-based estimated densities with ask, with bid, and with mid- spread option prices+ DENSITY FUNCTIONALS 801 incompatible with the data, whereas our hypergeometric-based densities allow for either type of skewness+ Finally, we compare our results to the fits obtained by other methods+We do not fit the entropy-based model, because it has as many parameters as data points and is therefore going to lead to R2 5 1 and OR2 5 0 everywhere+ As for the others, Table 3 reports the results+ The label “Hermite” refers to the method used by Jondeau and Rockinger ~2001! to enforce nonnegativity constraints on Figure 9. Lognormal and hypergeometric-based risk-neutral densities, S&P500 index options, 3 May 1993, 46-days to maturity+ Table 3. A comparison of R2 and OR2 ~in bold! for other methods FF0DM options S&P500 options 17+05+1996 28+04+1997 T 2 t 30 days 90 days 30 days 90 days 3+05+1993 46 days 11+06+1993 98 days 20+10+1993 58 days Hermite 0+999669 0+999878 0+990926 0+991626 0+997214 0+984918 0+993403 @0.999603# @0.999853# @0.988658# @0.989532# @0.996750# @0.982764# @0.992627# Jumps 0+999676 0+999926 0+999850 0+999804 0+997926 0+991013 0+995244 @0.999611# @0.999911# @0.999812# @0.999755# @0.997580# @0.989729# @0.994685# Mixtures 0+999947 0+999878 0+999842 0+999835 0+998267 0+990682 0+996039 @0.999906# @0.999817# @0.999812# @0.999725# @0.997573# @0.987577# @0.994983# 802 KARIM M. ABADIR AND MICHAEL ROCKINGER the estimation of Gram–Charlier densities by means of Hermite polynomials+ “Jumps” refers to the Malz-type jump-diffusion model discussed in the intro- duction, whereas “Mixtures” is the generalization of the benchmark into log- normal mixtures+ It is clear from the table that our method is always best in terms of R2 and is only once beaten by “Jumps” in terms of an OR2 that differs from ours by less than a unit in the fifth decimal place! Our method does very well and uniformly so for ~1! volatile days, in addition to quiet ones; ~2! different maturities; and ~3! options on very different underlying assets+ Our estimated densities’ functional forms vary over the dates and maturities, as can be seen in Table 2 from the parameter estimates of a2,a3,b3, the other parameters playing mainly centering and scaling roles+ Therefore, parametric methods that restrict functional forms ~e+g+, mixtures of lognormals! will not do uniformly well+ Notice also that Table 2 indicates that, in all cases studied, the tails of the RNDs decay exponentially fast+ For the markets studied, this implies that all moments of finite order exist and that the perceived probability of extreme events declines at exponential rates+ The estimated parameters of the asymmetric component of ~10! were such that it ended up representing ex- treme events by means of long tails, especially because b3 is mostly smaller than the exponential power 2 of the other component+ 4. THE DENSITY FUNCTIONAL FOR REPEATED INTEGRALS Section 2 gave a C~{! function based on generalizing ~8! and ~9! for the case of double-integrals of p+d+f+’s+ Here, we extend this approach to the situation where the pth integral of a p+d+f+ is observed, where p [ N, by taking C~z! [ c1 1 c2 z 1 {{{1 cp z p21 1 1z.m1 a1~z 2 m1! b1 1F1~a2 ;a3 ;b2~z 2 m1! b3 ! 1 ~a4 !1F1~a5 ;a6 ;b4~z 2 m2 ! 2 !+ (19) The parameters are not generally ~i+e+, for p Þ 2! in correspondence with our earlier C~z!, but the modeling methodology is the same and so is the number of free parameters+ The case p 5 1 is one where the variate z is directly observ- able, and its empirical c+d+f+ is available to compare to our fitted c+d+f+ C~z!+ Three types of restrictions on the parameters of C~z! are needed: Type I: A: restrictions on the c+d+f+ given by ~up to arbitrary constants! d p21C~z!0dz p21 for the edges of its support, namely, z, and zu; B: nonnegativity restrictions on the p+d+f+ given by d pC~z!0dz p over its support ~z,, zu!; DENSITY FUNCTIONALS 803 C: other specifics of the problem ~in our previous applications, the transversality and no-arbitrage conditions!+ Type II: a priori information+ Type III: hypotheses of reduction to known simpler forms+ In this section, without a specific application in mind, one can only implement restrictions of Types IA ~up to a constant! and IB and provide formulas ~such as expressions for the moments! that are likely to be required for Type IC+ Types II and III are application-specific and are to be determined by the user+ For Types IA and IB, we need the ~ p 2 1!th and pth derivatives of C~z!+ They are obtained by expanding the 1F1 functions in ~19! and differentiating termwise+ The result is, for either q 5 p 2 1 or q 5 p, dq dz q C~z! 5 1q5p21 cp~ p 2 1!! 1 1z.m1~21! qa1( j50 ` ~a2 !j b2 j ~a3 !j j! ~2b3 j 2 b1!q~z 2 m1! b12q1b3 j 1 a4~21! q ( j5qi ` ~a5 !j b4 j ~a6 !j j! ~22j !q~z 2 m2 ! 2j2q, where qi is the integer part of ~q 1 1!02+ There are two equivalent ways of expressing these sums+ The first is the one we have seen earlier, and it is the sum of 1F1 functions+ For general p, the expression would be quite cumber- some, so we resort to the second possible method+ It makes use of the general- ized hypergeometric function in ~5! to write dq dz q C~z! 5 1q5p21 cp~ p 2 1!! 1 1z.m1~21! qa1~2b1!q~z 2 m1! b12q 3 q11Fq11 1a2 , b1 b3 1 1, + + + , b1 2 q 1 1 b3 1 1; a3 , b1 b3 , + + + , b1 2 q 1 1 b3 ; b2~z 2 m1! b32 1 a4 Mp ~a5 !qiGSqi 1 12D ~a6 !qiG~2qi 2 q 1 1! ~4b4 ! qi ~z 2 m2 ! 2qi2q 3 3 F3 1 a5 1 qi ,1, 1 2 1 qi ; a6 1 qi ,qi 2 q 2 1 1,qi 2 q 2 1 1 2 ; b4~z 2 m2 ! 22 , (20) 804 KARIM M. ABADIR AND MICHAEL ROCKINGER where the duplication formula Mp2q22qiG~2qi 2 q 1 1! 5 GSqi 2 q 2 1 1DGSqi 2 q 2 1 1 2 D has been used+ For restrictions of Type IC, it can be helpful to derive an expression for the moments of z+ By letting q 5 p and pi [ qi ~5 integer part of ~ p 1 1!02! in ~20!, we get E~z n ! 5E z, zu z n d pC~z! dz p dz 5 ~21! pa1~2b1!p 3 E m1 zu z n~z 2 m1! b12p p11Fp11 1a2 , b1 b3 1 1, + + + , b1 2 p 1 1 b3 1 1; a3 , b1 b3 , + + + , b1 2 p 1 1 b3 ; b2~z 2 m1! b3 2 dz 1 a4 Mp ~a5 !piGSpi 1 12D ~a6 !piG~2pi 2 p 1 1! ~4b4 ! pi 3 E z, zu z n~z 2 m2 ! 2pi2p 3 F3 1 a5 1 pi ,1, 1 2 1 pi ; a6 1 pi , pi 2 p 2 1 1, pi 2 p 2 1 1 2 ; b4~z 2 m2 ! 2 2 dz 5 ~21! pa1~2b1!p( j50 n SnjD m1n2j~zu 2 m1! j1b12p11j 1 b1 2 p 1 1 3 p12 Fp12 1a2 , b1 b3 1 1, + + + , b1 2 p 1 1 b3 1 1, j 1 b1 2 p 1 1 b3 ; a3 , b1 b3 , + + + , b1 2 p 1 1 b3 , j 1 b1 2 p 1 1 b3 1 1; b2~zu 2 m1! b3 2 1 a4 Mp ~a5 !piGSpi 1 12D ~a6 !piG~2pi 2 p 1 1! ~4b4 ! pi ( j50 n SnjD m2n2j~z 2 m2 ! j12pi2p11j 1 2pi 2 p 1 1 3 4 F4 1 a5 1 pi ,1, 1 2 1 pi , j 1 2pi 2 p 1 1 2 ; a6 1 pi , pi 2 p 2 1 1, pi 2 p 2 1 1 2 , j 1 2pi 2 p 1 3 2 ; b4~z 2 m2 ! 2 2* z, zu + This completes the explicit formulas mentioned in connection with restrictions of Type I+ DENSITY FUNCTIONALS 805 5. CONCLUDING COMMENTS We have provided a new methodology for estimating density-related function- als, without prior knowledge of the density’s functional form+ In this endeavor, we have been originally motivated by a problem in the area of contingent- claim valuation+ We have shown in our applications that our method did uni- formly very well, thus illustrating the analytical justifications for our new approach+ However, the new general methodology we propose is equally appli- cable to different problems+ Future work could apply our method to different areas of research+ What this paper has done is to lay down the technical foun- dations necessary for subsequent applications+ NOTES 1+ There are two different types of confluent hypergeometric functions, Kummer’s 1F1 and Tri- comi’s C ~see Abadir, 1999, and references therein!+ There are also two related confluent hyper- geometric functions due to Whittaker, M and W+ We use only 1F1 in this paper+ 2+ The function can also mimic the basic properties of a lognormal+ For this, use page 68 of Abramowitz and Stegun ~1972!: the leading term is picked up by the symmetric quadratic compo- nent ~latter one! of C~{!, whereas the asymmetry is represented by the rest+ See also Johnson et al+ ~1994, 1995! for approximating the lognormal density by normal, gamma, and0or Weibull ones+ 3+ The parameter a4 is not free to vary unrestrictedly ~see the discussion of ~13!!+ To some extent, m2 is also not free to vary, if one believes in arbitrage pricing ~see ~15! or more clearly ~17!!+ REFERENCES Abadir, K+M+ ~1993a! The limiting distribution of the autocorrelation coefficient under a unit root+ Annals of Statistics 21, 1058–1070+ Abadir, K+M+ ~1993b! Expansions for some confluent hypergeometric functions+ Journal of Phys- ics A 26, 4059– 4066 @Corrigendum for printing error ~1993! 7663# + Abadir, K+M+ ~1999! An introduction to hypergeometric functions for economists+ Econometric Reviews 18, 287–330+ Abadir, K+M+ & A+ Lucas ~2000! A comparison of minimum MSE and maximum power for the nearly integrated non-Gaussian model+ University of York Discussion paper in economics, 2000021+ Forthcoming in Journal of Econometrics+ Abken, P+, D+B+ Madan, & S+ Ramamurtie ~1996! Estimation of Risk-Neutral and Statistical Den- sities by Hermite Polynomial Approximation: With an Application to Eurodollar Futures Op- tions+ Mimeo+ Federal Reserve Bank of Atlanta+ Abramowitz, M+ & I+ Stegun ~1972! Handbook of Mathematical Functions+ New York: Dover Publications+ Aït-Sahalia, Y+ & A+W+ Lo ~1998! Nonparametric estimation of state-price densities implicit in financial asset prices+ Journal of Finance 53, 499–547+ Aït-Sahalia, Y+ & A+W+ Lo ~2000! Nonparametric risk management and implied risk aversion+ Jour- nal of Econometrics 94, 9–51+ Ali, M+M+ & S+C+ Sharma ~1996! Robustness to nonnormality of regression F-tests+ Journal of Econometrics 71, 175–205+ Amemiya, T+ ~1985! Advanced Econometrics+ Oxford: Basil Blackwell+ Andrews, D+W+K+ ~2000! Inconsistency of the bootstrap when a parameter is on the boundary of the parameter space+ Econometrica 68, 399– 405+ 806 KARIM M. ABADIR AND MICHAEL ROCKINGER Andrews, D+W+K+ & W+ Ploberger ~1994! Optimal tests when a nuisance parameter is present only under the alternative+ Econometrica 62, 1383–1414+ Bahra, B+ ~1996! Probability distributions of future asset prices implied by option prices+ Bank of England Quarterly Bulletin, August, 299–311+ Basawa, I+V+, A+K+ Mallik, W+P+ McCormick, J+H+ Reeves, & R+L+ Taylor ~1991! Bootstrapping unstable first-order autoregressive processes+ Annals of Statistics 19, 1098–1101+ Bates, D+S+ ~1996a! Dollar jump fears, 1984–1992: Distributional abnormalities implicit in cur- rency futures options+ Journal of International Money and Finance 15, 65–93+ Bates, D+S+ ~1996b! Jumps and stochastic volatility: Exchange rate processes implicit in Deutsche Mark options+ Journal of Financial Studies 9, 69–107+ Black, F+ & M+ Scholes ~1973! The pricing of options and corporate liabilities+ Journal of Political Economy 81, 637– 659+ Bondarenko, O+P+ ~2000! Recovering Risk-Neutral Densities: A New Nonparametric Approach+ Mimeo, Department of Finance, University of Illinois at Chicago+ Breeden, D+ & R+ Litzenberger ~1978! Prices of state-contingent claims implicit in option prices+ Journal of Business 51, 621– 651+ Büttler, H+-J+ & J+ Waldvogel ~1996! Pricing callable bonds by means of Green’s function+ Math- ematical Finance 6, 53–88+ Campa, J+C+, P+H+K+ Chang, & R+L+ Reider ~1997! ERM bandwidths for EMU and after: Evidence from foreign exchange options+ Economic Policy 24, 55–87+ Corrado, C+J+ & T+ Su ~1996! S&P 500 index option tests of Jarrow and Rudd’s approximate option valuation formula+ Journal of Futures Markets 6, 611– 629+ Dixit, A+K+ & R+S+ Pindyck ~1994! Investment under Uncertainty+ Princeton: Princeton University Press+ Erdélyi, A+ ~ed+! ~1953! Higher Transcendental Functions, vols+ 1 and 2+ New York: McGraw-Hill+ Garman,M+ & S+ Kohlhagen ~1983! Foreign currency option values+ Journal of International Money and Finance 2, 231–238+ Godfrey, L+G+ & C+D+ Orme ~2001! Significance Levels of Heteroskedasticity-Robust Tests for Specification and Misspecification+ Mimeo, Department of Economics, University of York+ Gouriéroux, C+ & A+ Monfort ~1995! Statistics and Econometric Models, vol+ 1+ Cambridge: Cam- bridge University Press+ Hansen, B+E+ ~1996! Inference when a nuisance parameter is not identified under the null hypoth- esis+ Econometrica 64, 413– 430+ Harrison, J+M+ & S+R+ Pliska ~1981! Martingales and stochastic integrals in the theory of continu- ous trading+ Stochastic Processes and Their Applications 11, 215–260+ Jackwerth, J+C+ ~2000! Recovering risk aversion from option prices and realized returns+ Review of Financial Studies 13, 433– 451+ Jarrow, R+ & A+ Rudd ~1982! Approximate valuation for arbitrary stochastic processes+ Journal of Financial Economics 10, 347–369+ Johnson, N+L+, S+ Kotz, & N+ Balakrishnan ~1994! Continuous Univariate Distributions, 2nd ed+, vol+ 1+ New York: Wiley+ Johnson, N+L+, S+ Kotz, & N+ Balakrishnan ~1995! Continuous Univariate Distributions, 2nd ed+, vol+ 2+ New York: Wiley+ Jondeau, E+ & M+ Rockinger ~2000! Reading the smile: The message conveyed by methods which infer risk neutral densities+ Journal of International Money and Finance 19, 885–915+ Jondeau, E+ & M+ Rockinger ~2001! Gram-Charlier densities+ Journal of Economic Dynamics and Control 25, 1457–1483+ Knight, J+ & S+ Satchell ~1997! Pricing Derivatives Written on Assets with Arbitrary Skewness and Kurtosis+ Mimeo, Trinity College, University of Cambridge+ Lawford, S+D+C+ ~2001! Improved Modelling in Finite-Sample and Nonlinear Frameworks+ DPhil thesis, University of York+ Madan, D+B+ & F+ Milne ~1994! Contingent claims valued and hedged by pricing and investing in a basis+ Mathematical Finance 4, 223–245+ DENSITY FUNCTIONALS 807 Malz, A+M+ ~1996! Using option prices to estimate realignment probabilities in the European mon- etary system+ Journal of International Money and Finance 15, 717–748+ Melick, W+R+ & C+P+ Thomas ~1997! Recovering an asset’s implied PDF from options prices: An application to crude oil during the Gulf crisis+ Journal of Financial and Quantitative Analysis 32, 91–116+ Merton, R+ ~1973! Rational theory of option pricing+ Bell Journal of Economics and Management Science 4, 141–183+ Phillips, P+C+B+ ~1987! Towards a unified asymptotic theory for autoregression+ Biometrika 74, 535–547+ Rubinstein, M+ ~1994! Implied binomial trees+ Journal of Finance 49, 771–818+ Söderlind P+ & L+E+O+ Svensson ~1997! New techniques to extract market expectations from finan- cial instruments+ Journal of Monetary Economics 40, 383– 429+ Stutzer, M+ ~1996! A simple nonparametric approach to derivative security valuation+ Journal of Finance 51, 1633–1652+ Wilmott, P+, J+ Dewynne, & S+ Howison ~1993! Option Pricing: Mathematical Models and Compu- tation+ Oxford: Oxford Financial Press+ Young, G+A+ ~1994! Bootstrap: More than a stab in the dark? Statistical Science 9, 382– 415 ~with discussion!+ APPENDIX Proof of Theorem 1. The proof follows by checking the standard conditions for con- sistency ~e+g+, see Amemiya, 1985, Ch+ 4; Gouriéroux and Monfort, 1995, Ch+ 8!+ It draws on the properties of continuity and differentiability of hypergeometric functions detailed in, e+g+, Erdélyi ~1953!+ First, by means of the polygamma function, the func- tion C~{! is differentiable an arbitrary number of times with respect to the parameters u when u [ Q, except possibly ~depending on b1! at the point m1 5 z that has probability measure zero for the continuous variate z+ Second, the covariance of C~{! for different values of u [ Q is finite, this being the integral of a distribution function that is bounded by definition+ Finally, two nontrivial ~nonconstant! 1F1 functions will be identical for all z, if and only if their parameters are identical+ The values of randomly sampled C~z! are therefore distinct for different u [ Q+ n Proof of Theorem 2. The nonlinear LS estimators of u [ EQ , Q are consistent, by Theorem 1, so we now check the two additional conditions for asymptotic normality+ First, as mentioned in the proof of Theorem 1, the function C~{! is arbitrarily differ- entiable with respect to u when u [ Q and, a fortiori, when u [ EQ+ Second, the matrix of second derivatives of C~{! with respect to u is finite with probability 1 as seen in the proof of Theorem 1, and it has a nonsingular expectation for u restricted further to u [ EQ by the identifiability of all the parameters+ n Derivations for Section 3.2. Letting O~z n! denote terms of order of magnitude of at most z n , 1F1~a;c; z! 5 5 G~c! G~c 2 a! 6z 62aS1 1 OS 1 z DD, as zr 2` G~c! G~a! z a2cezS1 1 OS 1 z DD, as zr ` (A.1) 808 KARIM M. ABADIR AND MICHAEL ROCKINGER for z [ R+ We saw in Section 2+2 that explicit restrictions on c2, a4, and c1 exist+ Here, we specialize them to the setup of our applications+ First, consider the restrictions on c2 and a4+ In the context of ~3! and ~4! d dz C~z!* z5z, 5 G~z, !2 1 5 21, d dz C~z!* z5zu 5 G~zu !2 1 5 0, (A.2) where dC~z!0dz is given by ~13!+ On the assumption that z, # m1, the first constraint reduces to c2 5 21 2 2a4 a5 a6 b4~z, 2 m2 !1F1~a5 1 1;a6 1 1;b4~z, 2 m2 ! 2 ! (A.3) and the second is c2 5 2a1~zu 2 m1! b121F~b1!1F1~a2 ;a3 ;b2~zu 2 m1!b3 ! 1 a2 a3 b2 b3~zu 2 m1! b3 1F1~a2 1 1;a3 1 1;b2~zu 2 m1! b3 !G 2 2a4 a5 a6 b4~zu 2 m2 !1F1~a5 1 1;a6 1 1;b4~zu 2 m2 ! 2 !+ The first of these is linear in c2, and the second may be reformulated by combining the two as a4 5 1 2 a1~zu 2 m1! b121F~b1!1F1~a2 ;a3 ;b2~zu 2 m1!b3 ! 1 a2 a3 b2 b3~zu 2 m1! b3 1F1~a2 1 1;a3 1 1;b2~zu 2 m1! b3 !G 4 H2 a5a6 b4 @~zu 2 m2 !1F1~a5 1 1;a6 1 1;b4~zu 2 m2 !2 ! 2 ~z, 2 m2 !1F1~a5 1 1;a6 1 1;b4~z, 2 m2 ! 2 !#J (A.4) which is linear in a4+ In our two applications, we found that the reductions implied by the joint hypothesis b1 5 1 1 a2 b3, a5 5 2 1 2 _ , a6 5 1 2 _ cannot be rejected by an F-test+ As a result, ~A+3! and ~A+4! simplify further to c2 5 21 2 2a4 a5 a6 ~2b4 ! 2a5 G~a6 1 1! G~a6 2 a5 ! lim z,r2` ~m2 2 z, ! 22a521 5 21 1 a4M2b4p (A.5) DENSITY FUNCTIONALS 809 and a4 5 F1 2 a1~2b2 !2a2 G~a3 !G~a3 2 a2 ! @b1 2 a2 b3 # limzur` ~zu 2 m1!b12a2 b321 G 4 F22 a5a6 ~2b4 !2a5 G~a6 1 1!G~a6 2 a5 ! 3 S lim zur` ~zu 2 m2 ! 22a521 1 lim z,r2` ~m2 2 z, ! 22a521DG 5 1 2M2b4p S1 2 a1~2b2 !2a2 G~a3 ! G~a3 2 a2 ! D, (A.6) respectively, by means of formula ~A+1! for extreme values and by substitution for b1,a5,a6+ As explained in Abadir ~1999!, the asymptotic formula ~A+1! does not require 6z 6 r ` but requires only that z reach some extreme values for the standardized distribution+ Second, the restriction implied for c1 by the boundary condition of our applications can be stated explicitly here+ The reader will have noticed from ~1! and ~4! that Ct~`!5 C~`! 5 0+ For our function C~z! of ~10!, this transversality condition translates into c1 5 lim zr` S2c2 z 2 a1~2b2 !2a2~z 2 m1!b12a2 b3 G~a3 ! G~a3 2 a2 ! 2 a4~2b4 ! 2a5 G~a6 ! G~a6 2 a5 ! ~z 2 m2 ! 22a5D (A.7) by means of ~A+1!+ Similarly to the simplification of ~A+3! and ~A+4! into ~A+5! and ~A+6!, respectively, we may simplify ~A+7! further for our applications by substituting for b1,a5,a6 as c1 5 lim zr` S2c2 z 2 Sa1~2b2 !2a2 G~a3 !G~a3 2 a2 ! 1 a4M2b4pD~z 2 m2 !D 5 lim zr` ~~1 2 a4M2b4p!z 2 ~1 2 2a4M2b4p 1 a4M2b4p!~z 2 m2 !! 5 lim zr` ~~1 2 a4M2b4p!m2 ! 5 ~1 2 a4M2b4p!m2 5 2c2 m2 + (A.8) Note that for a gamma component to exist in C~{!, one would require the further sim- plifications b3 5 1 and a3 5 a2 1 2+ These were not supported by our data here ~not even at the 1% significance level! and were therefore not included in ~A+5!–~A+8!+ In other words, the first three terms of the formula for the density given in ~12! do not simplify to a gamma, but the latter two terms do reduce to a normal component+ 810 KARIM M. ABADIR AND MICHAEL ROCKINGER Finally, to implement the no-arbitrage condition ~2! of our example, we use ~A+1! to simplify E~z! of ~15! as E~z! 5 a1 G~a3 ! G~a3 2 a2 ! ~2b2 ! 2a2 lim zur` ~zu 2 m1! b12a2 b321~~b1 2 a2 b3 2 1!zu 1 m1! 2 a4 G~a6 ! G~a6 2 a5 ! ~2b4 ! 2a5 lim 2z, , zur` SS6z 2 m2 622a5S1 1 2a5 zz 2 m2DD*z, zuD 5 a1 G~a3 ! G~a3 2 a2 ! ~2b2 ! 2a2 lim zur` ~m1! 2 a4M2b4p lim 2z, , zur` SS6z 2 m2 6S1 2 zz 2 m2DD*z, zuD 5 a1 G~a3 ! G~a3 2 a2 ! ~2b2 ! 2a2m1 2 a4M2b4p lim 2z, , zur` ~2m2 2 m2 ! 5 a1 G~a3 ! G~a3 2 a2 ! ~2b2 ! 2a2m1 1 2a4~M2b4p!m2 , which can also be written as in ~17! by substituting for a4 from ~A+6!+ n DENSITY FUNCTIONALS 811 