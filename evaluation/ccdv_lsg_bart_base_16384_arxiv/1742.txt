ABSTRACT: 
Two iterative methods for the calculation of acoustic transmission through a rough interface\ud between two media are compared. The methods employ a continuous version of the conjugate\ud gradient technique. One method is based on plane-wave expansions and the other on boundary\ud integral equations and Green’s functions. A preconditioner is presented which improves the\ud convergence for spectra that include evanescent modes. The methods are compared with regard to\ud computational efficiency, rate of convergence, and residual error. The sound field differences are\ud determined for a focused ultrasound beam distorted by surfaces having a Gaussian roughness\ud spectrum. The differences are evaluated from the root-mean-square differences on the rough surface\ud and in the focal plane. 
 
PREDICTION: 
 two iterative methods for the calculation of reflection and transmission at a rough interface between two media are compared . 
 the methods employ a continuous version of the conjugate gradient technique . 
 one method is based on plane-wave expansions and the other on boundary integral equations and green�s functions . a preconditioner is presented which improves the convergence for spectra that include evanescent modes. The methods are compared with regard to computational efficiency , rate of convergence , and residual error . 
 the sound field differences are determined for a focused ultrasound beam distorted by surfaces having a gaussian roughness spectrum .  
 
FULL TEXT: 
 Ultrasound wave propagation through rough interfaces: Iterative methods Arthur P. Berkhoff and Johan M. Thijssen Biophysics Laboratory, Department of Ophthalmology, Nijmegen University Hospital, P.O. Box 9101, 6500 HB Nijmegen, The Netherlands Peter M. van den Berg Laboratory of Electromagnetic Research, Faculty of Electrical Engineering, Centre of Technical Geoscience, Delft University of Technology, P.O. Box 5031, 2600 GA Delft, The Netherlands ~Received 8 May 1995; revised 15 September 1995; accepted 20 November 1995! Two iterative methods for the calculation of acoustic transmission through a rough interface between two media are compared. The methods employ a continuous version of the conjugate gradient technique. One method is based on plane-wave expansions and the other on boundary integral equations and Green’s functions. A preconditioner is presented which improves the convergence for spectra that include evanescent modes. The methods are compared with regard to computational efficiency, rate of convergence, and residual error. The sound field differences are determined for a focused ultrasound beam distorted by surfaces having a Gaussian roughness spectrum. The differences are evaluated from the root-mean-square differences on the rough surface and in the focal plane. © 1996 Acoustical Society of America. PACS numbers: 43.20.Fn, 43.30.Hw, 43.80.Qf INTRODUCTION In echographic imaging with large array transducers, wave distortions in intervening tissue layers often are the major cause for image distortions. Various correction meth- ods have been proposed to obtain better images for these cases.1–4 In order to test the applicability and limits of the correction methods, it is important to have an accurate and efficient computational model describing the propagation through these distorting tissue layers. The sound propagation through tissue is often modeled as the propagation through a layer consisting of a cascade of thin sublayers, where each sublayer acts upon the incident wave as a random time-shift operator.5 Various papers,5–7 however, report that the wave modification cannot be described sufficiently with these models and that refraction effects also should be taken into account. In particular, ultrasound propagation through female breast5,7 suffers from severe refractive errors. In abdominal animal tissue6 strong multipath components were noticed, with refraction as a possible cause. Recently, therefore, we have tried to come up with an efficient numerical method9 to model the process of refraction, which is attacked by solving the numerical problem of wave propagation through an ir- regular interface between two uniform media. Of course, the present model should be extended with distributed wave ab- errations to get a more complete description of wave propa- gation through human tissue. If the medium parameters within each layer are assumed to be constant, then the computational problem can be re- duced to the problem of finding the acoustic variables on the interfaces of the layered configuration. The discretization of the problem leads to a large number of unknowns. Due to the size of the numerical problem, iterative methods are essen- tial. Iterative methods can lead to dramatically reduced stor- age requirements and total computation time, especially for 3-D calculations. Also for large 2-D problems the require- ments on computation time and memory resources can be prohibitive. In this paper, two iterative methods are described for the calculation of reflection and transmission at a rough interface between two media. Both methods are based on a continuous version of the conjugate gradient technique.8 One method is based on plane-wave expansions9 while the other method is based on boundary integral equations and free-space Green’s functions.10 Although the application deals with pulse-echo ultrasound, the domain of analysis is the frequency domain. An analysis in the frequency domain has the advantage that the strongly frequency-dependent absorption and dispersive sound speed can be incorporated quite easily. Time-domain results are obtained by analyzing the problem at several fre- quencies and subsequently calculating the inverse ~temporal! Fourier transform. Wave propagation through random inter- faces can be analyzed by evaluating a large number of interfaces.11 According to Altmeyer,12 typical acoustic inter- faces in human tissue have a root-mean-square surface height of at least 0.5 mm. Characteristic length scales of these sur- faces are not given by Altmeyer. The soft tissues show low contrast between the different tissue layers, with a difference in sound speed typically lying between zero and five percent. The extensions and novel techniques presented in this paper are the preconditioning scheme for the iterative plane- wave method of Ref. 9, an efficient preconditioner for this scheme, the comparison of the iterative methods, and the application of rigorous computational techniques to propaga- tion through refractive rough interfaces similar to those oc- curring in human skin and subcutaneous layers. I. FORMULATION OF THE PROBLEM The rough interface is assumed to be a local deformation of an otherwise plane boundary at z50, where a point in 1306 1306J. Acoust. Soc. Am. 99 (3), March 1996 0001-4966/96/99(3)/1306/9/$6.00 © 1996 Acoustical Society of America space is specified by its orthogonal coordinates x5~x ,y ,z!. A 2-D configuration is shown in Fig. 1. The analysis is carried out in the temporal frequency domain with angular fre- quency v where the complex time factor e2ivt is suppressed. The two fluidlike media occupy the domains D1 and D2 , respectively, and are assumed to be linear, homogeneous, and isotropic with respective mass densities r1 and r2 and com- pressibilities k1 and k2 . Furthermore, both media exhibit some losses and the real and imaginary parts of r and k satisfy the Kramers–Kronig causality relations. The interface is denoted by S . Pressure and the particle velocity variables are denoted by P and V, respectively. In D1 , a source of finite extent generates a wave incident upon S . The incident wave is denoted by $Pi ,Vi%. The total field in D1 is written as the superposition of the incident field and the reflected field $Pr ,Vr%. The total field in D2 is the transmitted field $Pt ,Vt%. In two subsequent sections, one direct and two it- erative methods are described for the numerical solution of the problem. II. INTEGRAL EQUATION METHODS A. Direct solution method Assuming that the contribution from the parts of the contour integrals at infinity vanish, leads, at the interface S , to the simultaneous integral equations10 1 2 P~x!2Ex8PS @G1~xux8!V~x8!1L1~xux8!P~x8!# n~x8!dx85Pi~x!, xPS , ~1! 1 2 P~x!1Ex8PS @G2~xux8!V~x8!1L2~xux8!#n~x8!dx8 50, xPS , ~2! where G1,2~xux8!52irvG1,2~xux8!, L1,2~xux8!52¹xG1,2~xux8!, G1,2(xux8! is the volume injection Green’s function, and ¹x the spatial derivative at point x. For 2D we have G1,2~xux8! 5iH0~1!~k1,2ux2x8u!/4, with H0~1! the zero-order Hankel func- tion representing outgoing waves and k15v~r1k1!1/2 and k25v~r2k2!1/2 the ~complex! wave numbers in D1 and D2 , respectively. The integral equations relate the pressure P at a point x on the interface S to surface integrals along S involving pressure and the normal component of the particle velocity. The outward normal of the surface S at x, pointing into D1 , is denoted by n~x!. Equations ~1! and ~2! constitute a system of two integral equations with two unknown quantities, viz., P(x) and n~x!V~x! on S . It is noted that the integrals in the left-hand sides of ~1! and ~2! have to be interpreted as their principle values, i.e., the integrals are, when necessary, cal- culated by a limiting procedure that excludes the singularity at x5x8 in a symmetrical manner. Once the solution to P~x! and n~x!V~x! has been found, the transmitted field Pt fol- lows from an integral over S 10 Pt~x!52E x8PS @G2~xux8!V~x8!1L2~xux8!P~x8!# n~x8!dx8, xPD2 . ~3! The numerical solution to ~1! and ~2! can be obtained by discretizing the integral equations, evaluating the singular parts of the integrals, and solving the resulting system of linear equations by matrix inversion. This method will be called the direct integral equation method ~DIE!. B. Iterative solution method The technique described in Ref. 8 is used to arrive at an iterative method for the solution of the two coupled integral equations. The iterations are obtained from a continuous ver- sion of the conjugate gradient technique. The method will be called the conjugate gradient integral equation method ~CGIE!. Normalizing the unknowns P~x! and V~x! 5V~x!n~x! according to P~x!5Z0 1/2XP~x!, ~4! V~x!5Y 0 1/2XV~x!, ~5! with Z0 and Y 0 a reference impedance and admittance, re- spectively, the integral equations ~1! and ~2! can be written as Y 1~x!5E x8PS @K1P~x,x8!XP~x8! 1K1V~x,x8!XV~x8!#dx8, xPS , ~6! Y 2~x!5E x8PS @K2P~x,x8!XP~x8! 1K2V~x,x8!XV~x8!#dx8, xPS . ~7! We assume the existence of an iterative procedure, in which n steps have been carried out. The iterative procedure has led FIG. 1. Configuration and a realization of a rough surface having a Gaussian roughness spectrum with a correlation length L51 mm and a rms surface height h50.5 mm. 1307 1307J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces to the values XP(n)~x! and XV(n)~x!. The integrated squared er- ror after n steps of iteration is ERR~n !5E xPS ~ uF1 ~n !~x!u21uF2 ~n !~x!u2!dx, ~8! in which F1,2 ~n !~x!5Y 1,2~x!2E x8PS @K1,2P~x,x8!XP ~n !~x8! 1K1,2V~x,x8!XV ~n !~x8!#dx8, xPS . ~9! In going from the ~n21! st step to the nth, we use XP ,V ~n ! 5XP ,V ~n21 !1h~n !gP ,V ~n ! , ~10! where h(n) is a variational parameter to minimize ERR(n) and gP ,V (n) 5gP ,V (n) ~x! are the search directions. Using Eq. ~10!, it can be shown that F1,2 ~n !5F1,2 ~n21 !2h~n ! f 1,2~n ! , ~11! in which f 1,2~n !~x!5E x8PS @K1,2P~x,x8!XP ~n !~x8! 1K1,2V~x,x8!XV ~n !~x8!#dx8, xPS . ~12! For the search directions the conjugate gradient directions are taken:13 gP ,V ~n ! 5sP ,V ~n21 !1 A ~n ! A ~n21 ! gP ,V ~n21 ! , n>2, ~13! gP ,V ~1 ! 5sP ,V ~0 ! , ~14! where the symbols sP ,V(n) 5sP ,V(n) ~x! denote the steepest-descent directions sP ,V ~n ! ~x!5F E x8PS @K1P ,V~x8,x!F1 ~n !*~x8! 1K2P ,V~x8,x!F2 ~n !*~x8!#dx8G*, xPS , ~15! ~the asterisk denotes complex conjugate! and A ~n !5E xPS ~ usP ~n21 !u21usV ~n21 !u2!dx. ~16! The variational parameter resulting from the choice for the conjugate gradient directions is given by h~n !5A ~n !/B ~n !, ~17! with B ~n !5E xPS ~ u f 1~n !u21u f 2~n !u2!dx. ~18! The error decreases at each iteration step according to ERR~n !5ERR~n21 !2 uA ~n !u2 B ~n ! . ~19! As a result, a decrease of the error is obtained if A (n)Þ0. From Eq. ~16! it can be seen that this is the case if sP ,V(n21)Þ0. However, if sP ,V(n21) vanishes, the exact solution is arrived at in the iteration n21. Once the iteration process has been stopped, the transmitted field is found from evaluation of Eq. ~3!. III. ITERATIVE PLANE-WAVE METHOD The solution of the reflection/transmission problem can also be found by expanding the field in a Fourier-type inte- gral of plane waves.9 This method will be called the conju- gate gradient Rayleigh ~CGR! method because of its close relationship with the modified Rayleigh method using direct matrix inversion.14 The existence of an iterative procedure is assumed in which n steps have been carried out. The itera- tive procedure has led to the plane-wave components fr(n) and ft(n) of the reflected and transmitted velocity potentials, respectively. The corresponding field values are $Pr ~n ! ,Vr~ n !%5E E 2` ` $pr ~n ! ,vr ~n !%eik1 1x dkx dky , xPD1 , ~20! $Pt ~n ! ,Vt~ n !%5E E 2` ` $pt ~n ! ,vt ~n !%eik2 2x dkx dky , xPD2 , ~21! where $pr ~n ! ,vr ~n !%5i$vr1 ,k1 1%fr ~n ! , $pt ~n ! ,vt ~n !%5i$vr2 ,k2 2%f t ~n ! . ~22! The plane-wave vectors k11 and k22 indicate plane waves traveling away from S : k1 15~kx ,ky ,kz ,1!, ~23! with kz ,15~v2r1k12kx 22ky 2!1/2, R~kz ,1!,I~kz ,1!.0, ~24! and k2 25~kx ,ky ,2kz ,2!, ~25! with kz ,25~v2r2k22kx 22ky 2!1/2, R~kz ,2!,I~kz ,2!.0. ~26! The integrated squared error ERR(n) in the boundary condi- tions after n steps of iteration is ERR~n !5E xPS ~ uFP ~n !u21uFV ~n !u2!dx, ~27! in which the deviations FP(n)5FP(n)~x!, FV(n)5FV(n)~x! are given by FP ~n !5Y 0 1/2~Pi1Pr ~n !2Pt ~n !!, ~28!FV~ n !5Z0 1/2n~Vi1Vr~n !2Vt~n !!. In going from the ~n21!st step to the nth, we use fr ,t ~n !5fr ,t ~n21 !1h~n !gr ,t ~n ! , ~29! 1308 1308J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces where h(n) is a variational parameter to minimize ERR(n) and gr ,t (n)5gr ,t (n)(kx ,ky) are the search directions. Upon using Eq. ~29! it can be shown that FP ,V ~n ! 5FP ,V ~n21 !2h~n ! f P ,V~n ! , ~30! where f P~n !52ivr1Y 01/2E E 2` ` gr ~n !eik1 1x dkx dky 1ivr2Y 0 1/2E E 2` ` gt ~n !eik2 2x dkx dky , ~31! f V~n !52iZ01/2E E 2` ` nk11gr~n !eik1 1x dkx dky 1iZ0 1/2E E 2` ` nk22gt~n !eik2 2x dkx dky . ~32! For the search directions the conjugate gradient directions are taken gr ,t ~n !5sr ,t ~n21 !1 A ~n ! A ~n21 ! gr ,t ~n21 ! , n>2, ~33! gr ,t ~1 !5sr ,t ~0 ! . ~34! where the symbols sr ,t(n)5sr ,t(n)(kx ,ky) represent the steepest- descent directions sr ~n !5F2ivr1Y 01/2E xPS FP ~n !*eik1 1x dx 2iZ0 1/2E xPS nk11FV~n !*eik1 1x dxG*, ~35! st ~n !5F1ivr2Y 01/2E xPS FP ~n !*eik2 2x dx 1iZ0 1/2E xPS nk22FV~n !*eik2 2x dxG*, ~36! and A ~n !5E E 2` ` ~ usr ~n21 !u21ust ~n21 !u2!dkx dky . ~37! The variational parameter is given by h(n)5A (n)/B (n) where B ~n !5E xPS ~ u f P~n !u21u f V~n !u2!dx. ~38! Again a decrease of the error is obtained: ERR(n),ERR(n21). The transmitted field follows from evaluation of Eq. ~21!. IV. NUMERICAL IMPLEMENTATION A. Weighting functions Some issues concerning the 2-D implementation are pre- sented. To be able to make a fair comparison between the integral equation methods and the plane-wave method, the same spatial weighting function was used. For the compari- son described in this paper, Dirac-impulse functions were used. This results in the so-called point-matching technique, where the integrations are performed as simple summations of the discrete function values. If piecewise polynomials are used for both the weighting functions and the description of the surface, then the subintegrals of the CGR method can be evaluated analytically. The CGR scheme was implemented for two different weighting functions: the Dirac-impulse function and the piecewise constant function. The implemen- tation for different weighting functions also provides a con- venient check for the required spatial integration step size. If the root-mean-square difference in the solution for Dirac- weighting and piecewise constant weighting was larger than, say, one percent, then the step size was rejected as being too large. B. Integrals of Green’s functions The Hankel functions of the integral equation methods were calculated by using the polynomial descriptions in ~Ref. 15, pp. 369–370!. Although the latter expressions are in- tended for real-valued arguments, complex arguments with relatively small imaginary parts also may be used. For the absorption typically found in soft human tissue, these expres- sions are accurate to about seven significant digits, where recursion relations ~Ref. 15, pp. 385–386! were used as ref- erence. When applying the Dirac-weighting functions, ex- ceptions have to be made for the integrable singularities of the integral equation kernels, which were evaluated by using a piecewise constant weighting function. These singular parts of the integrals were evaluated analytically.16 The subintegral of the singular derivative of the Hankel function was as- sumed to be zero. C. Spatial discretization Experiments with the spatial step size showed that, for small to moderate surface slopes, the calculations gave con- sistent results for a spatial integration step size Dx<0.2l, where l is the smallest wavelength in both media. For larger surface slopes the discretization in the x direction should be smaller. As an alternative, the discretization can be carried out with constant step size along the surface. To study the behavior of the methods for varying surface characteristics, surfaces with different correlation lengths L and different root-mean-square surface heights h were generated. The ir- regular interface has a surface height with a Gaussian rough- ness spectrum, as described by Thorsos.16 A surface realiza- tion with correlation length L51 mm and rms surface height h50.5 mm is shown in Fig. 1. The convergence of the CGR method is primarily governed by the maximum surface slope.9 Therefore the ratio h/L was used as one of the inde- pendent parameters. The other independent parameter was the correlation length L . For h/L<0.5, 512 surface points at a step size Dx50.2l were used, with l 5 2p/(vAr2k2) the wavelength in medium 2. For h/L51,1024 surface points with Dx50.1l were used. D. Spectral discretization The CGIE method uses the same function spaces for the residuals as for the search directions. For the CGR method 1309 1309J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces however, residuals are calculated in the spatial domain, whereas, the search directions are calculated in the spectral domain. This leads to an additional degree of freedom with respect to the discrete implementation. However, it will be seen that the discretization in the spatial domain prescribes the choice for the ~optimum! discretization in the spectral domain. This is illustrated in Fig. 2, where the convergence properties of the CGR method are shown. The plot shows the residual error as a function of the number of iterations. The residual error ERR̂~n! at iteration n is defined by ERR̂~n !5S ERR~n !ERR0 D 1/2 , ~39! where ERR0 is the initial error ERR~0! for a zero initial guess, i.e., XP ,V(0) 50 ~CGIE! or fr ,t(0)50 ~CGR!. The ratio r is intro- duced as the total number of modes taken into account di- vided by the number of propagating modes. In fact, the graph of Fig. 2 shows the convergence properties for a fixed spectral step size with the number of modes as parameter. It can be seen that the error reaches a certain minimum value after some iteration steps, where the minimum is lower if more modes are included. However, it can also be seen that the convergence rate strongly decreases if r becomes larger than unity, i.e., if more evanescent modes are included. In the next subsection it will be shown how a preconditioning op- erator can improve the convergence considerably for this case. However, in almost every case occurring in our appli- cation, we found that the use of propagating modes only, leads to a sufficiently small residual error. If we omit the evanescent modes altogether, the question remains what the desired number of propagating modes is. To this end, all modes up to the evanescent mode limit were used where the mesh size in the discretized spectral domain was varied. This is equivalent to varying the number of propagating modes, which is shown in Fig. 3. The dashed line indicates the num- ber of propagating modes corresponding to the discrete Fou- rier transform, for a given spatial stepsize/wavelength ratio. Figure 3 shows that the residual error is not improved any- more if the number of modes is larger than the number of modes for the discrete Fourier transform. Taking the spectral stepsize corresponding to the discrete Fourier transform turns out to be very convenient in practice. It allows a direct cou- pling of the rough surface calculation method to FFT-based extrapolation methods for plano-parallel geometries. Follow- ing the above, the number of plane waves for the CGR method was taken to be equal to the number of surface points Nx . The spectral step size Dkx was taken to be the value for the discrete Fourier transform, i.e., Dkx52p/(NxDx). The number of unknowns then becomes 2Nx if all modes are used and 4NxDx/l if only the propagating modes are used. E. Preconditioning In the previous subsection, the inadequate convergence of the CGR method was mentioned in the case that evanes- cent modes were included. If the problem would have been solved with direct matrix inversion, then the matrix would have been found to be very ill conditioned.17 Ill-conditioned matrices often lead to badly converging conjugate gradient schemes.18 Therefore, a modification of the scheme was searched for by employing well-behaved matrix elements. The modification was implemented along the lines of Ref. 18 by using a preconditioning operator P that approximates the inverse operator of the problem at hand. The conjugate gra- dient directions for the preconditioned scheme become gr ,t ~n !5P*Psr ,t ~n21 !1 A ~n ! A ~n21 ! gr ,t ~n21 ! , n>2, ~40! gr ,t ~1 !5P*Psr ,t ~0 ! , ~41! where P* is the adjoint of P and where A ~n !5E E 2` ` ~ uPsr ~n21 !u21uPst ~n21 !u2!dkx dky . ~42! Various preconditioners were evaluated. A preconditioner which gave useful results is the inverse of the diagonal from FIG. 2. Residual error ERR̂(n) of the CGR method as a function of the iteration number n with parameter the ratio r , the total number of plane waves taken into account divided by the number of propagating waves; L5l50.294 mm, h5l/250.147 mm. FIG. 3. Final residual error ERR̂(N) of the CGR method as a function of the number of propagating modes. Evanescent modes are omitted. The dashed line corresponds to the number of propagating modes for the discrete Fou- rier transform: 2NxDx/l, with Nx5512, Dx/l50.2, L51 mm, h50.5 mm. 1310 1310J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces the direct matrix inversion method of our least-square mini- mization procedure. Then, the preconditioners are defined by Psr ~n !5F E xPS ~ uY 0uuvr1u2 1uZ0uunk11u2!ueik1 1xu2 dxG21/2sr~n ! , ~43! Pst ~n !5F E xPS ~ uY 0uuvr2u2 1uZ0uunk22u2!ueik2 2xu2 dxG21/2st~n ! . ~44! In Fig. 4, the convergence of the preconditioned scheme is compared to the convergence of the standard conjugate gra- dient scheme. From this figure it can be seen that the precon- ditioning indeed has a positive effect on the convergence rate. It can also be seen, however, that there is little differ- ence in convergence if evanescent modes are omitted. Schemes which are already well behaved, such as the CGR method with omitted evanescent modes, apparently are not substantially improved by using the preconditioner. How- ever, the very ill-conditioned CGR method with evanescent modes benefits from the preconditioner. V. RESULTS A. Configuration The methods were applied to surfaces described by Gaussian statistical averages, in this case by a correlation length L and a root-mean-square surface height h . The mean of the surface is at z50. The rough surface is irradiated by an array transducer at depth z510 mm. The mean of the inter- face is at z50. The 1-D linear-array transducer consists of 128 radiating elements, each having a width of 0.15 mm, positioned at a grid distance ~‘‘pitch’’! of 0.2 mm. The elec- tronic focus is at depth z5240 mm ~that is, at a distance of 50 mm from the array!, in a medium with the parameters r1 and k1 . The array elements radiate with equal magnitudes of normal surface velocity. The frequency is 5 MHz and the sound speeds are c151550 m/s and c251473 m/s, i.e., a sound speed contrast of 5%. The densities are r15r25103 kg/m3. The attenuation is 0.5 dB/~cm MHz!. Note that due to the attenuation the compressibilities are complex valued. The values for the reference admittance Y 0 and the reference im- pedance Z0 were taken to be the geometric means of the admittances and impedances of both media. B. Performance The sound propagation through the irregular interface was analyzed with the two iterative methods and a phase- screen approximation, where the results of the direct integral equation method ~DIE! were used as a reference. The eva- FIG. 5. Pressure magnitude field of array transducer for a plane interface separating two media. The array transducer is positioned at z510 mm and radiates into a medium with parameters c151550 m/s, r15103 kg/m3 at a frequency of 5 MHz. The parameters of the second medium are c251473 m/s, r25103kg/m3. The attenuation in both media is 0.5 dB/~cm MHz!. The focus is at z5240 mm. FIG. 6. Pressure magnitude field of array transducer for an irregular inter- face separating two media with L52 mm, h51 mm, CGIE method. FIG. 4. Residual error ERR̂(n) of the CGR method with preconditioning ~indicated by P! and no preconditioning ~indicated by NP! as a function of the iteration number n , with parameter the ratio r , the total number of plane waves taken into account divided by the number of propagating waves; L5l50.294 mm, h5l/250.147 mm, Nx5256. 1311 1311J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces nescent components of the CGR method were not taken into account, which results in a relatively high efficiency from a computational point of view. The calculations were run on a 40-MHz Sun-Sparc LX in Matlab 4.2. Within a finite number of iterations the CGIE method always converged to the re- sults obtained with the DIE method. Therefore the CGIE method will be used as the reference from now on. A beam pressure plot for the plane interface is shown in Fig. 5. The beam pressure plots show the incident pressure field Pi(x) and the transmitted pressure field Pt~x!. The in- terface is shown as a dark line in the figures. The beam pressure plots for the irregular interface obtained with CGIE ~Fig. 6! and CGR ~Fig. 7! agree closely. In Tables I–IV the results are shown for the different surface characteristics. It can be seen that the residual error ERR̂CGR (N) of the CGR method becomes larger for larger h/L ratios, as was also shown in Ref. 9 for sinusoidal interfaces. On the surface, the normalized root-mean-square difference ECGIE-CGR between the CGR method and the integral equa- tion methods has a similar behavior. The CGR residual is roughly a factor 2 smaller than the difference between the two methods. If we assume that the integral equation gives the more accurate result then we can say that the residual of the CGR method is a good indication of the absolute accu- racy on the surface. The performance in the focal plane has a somewhat different behavior. At first sight, the difference ECGIE-CGR between the CGR method and the integral equa- tion methods does not seem to depend on the surface irregu- larity for small surface irregularities. As a matter of fact, the rms difference for a completely flat interface is 0.054. This difference is caused by the finite support of the spatial inte- grals. At a distance halfway the focal plane, the differences between the iterative methods are smaller. In Tables I–IV also the results for a phase-screen approximation are shown. The tables show the normalized root-mean-square difference ECGIE-phases screen between the phase-screen method and the integral equation methods. The phase-screen approximation acts as a local time-shift operator based on travel time dif- ferences in the two media. Refraction is not taken into ac- count in the phase-screen approximation, which leads to rela- tively large errors at large h/L ratios. The beam magnitude cross sections for the iterative methods are very close, also in the focal plane. Examples of two beam cross-sections in the focal plane are shown in Figs. 8 and 9. Figure 8 shows the beam cross section for a perfectly flat interface, whereas Fig. 9 shows the beam cross section for a rough interface. It should be noted that the CGR method can be made more accurate than the results of Tables I–IV by using all propa- gating and evanescent waves, in combination with the pre- conditioned scheme. As far as the computational efficiency can be evaluated from a single numerical implementation, it can be said that for the accuracy we desire, the total computation time of the CGIE method is much larger than the computation time of FIG. 7. Pressure magnitude field of array transducer for an irregular inter- face separating two media with L52 mm, h51 mm, CGR method. TABLE I. Residual error ERR̂CGR(N) of the CGR method, the normalized root- mean-square difference between the integral equation methods and the CGR method ECGIE-CGR ~on the rough surface! and ECGIE-CGR ~in the focal plane!, and the normalized root-mean-square difference between the integral equa- tion methods and the phase-screen method ECGIE-phase screen , for h/L50.1. L @mm# ERR̂CGR (N) ECGIE-CGR ~rough interface! ECGIE-CGR ~focal plane! ECGIE-phase screen ~focal plane! 0.2 0.0040 0.0090 0.048 0.062 0.5 0.0013 0.0042 0.048 0.061 1 0.0010 0.0030 0.047 0.060 2 0.0024 0.0055 0.047 0.061 TABLE II. As Table I, except h/L50.2. L @mm# ERR̂CGR (N) ECGIE-CGR ~rough interface! ECGIE-CGR ~focal plane! ECGIE-phase screen ~focal plane! 0.2 0.0089 0.022 0.049 0.065 0.5 0.0048 0.012 0.047 0.060 1 0.0095 0.018 0.047 0.062 2 0.0049 0.0086 0.046 0.063 TABLE III. As Table I, except h/L50.5. L @mm# ERR̂CGR (N) ECGIE-CGR ~rough interface! ECGIE-CGR ~focal plane! ECGIE-phase screen ~focal plane! 0.2 0.036 0.070 0.065 0.092 0.5 0.035 0.065 0.050 0.071 1 0.040 0.080 0.047 0.078 2 0.051 0.085 0.047 0.12 TABLE IV. As Table I, except h/L51. L @mm# ERR̂CGR (N) ECGIE-CGR ~rough interface! ECGIE-CGR ~focal plane! ECGIE-phase screen ~focal plane! 0.2 0.090 0.13 0.078 0.13 0.5 0.086 0.17 0.070 0.14 1 0.076 0.22 0.092 0.15 2 0.058 0.16 0.072 0.39 1312 1312J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces CGR ~Fig. 10!. There are two reasons for this. First, for the first few iteration steps, the convergence of CGIE is not as fast as the convergence of CGR. Second, the computation of the Hankel functions for CGIE requires much more time than the computation of the exponentials in CGR. However, the error obtained with the CGR method reaches a steady value after a number of iterations, whereas the error obtained with CGIE can be driven to an arbitrarily small value. Our interest is in simulation of interfaces of moderate surface slopes separating media with low contrast. Then, the final error value which can be obtained with CGR is sufficiently small. VI. CONCLUDING REMARKS Two iterative methods for the 2-D simulation of wave propagation through aberrating interfaces were compared. The iterative plane-wave ~CGR! method has a number of attractive features that makes it very suitable for simulation through aberrating media in human tissue. A clear advantage is the very rapid convergence for media with relatively low contrast and moderate surface roughness. The advantage is for a large part obtained from the observation that evanescent modes can safely be neglected. Also in the latter case, the method is more accurate than a phase-screen approximation. For the cases that evanescent modes are required, an efficient preconditioning scheme has been presented. A further advan- tage of the CGR method is that it can be directly coupled to FFT-based extrapolation methods. In addition, the implemen- tation is relatively simple ~also for 3D! because of the lack of singular integrands. For improved accuracy and stability the spatial subintegrals can be evaluated analytically for a com- mon class of surfaces and weighting functions. An often overlooked advantage of plane-wave methods over Green’s function methods is that the algorithms can remain un- changed for strongly absorptive media. For this condition, the Hankel functions of the integral equation methods should be calculated in a more sophisticated way. However, if extremely rough surfaces have to be evalu- ated, possibly with reentrant points, then the integral equa- tion method should be used. ACKNOWLEDGMENTS This work has been supported by a grant from Philips Medical Systems B.V., Best, The Netherlands and by a grant from the Technological Science Branch of the Dutch Orga- nization for Scientific Research, project NGN 11.2427. 1L. Nock, G. E. Trahey, and S. W. Smith, ‘‘Phase aberration correction in medical ultrasound using speckle brightness as a quality factor,’’ J. Acoust. Soc. Am. 85, 1819–1833 ~1989!. 2C. Gambetti and F. S. Foster, ‘‘Correction of phase aberrations for sec- tored annular array ultrasound transducers,’’ Ultrasound Med. Biol. 19, 763–776 ~1993!. 3M. Karaman, A. Atalar, H. Ko¨men, and M. O’Donnell, ‘‘A phase aberra- tion correction method for ultrasound imaging,’’ IEEE Trans. Ultrason. Ferroelec. Freq. Control, 40, 275–282 ~1993!. 4D. L. Liu and R. C. Waag, ‘‘Time-shift compensation of ultrasonic pulse focus degradation using least-mean-square error estimates of arrival time,’’ J. Acoust. Soc. Am. 95, 542–555 ~1994!. 5Q. Zhu and B. D. Steinberg, ‘‘Modeling, measurement and correction of wavefront distortion produced by breast specimens,’’ Proceedings of the FIG. 8. Magnitude beam cross section of the pressure field in the focus of a linear array transducer for the CGIE method ~solid line! and the CGR method ~dotted line!; plane surface. FIG. 9. Magnitude beam cross section of the pressure field in the focus of a linear array transducer for the CGIE method ~solid line! and the CGR method ~dotted line!; surface with Gaussian roughness spectrum having pa- rameters L52 mm, h51 mm. FIG. 10. Residual error ERR̂(n) versus computation time on a 40-MHz Sun- Sparc for the CGIE method and the CGR method. 1313 1313J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces Ultrasonics Symposium ~IEEE, New York, 1994!, pp. 1613–1617. 6B. S. Robinson, A. Shmulewitz, and T. M. Burke, ‘‘Waveform aberrations in an animal model,’’ Proceedings of the Ultrasonics Symposium ~IEEE, New York, 1994!, pp. 1619–1624. 7Q. Zhu and B. D. Steinberg, ‘‘Wavefront amplitude distribution in the female breast,’’ J. Acoust. Soc. Am. 96, 1–9 ~1994!. 8P. M. van den Berg, ‘‘Iterative computational techniques in scattering based upon the integrated square error criterion,’’ IEEE Trans. Antennas Propag. AP-32, 1063–1071 ~1984!. 9A. P. Berkhoff, P. M. van den Berg, and J. M. Thijssen, ‘‘Iterative calcu- lation of reflected and transmitted acoustic waves at a rough interface,’’ IEEE Trans. Ultrason. Ferroelec. Freq. Control 42, 663–671 ~1995!. 10 J. T. Fokkema and P. M. van den Berg, Seismic Applications of Acoustic Reciprocity ~Elsevier, Amsterdam, 1993!. 11 J. A. Ogilvy, Theory of Wave Scattering from Random Rough Surfaces ~IOP, London, 1991!. 12P. Altmeyer, S. el-Gammal, and K. Hoffmann, Ultrasound in Dermatology ~Springer-Verlag, Berlin, 1992!. 13P. M. van den Berg, ‘‘Iterative schemes based on minimization of a uni- form error criterion,’’ in Application of Conjugate Gradient Method to Electromagnetics and Signal Analysis, PIER 5, edited by T. K. Sarkar ~Elsevier, Amsterdam, 1991!, Chap. 2, pp. 27–65. 14P. M. van den Berg, ‘‘Reflection by a grating: Rayleigh methods,’’ J. Opt. Soc. Am. 10, 1224–1229 ~1981!. 15M. Abramowitz and I. A. Stegun, Handbook of Mathematical Functions ~Dover, New York, 1972!. 16E. I. Thorsos, ‘‘The validity of the Kirchhoff approximation for rough surface scattering using a Gaussian roughness spectrum,’’ J. Acoust. Soc. Am. 83, 78–92 ~1988!. 17 J-M. Chesneaux and A. Wirgin, ‘‘Reflection from a corrugated surface revisited,’’ J. Acoust. Soc. Am. 96, 1116–1129 ~1994!. 18G. H. Golub and C. F. van Loan, Matrix Computations ~John Hopkins U.P., Baltimore, 1989!, pp. 527–529. 1314 1314J. Acoust. Soc. Am., Vol. 99, No. 3, March 1996 Berkhoff et al.: Propagation through rough interfaces 