ABSTRACT: 
Dyadic data are common in the social sciences, although inference for such settings involves accounting for a complex clustering structure. Many analyses in the social sciences fail to account for the fact that multiple dyads share a member, and that errors are thus likely correlated across these dyads. We propose a nonparametric sandwich-type robust variance estimator for linear regression to account for such clustering in dyadic data. We enumerate conditions for estimator consistency. We also extend our results to repeated and weighted observations, including directed dyads and longitudinal data, and provide an implementation for generalized linear models such as logistic regression. We examine empirical performance with simulations and applications to international relations and speed dating. 
 
PREDICTION: 
 dyadic data are central in social science applications ranging from international relations to “speed dating . '' a challenge with dyadic data is to account for the complex dependency structure that arises due to the connections between dyad members . for instance , in a study of international conflict , a change in leadership in one country may affect relations with all countries with which that country is paired in the data , thereby inducing a cluster of dependent observations associated with that country . as leadership changes occur in multiple countries , the correlations emanating from each of these countries will overlap into a web of interwoven clusters . 
 we refer to such interw 
 
FULL TEXT: 
 - servations, including directed dyads and longitudinal data, and provide an implementation for generalized linear models such as logistic regression. We examine empirical performance with simulations and an application to interstate disputes. Keywords: cluster robust variance estimation, dyadic data, agnostic regression Word count: 5,022 (including main text, appendix for print, captions, and references). 1 Introduction Dyadic data are central in social science applications ranging from international relations to “speed dating.”1 A challenge with dyadic data is to account for the complex dependency structure that arises due to the connections between dyad members. For instance, in a study of international conflict, a change in leadership in one country may affect relations with all countries with which that country is paired in the data, thereby inducing a correlation between these dyadic observations. This generates a cluster of dependent observations associated with that country. As leadership changes occur in multiple countries, the correlations emanating from each of these countries will overlap into a web of interwoven clusters. We refer to such interwoven dependency in dyadic data as “dyadic clustering.” By ignoring the dyadic clustering, the analysis would take the dyad- level changes emanating from a single leadership change as independently informative events, rather than a single, clustered event. An analysis that only accounts for correlations in repeated observations of dyads (whether by clustering standard errors or using dyad fixed effects) would fail to account for such inter-dyad correlation. Statistical analysis of dyads typically estimates how dyad-level outcomes (e.g., whether there is open conflict between countries or the decision for one person to ask another on a date) relate to characteristics of the individual units as well as to the dyad as a whole (e.g., measures of proximity between units). The usual approach is to regress the dyad-level outcome on unit- and dyad-level predictors. Due to dyadic clustering, the observations contributing to such an analysis are not independent. Failure to account for dyadic clustering may result in significance tests or confidence intervals with sizes that are far too small relative to the true distribution of the parameters of interest. We establish sufficient conditions for the consistency of a non-parametric sandwich estimator 1For example, in the past five years the American Political Science Review, American Journal of Political Science, and International Organization have together published 62 papers that include dyadic analyses. 1 (Huber, 1967; White, 1980a) for the variance of regression coefficients under dyadic clustering. Cluster-robust sandwich estimators are common for addressing dependent data (Angrist and Pis- chke, 2009, Ch. 8; Liang and Zeger, 1986). Cameron, Gelbach and Miller (2011) provide a sandwich estimator for “multi-way” clustering, accounting, for example, for clustering between people by geographic location and age category. We extend these methods to dyadic clustering, accounting for the fact that dyadic clustering does not decompose neatly into a few crosscutting and disjoint groups of units; rather, each unit is the basis of its own cluster that intersects with other units’ clusters. Fafchamps and Gubert (2007, Eq. 2.5) propose a sandwich estimator for dyadic clustering that is very similar to what we propose below. Their derivation is constructed through analogy to the results of Conley (1999). However, neither paper establishes conditions for consistency under dyadic clustering. We establish such consistency conditions. We also pro- vide extensions to the longitudinal case and generalized linear models such as logistic regression. We evaluate performance with simulations and a reanalysis of a classic study on interstate disputes (Russett and Oneal, 2001). The appendix generalizes to weighted data and generalized linear mod- els, and the supporting information provides another illustration with a speed dating experiment (Fisman et al., 2006). Current statistical approaches to handling dyadic clustering include the use of parametric re- strictions in mixed-effects models (Gelman and Hill, 2007; Hoff, 2005; Kenny, Kashy and Cook, 2006), the spatial error-lag model (Beck, Gleditsch and Beardsley, 2006), or permutation infer- ence for testing against sharp null hypotheses (Erikson, Pinto and Rader, 2014). These approaches have important limitations that our approach overcomes. First, mixed effects models and spatial lag models impose a parametric structure to address the clustering problem. This makes them sensitive to misspecification of the conditional mean (that is, deviations between the data and the linearity assumption). Our approach is robust in that it provides asymptotically valid standard errors even under such misspecification. This is valuable in itself to the extent that models are typ- ically approximations (Buja et al., 2014; Hubbard et al., 2014), although readers should not take 2 this to mean that they are free from the obligation to fit as good an approximation as possible. It is also valuable in providing a reliable benchmark to use in evaluating model specification (King and Roberts, 2014; White, 1980a, 1981). Second, Erikson, Pinto and Rader (2014)’s solution of non- parametric randomization inference does not provide a procedure for obtaining valid confidence intervals, while our procedure does. Third, all three of these alternatives require considerable com- putational power, possibly exceeding available computational resources even for data analyses that are common in international relations or network analysis. We demonstrate below that a mixed- effects or spatial error-lag approach is infeasible in a typical international relations example. In contrast, our proposed estimator is easy to compute. The variance estimation methods we develop are a natural complement to non- and semi-parametric approaches to regression with dyadic data (Green, Kim and Yoon, 2001). 2 Setting We work within the “agnostic” (Angrist and Imbens, 2002; Lin, 2013) or “assumption lean” (Buja et al., 2014) regression framework developed by Angrist and Pischke (2009), Goldberger (1991), and White (1980b, 1982).2 We begin with a cross-section of undirected dyads and derive the basic convergence results for this case. Below we extend these results to repeated dyads, which covers directed dyads and longitudinal data. Proofs are in the appendix. Begin with a large population from which we take a random (i.i.d.) sample of units, with the sample members indexed by i = 1, ...,N and grouped into D = (N 2 ) = N(N−1)/2 dyads. Pairs of unit indices within each dyad map to dyadic indices, 1, ...,D, through the index function d(i, j) = 2Our results would hold under a regression model approach along the lines of Greene (2008) or Davidson and MacKinnon (2004). The value of using the “agnostic regression” approach is that the derivation is robust to violations of the assumption that the regression specification is correct for the conditional expectation. Nevertheless, this should not be taken as an endorsement for ignoring misspecification or assuming that linear approximations with robust standard errors can cure misspecification problems (King and Roberts, 2014). This paper leaves aside issues of causal identification and focuses only on estimation and statistical inference. Nonetheless, the issues discussed here would be relevant for studies that attempt to estimate causal effects with dyadic data. 3 d( j, i), with an inverse correspondence s(d(i, j)) = {i, j}, and we assume no d(i, i) type dyads. Consider a linear regression of Yd(i, j) on a k-length column vector of regressors Xd(i, j) (which includes the constant): Yd(i, j) = X ′ d(i, j)β + εd(i, j), where β is the slope that we would obtain if we could fit this model to the entire population, allowing for possible non-linearity in the true relationship between E [Yd(i, j)|Xd(i, j)] and Xd(i, j), and εd(i, j) is the corresponding population residual.3 To lighten notation, for the remainder of the discussion we use d = d(i, j). Define the sample data as X = (X1...XD)′ and Y = (Y1...YD)′. The ordinary least squares (OLS) estimator is βˆ = (X′X)−1X′Y, with residual ed = Yd −X ′dβˆ . Since the values of Yd and Xd are determined by the characteristics of the units i and j, εd and εd′ for dyads containing either unit i or j are allowed to be correlated by construction. However, by random sampling of units, Cov(εd,εd′) = 0 for all dyads that do not share a member. The number of pairwise dependencies between i and j for which Cov(εd,εd′) 6= 0 is O(N3). Let the support for Xd and Yd be bounded in a finite interval and assume the usual rank conditions on X (Chamberlain, 1982; White, 1984). Lemma 1. Suppose data and βˆ as defined above. As N → ∞, the asymptotic distribution of √ N(βˆ −β ) has mean zero and variance V = N D2 E [XdX ′d] −1Var [ D ∑ d=1 Xdεd ] E [XdX ′d] −1, (1) 3If E [Yd(i, j)|Xd(i, j)] is nonlinear in Xd(i, j), the population residual will itself vary in Xd(i, j), which undermines in- ference that assumes that εd(i, j) is independent of Xd(i, j). The agnostic regression approach avoids such an assumption. 4 with, Var [ D ∑ d=1 Xdεd ] = D ∑ d=1 E{XdX ′dVar [εd|X]}︸ ︷︷ ︸ A + ∑ d′∈S (d) E{XdX ′d′Cov [εd,εd′|X]}︸ ︷︷ ︸ B  , (2) whereS (d) = {d′ 6= d}∩{d′ : s(d)∩s(d′) 6= /0}, the set of dyads other than d that share a member from d. A is the dyad-specific contribution to the variance, and B is the contribution due to inclusion of common units in multiple dyads. Note that these features of the distribution of √ N(βˆ −β ) estab- lish the consistency of βˆ as well, which is not surprising given standard results for the consistency of OLS coefficients on dependent data (White, 1984). 3 Identification and Estimation Given data as defined above, we examine the properties of a plug-in variance estimator that is anal- ogous to the sandwich estimators defined for heteroskedastic or clustered data (Arellano, 1987; Cameron, Gelbach and Miller, 2011; Liang and Zeger, 1986; White, 1980a). We establish suffi- cient conditions for consistency of the plug-in variance estimator. We consider the cross-sectional case and repeated observations case. The appendix also contains extensions to weighted observa- tions and generalized linear models. Proposition 1. Define the variance estimator Vˆ = (X′X)−1 D ∑ d=1 ( XdX ′de 2 d + ∑ d′∈S (d) XdX ′d′eded′ ) (X′X)−1. (3) Under the conditions of Lemma 1 and if Xd and ed have bounded support with non-zero second 5 moments and cross-moments, then as N→ ∞, NVˆ −V p→ 0. The proposition indicates that Vˆ provides a consistent estimator to characterize the true asymp- totic sampling distribution of the regression coefficients, βˆ . Standard error estimates for βˆ are obtained from the square roots of the diagonals of Vˆ . The assumption of bounded support for Xd and ed merely rules out situations that are unlikely to arise in real world data anyway (e.g., where the mass of the data pushes out toward infinity as N grows). Repeated dyad observations are common in applied settings. For example, the data may in- clude multiple observations for dyads over time. Dyadic panels are very common in studies of international relations. Or, if the dyadic information is directional, then the data will contain two observations for each dyad, with one observation capturing outcomes that go in the i to j direction, and the other capturing outcomes that go in the j to i direction. This is conceptually distinct from repeated observations over time. But if there are dyadic dependences for both senders and receivers of a directed dyad, then the dependence structure for a pair of directed i- j dyads will be the same as if we had repeated observations of an undirected i- j dyad. The results above translate straight- forwardly to the repeated dyads setting. Formally, suppose that for each dyad d observations are indexed by t = 1, ...,T (d), where the T (d) values are fixed and finite. Let (Ydt ,X ′dt) represent the data for observation t from dyad d, Yd =  Yd1 ... YdT (d)  and Xd =  X ′d1 ... X ′dT (d)  , and Y = (Y ′1 . . .Y ′ d . . .Y ′ D) ′ and X= (X ′1 . . .X ′ d . . .X ′ D) ′, that is, the stacked Yd vectors and Xd matrices. 6 Let βr and βˆr denote, respectively, the population slope and OLS estimator as defined above but now applied to the repeated dyads data. Corollary 1. For the repeated dyads case, assume the same conditions as in Proposition 1 and consider the following variance estimator Vˆr = (X′X)−1 D ∑ d=1 ( X ′dede ′ dXd + ∑ d′∈S (d) X ′dede ′ d′Xd′ ) (X′X)−1. Then as N→ ∞, NVar [βˆr−βr]−Vr p→ 0, and NVˆr−Vr p→ 0, where Vr = N[ ∑Dd=1 T (d) ]2 E [XdX ′d]−1E ( E [ X ′dCov [εd|X]Xd ] + ∑ d′∈S (d) E [ X ′dCov [εd,εd′|X]Xd′ ]) E [XdX ′d] −1. Some remarks are in order when it comes to the repeated observations case. First, our analysis of the repeated observations case takes the T (d) values to be fixed and finite and demonstrates con- sistency as N grows. In a cross-national study, this would mean that one should pay most attention to the number of countries, rather than the amount of time, that are in the data. Under fixed N and growing T (d) further assumptions would be required for consistency, such as serial correlation of fixed order or, more generally, strong mixing over time. Second, with repeated observations, a common strategy for identifying effects is to use dyad-specific fixed effects (Green, Kim and Yoon, 2001). With fixed and finite T (d), this does not introduce any new complications. As in Arellano (1987) for the case of serial correlation with fixed effects, the results for dyadic clustering trans- late directly to centered data, and dyadic fixed-effects regression amounts to centering the data on 7 dyad-specific means. With fixed N and growing T (d), however, additional assumptions are needed for consistency (Hansen, 2007; Stock and Watson, 2008). For efficient computation, we follow Cameron, Gelbach and Miller (2011) to perform a “multi- way decomposition” of the dyadic clustering structure: Proposition 2. We have the following algebraic equivalence, Vˆr = N ∑ i=1 VˆC,i−VˆD− (N−2)Vˆ0, where VˆC,i = (X′X)−1ΣˆC,i(X′X)−1 VˆD = (X′X)−1ΣˆD(X′X)−1 Vˆ0 = (X′X)−1Σˆ0(X′X)−1, and ΣˆC,i =∑ j 6=i ∑ k 6=i X ′d(i, j)ed(i, j)e ′ d(i,k)Xd(i,k)+ ∑ j,k 6=i T (d( j,k)) ∑ t=1 Xd( j,k)tX ′ d( j,k)te 2 d( j,k)t , ΣˆD = D ∑ d=1 X ′dede ′ dXd, and Σˆ0 = D ∑ d=1 T (d) ∑ t=1 XdtX ′dte 2 dt . VˆC,i is the usual asymptotically consistent cluster-robust variance estimator (with no degress- of-freedom adjustment) that clusters all dyads containing unit i and assumes all other observations to be independent. VˆD is the same cluster robust estimator but clustering all repeated dyad observa- tions. Vˆ0 is the usual asymptotically consistent heteroskedasticity robust (HC) variance estimator that assumes all observations (even within repeated dyad groupings) are independent. To under- stand this decomposition, note that dyadic clustering involves clustering on each of N units. But in summing the contributions from unit-specific clusters (the VˆC,is), we double count the dyad 8 contributions (VˆD) and add in the independent contributions (V0) N times. We can correct for this by subtracting VˆD, which also removes the V0 component, and then subtracting N− 2 of the V0 components. (The cross section cases simply sets VˆD = Vˆ0). This decomposition shows that one can compute the dyadic cluster robust estimator using readily available robust standard error commands.4 Our dyadic cluster robust variance estimator allows one to perform valid inference under less restrictive dependence assumptions that are used to identify random effects or spatial error lag models. Our multi-way decomposition also shows that it is computationally much simpler than those alternatives. The latter point is relevant when one has many units or time periods in which case random effects and spatial error lag models, despite their restrictions, may be infeasible with current computational resources given the challenges of evaluating a likelihood with as many de- pendencies as emerge in a dyadic analysis. 4 Simulation Evidence We use Monte Carlo simulations to evaluate the finite sample properties of the proposed estimators under the cross-sectional and repeated dyads settings. We suppose that population values obey the following, Yd(i, j)t = β0+β1|Xi−X j|+αi+α j +νd(i, j)t︸ ︷︷ ︸ εd(i, j)t , (4) where Yd(i, j)t is the tth observed outcome for the dyad that includes units i and j, Xi, X j, αi, α j, and ud(i, j)t are independent draws from standard Normal distributions, and the compound error, εd(i, j)t =αi+α j+νd(i, j)t , is unobserved. In the cross-sectional case, we only observe one outcome per dyad, so t = 1 for all observations (that is, the t subscript is extraneous for the cross-sectional 4Code for implementation in R is available from the replication archive posted to the Dataverse page references in the acknowledgments note). 9 case). In the repeated observations case, we have two observations per dyad, so t = 1,2 for all dyads. We fix β0 = 0 and β1 = 1. We use OLS to estimate βˆ0 and βˆ1. In the supplemental information we show results for mixed effects models as well. The fact that Xi and αi are constant across dyads that include unit i (same for j) implies non-zero intra-class correlation in both X and ε among sets of dependent dyads, in which case ignoring the dependence structure will tend to understate the variability in βˆ0 and βˆ1. This is the dyadic version of Moulton (1986)’s problem. Results from 500 simulation runs are shown in Figure 1. The x-axis shows the sample size, where we show results for samples with 20, 50, 100, and 150 units (implying 190, 1,225, 4,950, and 11,175 dyads, respectively). The y-axis is on the scale of the standard error of the coefficients. The black diamonds plot the empirical standard standard errors for each of the sample sizes (that is, the standard deviation of the simulation replicates of the coefficient estimates, βˆ0 and βˆ1). The black box plots show the distribution of our proposed standard error estimator. The gray box plots show, in the top figures, the distribution of the “HC2” heteroskedasticity robust variance estimator, which does not account for either dyadic or repeat observation clustering (White, 1980a; MacKinnon and White, 1985), and for the bottom figures, the “cluster robust” analog of White (1980a)’s estimator accounting for dependence in repeated dyad observations (Arellano, 1987; Liang and Zeger, 1986). Convergence of our proposed standard errors based on Vˆ and Vˆr (black box plots) to the true standard error (black diamonds) is quick. The alternative estimators, which do not account for dyadic clustering, grossly understate the variability in the coefficient estimates. These results suggest that in finite samples from data generating processes that resemble our simulations, the proposed estimator is quite reliable for inference on OLS coefficients so long as the sample size is on the order of 50 to 100 units. Most applications in political science operate with samples of at least this size. Changes to the shape of the error distributions (e.g., uniform or bimodal) yield the same results.5 5The simulation code, which allows one to choose arbitrary data distributions, is available from the replication archive posted to the Dataverse page referenced in the acknowledgement note. 10 s.e. β^0 (cross section) N St an da rd e rro r 20 50 100 150 0. 0 0. 4 0. 8 True s.e. Dyadic−cluster robust s.e. est. Naive het. robust s.e. est. s.e. β^1 (cross section) N St an da rd e rro r 20 50 100 150 0. 0 0. 2 0. 4 0. 6 True s.e. Dyadic−cluster robust s.e. est. Naive het. robust s.e. est. s.e. β^0 (repeated T = 2) N St an da rd e rro r 20 50 100 150 0. 0 0. 4 0. 8 True s.e. Dyadic−cluster robust s.e. est. Naive cluster robust s.e. est. s.e. β^1 (repeated T = 2) N St an da rd e rro r 20 50 100 150 0. 0 0. 2 0. 4 0. 6 True s.e. Dyadic−cluster robust s.e. est. Naive cluster robust s.e. est. Figure 1: Convergence of the standard error estimator as N goes from 20 to 150 (implying number of dyads goes from 190 to 11,175) for a cross section of dyads (top) and repeated dyad observations (T=2 for all dyads). Black box plots show the distribution of standard error estimates using the proposed dyadic cluster robust estimator. In the top two figures, gray box plots show standard error estimates from a heteroskedasticity robust estimator while in the bottom two figures, gray box plots show standard error estimates from a “naive” cluster-robust estimator that clusters by dyad over repeated observations (but does not cluster by units across dyads). 11 In the supporting information, we demonstrate comparisons between mixed effects models and our “robust” estimator.6 Specifically, we compare OLS with dyadic cluster robust standard errors to a two-way random effects model that incorporates normal random effects for each of the N units (Gelman and Hill, 2007). The data generating process captured above (that is, expression 4 with normal data) corresponds precisely to the assumptions of a two-way normal random effects model, and so it is no surprise that we find this model to be more efficient than OLS and to produce consistent standard errors. However, as discussed above, such models are sensitive to misspecification. For example, in fitting a linear approximation model to mildly non-linear data, the dyadic cluster robust standard errors continue to be consistent for the coefficients of the linear approximation. The degree of misspecification in this case is not extreme (as illustrated in the appendix) and resembles the kind of approximations that is common in applied work (Buja et al., 2014). Nonetheless, the random effects standard errors are inconsistent and substantially anti- conservative. Such sensitivity to misspecification is one problem for the random effects model. Another problem arises when there is unobserved country-level heterogeneity that could confound estimates of the coefficients of interest. In such situations, our dyadic cluster robust estimator would be a natural complement to a fixed effects analysis, analogous to what Arellano (1987) proposes for non-dyadic repeated observation settings. The third problem arises in computational feasibility, an issue that arises in our application to which we now turn. 5 International Militarized Disputes Application Our application is based on the classic study by Russett and Oneal (2001) on the determinants of international militarized conflicts. They study how the likelihood of a militarized dispute between 6 We sought also to include a comparison to spatial error lag models, but the models failed to converge with N ≥ 100. We note that in the original Beck, Gleditsch and Beardsley (2006) paper, they limited their analysis of dyadic data to small cross sections. Our experience suggests that it may be infeasible to fit such models with substantially larger datasets. 12 states in a dyad relates to various dyad-level attributes, including an indicator of whether the two states are formal allies, the log of the ratio of an index of military capabilities, the lowest score in the dyad on a democracy index, the ratio of the value of trade and the larger GDP of the two states, an indicator of whether both states are members of a common international organization, an indicator of whether the states are geographically noncontiguous, the log of the geographic (Euclidean) distance between the two states’ capitals, and an indicator of whether both states are “minor powers” in the international system. Dyadic clustering could arise in many ways with these data, for example if a country entered into an alliance, thereby changing the joint alliance indicators, or if the military capabilities of a country changed, thereby changing the power ratios. We replicate Russett and Oneal’s primary analysis as reported in their Table A5.1. They use annual data on 146 states in the international system paired into 1,178 dyads (out of 10,585 pos- sible) and observed for as few as one and as many as ninety years between 1885 and 1991, for a total of 39,988 observations. In their original analysis, Russett and Oneal fit a GEE model assum- ing AR(1) errors within dyads over time (Zorn, 2001). Table 1 shows the results of our reanalysis. Columns (1) and (2) replicate the original published results. Columns (3)-(6) show coefficients and various standard error estimates for a simple (pooled) logistic regression. There is little difference in the coefficient estimates from the GEE-AR(1) model as compared to the simple logistic regres- sion, so we focus on the standard error estimates. Column (4) contains estimates that account only for dyad-year heteroskedasticity, column (5) also accounts for arbitrary dependence over time for each dyad, and then column (6) also accounts for dyadic clustering. Accounting for the dyadic and repeated-observation clustering results in standard error estimates that are sometimes an order of magnitude larger than what we obtain when we ignore all clustering and also considerably larger than what one would estimate were one to account for repeated dyads clustering but ignore the inter-dyadic clustering. The latter result is also relevant when comparing the standard errors from the original GEE-AR(1) model, as they resemble the estimates in column (5). In their original analysis, Russett and Oneal found that all of the predictors had a statistically significant relation- 13 Table 1: Estimates and robust standard error estimates from logistic regression of an indicator for militarized conflict between dyads on dyad-level predictors, 1885-1991, based on Russett and Oneal (2001, Table A5.1). (1) (2) (3) (4) (5) (6) Original GEE estimates Simple logistic regression estimates Het. Naive Cluster Dyadic Cluster Predictor of Militarized Conflict Coef. S.E. Coef. Robust S.E. Robust S.E. Robust S.E. Alliances -0.539 0.159 -0.595 0.069 0.175 0.265 Power ratio -0.318 0.043 -0.328 0.020 0.047 0.070 Lower democracy -0.061 0.009 -0.064 0.005 0.010 0.015 Lower dependence -52.924 13.405 -67.668 10.734 17.560 24.749 International organizations -0.013 0.004 -0.011 0.002 0.005 0.008 Noncontiguity -0.989 0.168 -1.048 0.074 0.181 0.185 Log distance -0.376 0.065 -0.375 0.026 0.068 0.102 Only minor powers -0.647 0.178 -0.618 0.078 0.188 0.344 Constant -0.128 0.536 -0.181 0.211 0.562 0.840 N = 39,988 dyad-year observations for 1,178 dyads and 146 units. ship to the likelihood of militarized conflict. But when one takes into account dyadic clustering, the coefficient for international organizations would fail to pass a conventional significance test (e.g., t > 1.64). We attempted also to study how inferences might change with a random effects approach and a spatial error lag approach. The appropriate random effects model would be a three-way ran- dom effects model to account for each state in a dyad as well as the dyad as a whole over time. We attempted to fit three-way random effects logit models using the lmer package in R and the melogit function in Stata. We posted the jobs to a university cluster with 24 Intel Xeon cores and 48 gigabytes of RAM per node. In neither case did the random effects models converge. In fact, in neither case could we obtain estimates of any form after days on the cluster. For the spatial error lag model, we sought to implement both the spatial error lag model in the spdep package in R and the two-step estimator of Neumayer and Pluemper (2010) in Stata. The latter take as an input dyadic dependence information that can be produced using the spundir package in Stata. The spatial error lag model in the spdep failed to produce estimates and spundir package failed 14 to resolve within reasonable time (a week) while running on the same cluster.7 This brings to the foreground the issue of computational complexity, by which our cluster robust estimator is much less demanding. 6 Conclusion We have established convergence properties for a non-parametric variance estimator for regression coefficients that accounts for dyadic clustering. The estimator applies no restrictions on the depen- dency structure beyond the dyadic clustering assumption. The estimator is robust to the regression model being misspecified for the conditional mean. Such robustness is important because regres- sion analysis typically relies on linear (in coefficients) approximations of unknown conditional mean functions (Angrist and Pischke, 2009; Buja et al., 2014; Hubbard et al., 2014). Of course our analysis in no way excuses analysts from their responsibility to obtain as good an approxima- tion as possible nor does a robust fix for standard errors also solve the problem of finding a good approximation. Given a reasonable approximation for the conditional mean, the methods we have developed here allow for more accurate asymptotic statistical significance tests and confidence intervals. The estimator is consistent in the number of units that form the basis of dyadic pairs. Sim- ulations show that the estimator approaches the true standard error with modestly-sized samples from a reasonable data generating process. Applications show that inferences can be seriously anti-conservative if one fails to account for the dyadic clustering. This estimator is a natural com- plement to the non-parametric and semi-parametric regression analyses that are increasingly com- mon in the social sciences (Angrist and Pischke, 2009). Given that we can express the estimator 7See also footnote 6. The computational complexity is due to the fact that the model attempts to account for dependence across all countries in the dataset (rather than small subsets, as would be the case in a typical spatial analysis) and the fact that in this application the set of cross-section units changes over time and therefore does not allow for a stable adjacency matrix over time. 15 as the sum of simpler and easy-to-compute robust variance estimators, it could be applied to any estimator for which a cluster-robust option is available. A cost of the robust approach is efficiency. Our simulations show that a two-way (for cross- sectional data) random effects model can be considerably more efficient and provide reliable in- ference when the conditional mean is correctly specified. Our robust estimator could provide the basis of a test for misspecification (King and Roberts, 2014; White, 1980a, 1981). If there is little evidence of misspecification, the random effects estimator would be a reasonable choice given its efficiency. However, problems of computational non-convergence may make the random effects estimator infeasible—we encountered this in our application when we tried to use a three-way random effects model for dyadic panel data. Of course, accounting for dynamic dyadic clustering may fail to fully account for all relevant dependencies in the data. For example, units may exhibit higher-order network effects: for example a shock to unit A may affect unit C through connections that run via a third unit, B. In such cases, the methods developed here will likely yield standard errors that are too small, although they should still outperform methods that fail even to account for dyadic clustering. 16 A Proof of Lemma 1 Proof. We have √ N(βˆ −β ) = [ 1 D D ∑ d=1 XdX ′d ]−1 √ N D D ∑ d=1 Xdεd. Take [(1/D)∑Dd=1 XdX ′d] −1 first. By continuity of the inverse, the finite support of Xd and ed , X full rank, and the fact that the sum of dependent terms in this sum is O(D3/2) (Lehmann, 1999, Eq. 2.8.4), we have that [ 1 D D ∑ d=1 XdX ′d ]−1 p→ E [XdX ′d]−1. By Slutsky’s theorem, √ N(βˆ − β ) has the same asymptotic distribution as E [XdX ′d] −1 √ N D ∑ D d=1 Xdεd , which has mean zero and variance, V = N D2 E [XdX ′d] −1Var [ D ∑ d=1 Xdεd ] E [XdX ′d] −1. (5) Then, Var [ D ∑ d=1 Xdεd ] = D ∑ d=1 D ∑ d′=1 Cov [Xdεd,Xd′εd′] = D ∑ d=1 D ∑ d′=1 E{XdX ′d′Cov [εd,εd′|X]} = D ∑ d=1 E{XdX ′dVar [εd|X]}︸ ︷︷ ︸ A + ∑ d′∈S (d) E{XdX ′d′Cov [εd,εd′|X]}︸ ︷︷ ︸ B  (6) whereS (d) = {d′ 6= d}∩{d′ : s(d)∩s(d′) 6= /0}, the set of dyads other than d that share a member from d. 17 B Proof of Proposition 1 Proof. By Chebychev’s inequality, two conditions are sufficient for NVˆ −V p→ 0 as N → ∞: (i) E [Vˆ −V ]→ 0, and (ii) Var [NVˆ −V ] = Var [NVˆ ]→ 0 (Lehmann, 1999, Thm. 2.1.1). For (i), consider the interior (“meat”) of Vˆ : Σˆ= D ∑ d=1 ( XdX ′de 2 d + ∑ d′∈S (d) XdX ′d′eded′ ) and the corresponding term for V : Σ= D ∑ d=1 ( E{XdX ′dVar [εd|X]}+ ∑ d′∈S (d) E{XdX ′d′Cov [εd,εd′|X]} ) . We have E [Σˆ] = D ∑ d=1 ( E{XdX ′dE [e2d|X]}+ ∑ d′∈S (d) E{XdX ′d′E [eded′|X]} ) → Σ by consistency of βˆ , an implication of Lemma 1. Lemma 1 also established that (X′X/D)−1 p→ E [XdX ′d] −1, while boundedness of Xd implies uniform boundedness of E [XdX ′d] −1. Taking these elements together, uniform continuity implies E [Vˆ −V ]→ 0 (cf. White, 1980a, Thm. 1). For (ii), we follow the strategy of (Lehmann, 1999, section 2.8), which requires showing that growth of covariance contributions due to dependent units is bounded in N. Begin by rewriting NVˆ as NVˆ = N(X′X/D)−1 ( D−2∑ d ∑ d′ Id,d′XdX ′ d′eded′ ) (X′X/D)−1 where Id,d′ is an indicator function denoting a pair of dyads d and d′ that share a member, as defined above. We have established that (X′X/D)−1 converges in probability to a finite limit, E[XdX ′d] −1, 18 so we can treat this as O(1). Given bounded support, Var [NVˆ ] is of the same order as Ω= N2D−4Var [ ∑ d ∑ d′ Id,d′XdX ′ d′eded′ ] = N2D−4∑ d ∑ d′ ∑ d′′ ∑ d′′′ Cov(Id,d′XdX ′ d′eded′, Id′′,d′′′Xd′′X ′ d′′′ed′′ed′′′). To show Var [NVˆ ]→ 0, it is sufficient to establish that Ω is at most O(N−1). Consider quadruples of dyads indexed by d,d′,d′′,d′′′ such that d 6= d′ 6= d′′ 6= d′′′. Suppose there are Q quadruples and define pQ(A) = |A|/Q. The covariance terms take positive values when Id,d′ = Id′′,d′′′ = 1, which occurs at rate O(N−2) (that is, when we have pairs of terms that are actually summed into Vˆ ), and we have dependence across (d,d′) and (d′′,d′′′). Then, the six distinct ways that such dependence can occur and the associated proportion of quadruples for which these occur for a sample of size N are as follows: pQ({d 6= d′′}∩{d′′ : s(d)∩ s(d′′) 6= /0}) = O(N−1), pQ({d 6= d′′′}∩{d′′′ : s(d)∩ s(d′′′) 6= /0}) = O(N−1), pQ({d 6= d′′ 6= d′′′}∩{d′′,d′′′ : s(d)∩ s(d′′) 6= /0∩ s(d)∩ s(d′′′) 6= /0}) = O(N−2), pQ({d′ 6= d′′}∩{d′′ : s(d′)∩ s(d′′) 6= /0}) = O(N−1), pQ({d′ 6= d′′′}∩{d′′′ : s(d′)∩ s(d′′′) 6= /0}) = O(N−1), and pQ({d′ 6= d′′ 6= d′′′}∩{d′′,d′′′ : s(d′)∩ s(d′′) 6= /0∩ s(d′)∩ s(d′′′) 6= /0}) = O(N−2). Therefore the proportion of quadruples yielding a positive covariance is the proportion of cases contributing non-zero values to the sum Ω. This proportion is bounded by the proportion of cases where the indicator functions are both one and the order of the proportion of dependent quadruples from across the six cases characterized above, that is O(N−2N−1) = O(N−3). Then Var [NVˆ ] is at most O(N2D−4D4N−3) = O(N−1)→ 0. 19 C Proof of Proposition 2 Proof. Consider the interior (“meat”) of Vˆr: Σˆr = D ∑ d=1 ( X ′dede ′ dXd + ∑ d′∈S (d) X ′dede ′ d′Xd′ ) = D ∑ d=1 X ′dede ′ dXd + D ∑ d=1 ∑ d′∈S (d) X ′dede ′ d′Xd′. Taking the second component, D ∑ d=1 ∑ d′∈S (d) X ′dede ′ d′Xd′ = N ∑ i=1 Ci, with Ci =∑ j 6=i ∑ k 6=i, j X ′d(i, j)ed(i, j)e ′ d(i,k)Xd(i,k). Define Di =∑ j 6=i X ′d(i, j)ed(i, j)e ′ d(i, j)Xd(i, j) and Ei = ∑ j,k 6=i T (d( j,k)) ∑ t=1 Xd( j,k)tX ′ d( j,k)te 2 d( j,k)t . Then working with ΣˆC,i, ΣˆD, and Σˆ0 as defined in the proposition, ΣˆC,i =Ci+Di+Ei, 2ΣˆD = N ∑ i=1 Di, and (N−2)Σˆ0 = N ∑ i=1 Ei. Then Σˆr = ΣˆD+ N ∑ i=1 Ci = ΣˆD+ N ∑ i=1 [Ci+Di+Ei−Di−Ei] = N ∑ i=1 ΣˆC,i− ΣˆD− (N−2)Σˆ0, 20 and by linear distributivity for (X′X)−1 Vˆr = N ∑ i=1 VˆC,i−VˆD− (N−2)Vˆ0, with VˆC,i, VˆD, and Vˆ0 as defined in the proposition. D Weighted Observations Weighting is a common way to adjust for unequal probability sampling of dyadic interactions, among other applications. The extension to the weighted case is straightforward. Assume weighted directed dyad observations with weights finite and fixed; denote the weight for dyad d as wd . Define the sample data as X = (X ′1...X ′ D) ′ and Y = (Y1...YD)′ and the matrix of weights as W = diag{w1, . . . ,wD}. Then the weighted least squares estimator is βˆw = (X′WX)−1X′WY. Corollary 2. For the weighted dyads case, assume the same conditions as in Proposition 1 and consider the following variance estimator Vˆw = (X′WX)−1 D ∑ d=1 ( XdX ′dw 2 de 2 d + ∑ d′∈S (d) XdX ′d′wdwd′eded′ ) (X′WX)−1. (7) Then as N→ ∞, NVar [βˆw−βw]−Vw p→ 0, and NVˆw−Vw p→ 0, 21 where Vw = N D2 E [wdXdX ′d] −1E ( E [ XdX ′dw 2 dVar [εd|X] ] + ∑ d′∈S (d) E [ XdX ′d′wdwd′Cov [εd,εd′|X] ]) E [wdXdX ′d] −1. E Generalized Linear Models An implementation for generalized linear models follows the usual M-estimation results (Stefanski and Boos, 2002; Wooldridge, 2010, Ch. 12). Given an estimating equation, ψ(D;θ), on data D, and with parameters θ and parameter estimates θˆ , the sandwich approximation for the variance is A−1B{A−1}′, where A = E [ − ∂ ∂θ ′ ψ(D; θˆ) ] and B = Eψ(D; θˆ)ψ(Di; θˆ)′. For logistic regression the estimating equation is, ψ((Xd,Yd); βˆ ) = Xd(Yd− pd), where pd = expit(Xdβˆ ), the predicted probability for dyad d. The plug-in variance estimator for logistic regression coefficients is given by Vˆl = (X′MX)−1 D ∑ d=1 ( XdX ′dr 2 d + ∑ d′∈S (d) XdX ′drdrd′ ) (X′MX)−1 where M = diag(pd(1− pd))D×D and rd = Yd− pd. The extensions to repeated and weighted observations follow analogously. 22 References Angrist, Joshua D. and Guido W. Imbens. 2002. “Comment on ‘Covariance adjustment in ran- domized experiments and observational studies’ by Paul R. Rosenbaum.” Statistical Science 17(3):304–307. Angrist, Joshua D. and Jorn-Steffen Pischke. 2009. Mostly Harmless Econometrics: An Empiri- cist’s Companion. Princeton, NJ: Princeton University Press. Arellano, Manuel. 1987. “Computing Robust Standard Errors for Within-Group Estimators.” Ox- ford Bulletin of Economics and Statistics 49(4):431–434. Beck, Nathanial, Kristian Skrede Gleditsch and Kyle Beardsley. 2006. “Space is More than Ge- ography: Using Spatial Ecometrics in the Study of Political Economy.” International Studies Quarterly 50:27–44. Buja, Andreas, Richard Berk, Lawrence Brown, Edward George, Emil Pitkin, Mikhail Traskin, Linda Zhao and Kai Zhang. 2014. “Models as Approximations: A Conspiracy of Random Predictors and Model Violations Against Classical Inference in Regression.” Manuscript, The Wharton School, University of Pennsylvania, Philadelphia. Cameron, A. Colin, Jonah B. Gelbach and Douglas L. Miller. 2011. “Robust inference with multi- way clustering.” Journal of Business and Economic Statistics 29(2):238–249. Chamberlain, Gary. 1982. “Multivariate Regression Models for Panel Data.” Journal of Econo- metrics 18(1):5–46. Conley, Timothy G. 1999. “GMM estimation with cross sectional dependence.” Journal of Econo- metrics 92:1–45. Davidson, Russell and James G. MacKinnon. 2004. Econometric Theory and Methods. Oxford: Oxford University Press. Erikson, R. S., P. M. Pinto and K. T. Rader. 2014. “Dyadic Analysis in International Relations: A Cautionary Tale.” Political Analysis 22(4):457–463. Fafchamps, Marcel and Flore Gubert. 2007. “The Formation of Risk Sharing Networks.” Journal of Development Economics 83:326–350. Fisman, Raymond, Sheena S Iyengar, Emik Kamenica and Itamar Simonson. 2006. “Gender differences in mate selection: Evidence from a speed dating experiment.” Quarterly Journal of Economics 121:673–697. Gelman, Andrew and Jennifer Hill. 2007. Data Analysis Using Regression and Multi- level/Hierarchical Models. Cambridge: Cambridge University Press. 23 Goldberger, Arthur S. 1991. A Course in Econometrics. Cambridge, MA: Harvard University Press. Green, Donald P., Soo Yeon Kim and David H. Yoon. 2001. “Dirty Pool.” International Organi- zation 55(2):441–468. Greene, William H. 2008. Econometric Analysis. 6th ed. Upper Saddle River, NJ: Pearson. Hansen, Christian B. 2007. “Asymptotic properties of a robust variance matrix estimator for panel data when T is large.” Journal of Econometrics 141:597–620. Hoff, Peter D. 2005. “Bilinear Mixed-Effects Models for Dyadic Data.” Journal of the American Statistical Association 100(469):286–295. Hubbard, Alan E., Jennifer Ahern, Nancy L. Fliescher, Mark Van Der Laan, Sheri A. Lippman, Nicholas Jewell, Tim Bruckner and William A. Satariano. 2010. “To GEE or Not to GEE: Comparing Population Average and Mixed Models for Estimating the Associations Between Neighborhood Risk Factors and Health.” Epidemiology 21(4):467–474. Huber, Peter J. 1967. The behavior of maximum likelihood estimates under nonstandard condi- tions. In Proceedings of the Fifth Berkeley Symposium on Mathematical Statistics and Probabil- ity. Vol. 1 pp. 221–233. Kenny, David A., Deborah A. Kashy and William L. Cook. 2006. Dyadic Data Analysis. New York, NY: Guilford Press. King, Gary and Margaret E. Roberts. 2014. “How Robust Standard Errors Expose Methodological Problems They Do Not Fix, and What to Do About It.” Political Analysis (online early view):1– 12. Lehmann, Erich L. 1999. Elements of Large Sample Theory. New York: Springer-Verlag. Liang, Kung-Yee and Scott L. Zeger. 1986. “Longitudinal data analysis using generalized linear models.” Biometrika 73(1):13–22. Lin, Winston. 2013. “Agnostic Notes on Regression Adjustments to Experimental Data: Reexam- ining Freedman’s Critique.” Annals of Applied Statistics 7(1):295–318. MacKinnon, James G. and Halbert White. 1985. “Some Heteroskedasticity-Consistent Covari- ance Matrix Estimators with Improved Finite Sample Properties.” Journal of Econometrics 29(3):305–325. Moulton, Brent R. 1986. “Random group effects and the precision of regression estimates.” Journal of Econometrics 32:385–397. Neumayer, Eric and Thomas Pluemper. 2010. “Spatial Effects in Dyadic Data.” International Organization 64(1):145–165. 24 Russett, Bruce M. and John R. Oneal. 2001. Triangulating Peace: Democracy, Interdependence and International Organizations. New York, NY: Norton. Stefanski, Leonard A. and Dennis D. Boos. 2002. “The Calculus of M-Estimation.” The American Statistician 56(1):29–38. Stock, James H. and Mark W. Watson. 2008. “Heteroskedasticity-Robust Standard Errors for Fixed Effects Panel Data Regression.” Econometrica 76(1):155–174. White, Halbert. 1980a. “A heteroskedasticity-consistent covariance matrix estimator and a direct test for heteroskedasticity.” Econometrica 48(4):817–838. White, Halbert. 1980b. “Using Least Squares to Approximate Unknown Regression Functions.” International Economic Review 21(1):149–170. White, Halbert. 1981. “Consequences and Detection of Misspecified Nonlinear Regression Mod- els.” Journal of the American Statistical Association 76(374):419–433. White, Halbert. 1982. “Maximum Likelihood Estimation of Misspecified Models.” Econometrica 50(1-25). White, Halbert. 1984. Asymptotic Theory of Econometricians. New York, NY: Academic Press. Wooldridge, Jeffrey M. 2010. Econometric Analysis of Cross Section and Panel Data. Cambridge, MA: MIT Press. Zorn, Christopher. 2001. “Generalized Estimating Equation Models for Correlated Data: A Review with Applications.” American Journal of Political Science 45:470–490. 25 Cluster Robust Variance Estimation for Dyadic Data Supporting Information Not for Publication 1 Additional Simulation Evidence Figure 2 and 3 show additional simulation results where we make comparisons to mixed effects models—specifically, to a two-way random effects model that incorporates random effects for each of N units in the data. All random effects models were fit using the lmer package in R. In both sets of graphs, black box plots show the distribution of standard error estimates for OLS coefficients using the proposed dyadic cluster robust estimator. Gray box plots show standard error estimates for OLS coefficients from a heteroskedasticity robust estimator. Blue box plots show the distribution of standard error estimators from a two-way random effects model with a random effect for each of N units. Black diamonds show the true standard error of the OLS coefficients and the blue diamonds show the true standard error of the random effects coefficients. s.e. β^0 (cross section) N St an da rd e rro r 20 50 100 150 0. 0 0. 4 0. 8 True OLS s.e. True RE s.e. Dyadic−cluster robust s.e. est. Naive cluster robust s.e. est. RE s.e. est. s.e. β^1 (cross section) N St an da rd e rro r 20 50 100 150 0. 0 0. 4 0. 8 True OLS s.e. True RE s.e. Dyadic−cluster robust s.e. est. Naive cluster robust s.e. est. RE s.e. est. Figure 2: Normal shocks case (same as main text). Figure 2 uses the same data generating process as was described in the main text, and presents the same results for OLS with either the dyadic cluster robust standard error estimator or the heteroskedastic robust estimator. In addition, we have added random effects estimates. Given that the data generating process conforms exactly to the assumptions of a two-way random effects model, we obtain the straightforward result that the random effects estimates are both more efficient (the blue diamonds tend to be lower than the black ones) and the random effects standard errors are consistent. Figure 3 illustrates the robustness of the dyadic cluster robust estimator relative to a random effects estimator. In this case, we induce mild misspecification by assuming that the true data 2 s.e. β^0 (cross section) N St an da rd e rro r 20 50 100 150 0. 0 0. 2 0. 4 0. 6 0. 8 1. 0 True OLS s.e. True RE s.e. Dyadic−cluster robust s.e. est. Naive cluster robust s.e. est. RE s.e. est. s.e. β^1 (cross section) N St an da rd e rro r 20 50 100 150 0. 0 0. 2 0. 4 0. 6 True OLS s.e. True RE s.e. Dyadic−cluster robust s.e. est. Naive cluster robust s.e. est. RE s.e. est. Figure 3: Misspecification case. l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l ll l l l l l l ll l l l l l l l l l l l l l l l l l l l l l ll l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l l 0.0 0.5 1.0 1.5 2.0 2.5 3.0 − 4 − 2 0 2 4 6 8 |Xi−Xj| Y Figure 4: Illustrative scatter plot and linear approximation for the misspecification case. The blue line is the true conditional mean, and the red line is the linear approximation. 3 generating process is Yd(i, j)t = β0+β1|Xi−X j|+β2(Xi−X j)2+αi+α j +νd(i, j)t︸ ︷︷ ︸ εd(i, j)t , where all parameters are set as in the main text but we also have β2 = 0.25. We nonetheless fit a model that includes only |Xi−X j|, thereby mildly misspecifying the model such that we do not account for the nonlinearity induced by the β2(Xi−X j)2 term. Figure 4 shows the scatter plot of Yd(i, j)t against |Xi−X j|, the linear approximation (in red) for one of the simulation replicates (N = 50), and the true conditional mean (in blue). Such linear approximations are the norm in social science research (Buja et al., 2014). In this case, we see that, despite the mild misspecifica- tion, the dyadic cluster robust standard error correctly characterizes the standard error of the linear approximation coefficients (the black box plots still zero in on the black diamonds). The random effects model is still more efficient (the blue diamonds still tend to be below the black diamonds). But the random effects standard error estimator (as computed in the lmer package for R) is incon- sistent and anti-conservative: the blue box plots converge to a limit that is substantially below the true standard error (the blue diamonds). 4 Speed Dating Application Our second application is based on Fisman et al. (2006)’s seminal study of the determinants of mate selection in a “speed-dating” experiment. We replicate their primary analysis for female partici- pants (as reported in column 1 of their Table III) using data from 21 dating sessions conducted by the experimenters.8 These data include 278 women paired into 3,457 female-male dyads. Fisman et al. (2006) regress a binary indicator for whether the female subject desired contact information for a male partner on the subject’s ratings of the partner’s ambition, attractiveness, and intelli- gence based on a 10-point Likert scale. The regression controls for female-subject fixed effects and weights observations contributed by each female subject by the inverse of the number of part- ners with which she was paired. Table 2 shows the results of our re-analysis.9 Again, we see that accounting for the dyadic clustering (column 4) yields standard error estimates that are larger than what one would get if one ignored all clustering (column 2), although in this case there are no pronounced differences with what one gets when one only accounts for within-subject clustering (column 3). This is to be expected given that the amount of dyadic dependence in this dataset is limited: dyads were formed only within sessions that included between 5 and 22 male partners for each female subject. In addition, the female subjects are never paired with each other. The only clustering that occurs is therefore within female subjects and then for male partners that appear across multiple female subjects. The former is addressed in part by the female subject-specific fixed effects. The latter is limited by the within-session pairings. Table 2: Estimates and robust standard error estimates from a linear fixed-effects regression of an indicator for mate selection between dyads on dyad-level predictors, based on Fisman et al. (2006, Table III, Column 1). (1) (2) (3) (4) Het. Naive Cluster Dyadic Cluster Predictor of Mate Selection Coef. Robust S.E. Robust S.E. Robust S.E. Ambition 0.0192 0.0052 0.0057 0.0061 Attractiveness 0.1157 0.0041 0.0051 0.0054 Intelligence 0.0465 0.0062 0.0073 0.0074 N = 3,457 dyad observations for 278 subjects. 8The dataset to which we had access is not identical that used in the original Fisman et al. (2006) paper. Rather, it is the version made available in association with Gelman and Hill (2007, pp. 322-323), available at http://www. stat.columbia.edu/~gelman/arm/software. We contacted the original study authors and they indicated that the dataset from the original paper was not available. 9For the reasons explained in footnote 8, our estimates differ slightly from those that appear in the original paper. 5 